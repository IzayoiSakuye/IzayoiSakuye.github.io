<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"izayoisakuye.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.23.2","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":false,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="类与对象 C++面向对象的三大特性：封装、继承、多态 C++中，任何事物都为对象，对象有其属性和行为 具有相同性质的对象，我们可以抽象称为类 封装 封装的实现 意义：  将属性和行为作为一个整体，表现生活中的事物 将属性和行为加以权限控制  语法：class &lt;类名&gt;{ &lt;访问权限&gt;: &lt;属性&#x2F;行为&gt;} 一些名词：  成员：类中的属性">
<meta property="og:type" content="article">
<meta property="og:title" content="【C++】类与对象">
<meta property="og:url" content="https://izayoisakuye.github.io/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/index.html">
<meta property="og:site_name" content="红魔咖啡馆">
<meta property="og:description" content="类与对象 C++面向对象的三大特性：封装、继承、多态 C++中，任何事物都为对象，对象有其属性和行为 具有相同性质的对象，我们可以抽象称为类 封装 封装的实现 意义：  将属性和行为作为一个整体，表现生活中的事物 将属性和行为加以权限控制  语法：class &lt;类名&gt;{ &lt;访问权限&gt;: &lt;属性&#x2F;行为&gt;} 一些名词：  成员：类中的属性">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://izayoisakuye.github.io/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/image-20250602151243297.png">
<meta property="article:published_time" content="2025-07-31T09:28:37.198Z">
<meta property="article:modified_time" content="2025-07-31T09:28:53.965Z">
<meta property="article:author" content="IzayoiSakuye">
<meta property="article:tag" content="C&#x2F;C++">
<meta property="article:tag" content="OOP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://izayoisakuye.github.io/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/image-20250602151243297.png">


<link rel="canonical" href="https://izayoisakuye.github.io/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://izayoisakuye.github.io/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/","path":"C++/类与对象/","title":"【C++】类与对象"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【C++】类与对象 | 红魔咖啡馆</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.css">
<style>:root{--hl-color:#90a4ae;--hl-bg:#f6f8fa;--hltools-bg:#e6ebf1;--hltools-color:#90a4ae;--hlnumber-bg:#f6f8fa;--hlnumber-color:rgba(144,164,174,0.5);--hlscrollbar-bg:#dce4eb;--hlexpand-bg:linear-gradient(180deg,rgba(246,248,250,0.1),rgba(246,248,250,0.9))}</style><!-- hexo injector head_end end --><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">红魔咖啡馆</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">头发越掉越多，头发越掉越少</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">21</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">6</span></a></li><li class="menu-item menu-item-passages"><a href="/list/" rel="section"><i class="fa-regular fa-file fa-fw"></i>文章</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1"><span class="nav-number">1.</span> <span class="nav-text">类与对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B0%81%E8%A3%85"><span class="nav-number">1.1.</span> <span class="nav-text">封装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%81%E8%A3%85%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-number">1.1.1.</span> <span class="nav-text">封装的实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%83%E9%99%90"><span class="nav-number">1.1.2.</span> <span class="nav-text">权限</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#struct%E4%B8%8Eclass%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.3.</span> <span class="nav-text">struct与class的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%90%E5%91%98%E5%B1%9E%E6%80%A7%E7%A7%81%E6%9C%89%E5%8C%96"><span class="nav-number">1.1.4.</span> <span class="nav-text">成员属性私有化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E5%92%8C%E6%B8%85%E7%90%86"><span class="nav-number">1.2.</span> <span class="nav-text">对象的初始化和清理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%8E%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0"><span class="nav-number">1.2.1.</span> <span class="nav-text">构造函数与析构函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E7%B1%BB%E4%B8%8E%E8%B0%83%E7%94%A8"><span class="nav-number">1.2.2.</span> <span class="nav-text">构造函数的分类与调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E6%97%B6%E6%9C%BA"><span class="nav-number">1.2.3.</span> <span class="nav-text">拷贝构造函数调用时机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%A7%84%E5%88%99"><span class="nav-number">1.2.4.</span> <span class="nav-text">构造函数调用规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%B1%E6%8B%B7%E8%B4%9D%E4%B8%8E%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="nav-number">1.2.5.</span> <span class="nav-text">深拷贝与浅拷贝</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8"><span class="nav-number">1.2.6.</span> <span class="nav-text">初始化列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%AF%B9%E8%B1%A1%E4%BD%9C%E4%B8%BA%E7%B1%BB%E6%88%90%E5%91%98"><span class="nav-number">1.2.7.</span> <span class="nav-text">类对象作为类成员</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%88%90%E5%91%98"><span class="nav-number">1.2.8.</span> <span class="nav-text">静态成员</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#c%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B%E4%B8%8Ethis%E6%8C%87%E9%92%88"><span class="nav-number">1.3.</span> <span class="nav-text">C++对象模型与this指针</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E4%B8%8E%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E5%88%86%E5%BC%80%E5%AD%98%E5%82%A8"><span class="nav-number">1.3.1.</span> <span class="nav-text">成员变量与成员函数分开存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#this%E6%8C%87%E9%92%88"><span class="nav-number">1.3.2.</span> <span class="nav-text">this指针</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A9%BA%E6%8C%87%E9%92%88%E8%AE%BF%E9%97%AE%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-number">1.3.3.</span> <span class="nav-text">空指针访问成员函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#const%E4%BF%AE%E9%A5%B0%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-number">1.3.4.</span> <span class="nav-text">const修饰成员函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E7%89%B9%E6%AE%8A%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-number">1.3.5.</span> <span class="nav-text">类的特殊成员函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E5%B9%B3%E5%87%A1%E5%A4%8D%E5%88%B6%E7%B1%BB"><span class="nav-number">1.3.6.</span> <span class="nav-text">可平凡复制类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E5%87%86%E5%B8%83%E5%B1%80%E7%B1%BB"><span class="nav-number">1.3.7.</span> <span class="nav-text">标准布局类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%8B%E5%85%83"><span class="nav-number">1.4.</span> <span class="nav-text">友元</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E5%87%BD%E6%95%B0%E5%81%9A%E5%8F%8B%E5%85%83"><span class="nav-number">1.4.1.</span> <span class="nav-text">全局函数做友元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%81%9A%E5%8F%8B%E5%85%83"><span class="nav-number">1.4.2.</span> <span class="nav-text">类做友元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E5%81%9A%E5%8F%8B%E5%85%83"><span class="nav-number">1.4.3.</span> <span class="nav-text">成员函数做友元</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.</span> <span class="nav-text">运算符重载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E5%8F%B7%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.1.</span> <span class="nav-text">加号运算符重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A6%E7%A7%BB%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.2.</span> <span class="nav-text">左移运算符重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%92%E5%A2%9E%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.3.</span> <span class="nav-text">递增运算符重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.4.</span> <span class="nav-text">赋值运算符重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.5.</span> <span class="nav-text">关系运算符重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E8%BF%90%E7%AE%97%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-number">1.5.6.</span> <span class="nav-text">函数调用运算符重载</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF"><span class="nav-number">1.6.</span> <span class="nav-text">继承</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF%E6%96%B9%E5%BC%8F"><span class="nav-number">1.6.1.</span> <span class="nav-text">继承方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.6.2.</span> <span class="nav-text">继承中的对象模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF%E4%B8%AD%E7%9A%84%E6%9E%84%E9%80%A0%E4%B8%8E%E6%9E%90%E6%9E%84%E9%A1%BA%E5%BA%8F"><span class="nav-number">1.6.3.</span> <span class="nav-text">继承中的构造与析构顺序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E5%90%8D%E6%88%90%E5%91%98%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F"><span class="nav-number">1.6.4.</span> <span class="nav-text">同名成员处理方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E7%BB%A7%E6%89%BF"><span class="nav-number">1.6.5.</span> <span class="nav-text">多继承</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8F%B1%E5%BD%A2%E7%BB%A7%E6%89%BF"><span class="nav-number">1.6.6.</span> <span class="nav-text">菱形继承</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E6%80%81"><span class="nav-number">1.7.</span> <span class="nav-text">多态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">1.7.1.</span> <span class="nav-text">分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%AF%E8%99%9A%E5%87%BD%E6%95%B0%E4%B8%8E%E6%8A%BD%E8%B1%A1%E7%B1%BB"><span class="nav-number">1.7.2.</span> <span class="nav-text">纯虚函数与抽象类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%9E%90%E6%9E%84%E4%B8%8E%E7%BA%AF%E8%99%9A%E6%9E%90%E6%9E%84"><span class="nav-number">1.7.3.</span> <span class="nav-text">虚析构与纯虚析构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%82%E9%A1%B9"><span class="nav-number">1.8.</span> <span class="nav-text">杂项</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#override%E4%B8%8Efinal%E9%99%90%E5%AE%9A%E7%AC%A6"><span class="nav-number">1.8.1.</span> <span class="nav-text">override与final限定符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#const%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-number">1.8.2.</span> <span class="nav-text">const成员函数</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="IzayoiSakuye"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">IzayoiSakuye</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">106</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="IzayoiSakuye">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【C++】类与对象 | 红魔咖啡馆">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【C++】类与对象
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-07-31 17:28:37 / 修改时间：17:28:53" itemprop="dateCreated datePublished" datetime="2025-07-31T17:28:37+08:00">2025-07-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/C-C/" itemprop="url" rel="index"><span itemprop="name">C/C++</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="类与对象">类与对象</h1>
<p>C++面向对象的三大特性：<strong>封装、继承、多态</strong></p>
<p>C++中，<strong>任何事物都为对象</strong>，对象有其属性和行为</p>
<p>具有<strong>相同性质</strong>的对象，我们可以抽象称为类</p>
<h2 id="封装">封装</h2>
<h3 id="封装的实现">封装的实现</h3>
<p>意义：</p>
<ul>
<li>将属性和行为作为一个整体，表现生活中的事物</li>
<li>将属性和行为加以权限控制</li>
</ul>
<p>语法：<code>class &lt;类名&gt;{ &lt;访问权限&gt;: &lt;属性/行为&gt;}</code></p>
<p>一些名词：</p>
<ul>
<li>成员：类中的属性和行为的统称</li>
<li>成员属性（成员变量）：类中的属性</li>
<li>成员函数（成员方法）：类中的函数</li>
</ul>
<p>e.g.1 设计一个圆类，求其周长</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">// 设计一个圆类，求其周长</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">double</span><span style="color: #24292E"> PI </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">3.14</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">circle</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #6A737D">// 访问权限: 公共权限</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 属性：半径</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> r;</span></span>
<span class="line"><span style="color: #6A737D">  // 行为：获取周长</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">double</span><span style="color: #24292E"> </span><span style="color: #6F42C1">calC</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #D73A49">*</span><span style="color: #24292E">PI</span><span style="color: #D73A49">*</span><span style="color: #24292E">r;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 通过类创建一个对象——实例化</span></span>
<span class="line"><span style="color: #24292E">  circle c1;</span></span>
<span class="line"><span style="color: #6A737D">  // 给对象的属性进行赋值，使用.</span></span>
<span class="line"><span style="color: #24292E">  c1.r </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // 调用行为</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"r="</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> c1.</span><span style="color: #6F42C1">calC</span><span style="color: #24292E">()</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>e.g.2 设计一个学生类，属性有姓名和学号，可以赋值并显示姓名和学号</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;string&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">// 设计一个学生类，有姓名和学号，可以赋值并显示</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">student</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  //属性</span></span>
<span class="line"><span style="color: #24292E">  string name;</span><span style="color: #6A737D"> // 姓名</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> id;</span><span style="color: #6A737D"> // 学号</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 行为</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">display</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"name:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> name</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"id:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> id </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">set_info</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">s_name</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">s_id</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    name </span><span style="color: #D73A49">=</span><span style="color: #24292E"> s_name;</span></span>
<span class="line"><span style="color: #24292E">    id </span><span style="color: #D73A49">=</span><span style="color: #24292E"> s_id;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  student stu1;</span><span style="color: #6A737D">// 实例化</span></span>
<span class="line"><span style="color: #24292E">  student stu2;</span></span>
<span class="line"><span style="color: #6A737D">  // 一般赋值</span></span>
<span class="line"><span style="color: #24292E">  stu1.name </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"Jack"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  stu1.id </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  stu1.</span><span style="color: #6F42C1">display</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #6A737D">  // 通过行为赋值</span></span>
<span class="line"><span style="color: #24292E">  stu2.</span><span style="color: #6F42C1">set_info</span><span style="color: #24292E">(</span><span style="color: #032F62">"Mary"</span><span style="color: #24292E">, </span><span style="color: #005CC5">2</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  stu2.</span><span style="color: #6F42C1">display</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="权限">权限</h3>
<p>类可以将属性和方法放在不同权限下：</p>
<ul>
<li>public：公共权限，成员类内可以访问，类外也可以访问</li>
<li>protected：保护权限，成员类内可以访问，类外不可以访问，子类可以访问父类的保护成员</li>
<li>private：私有权限，成员类内可以访问，类外不可以访问，
子类不可访问父类的私有成员</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;string&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span><span style="color: #6A737D"> //公共权限</span></span>
<span class="line"><span style="color: #24292E">  string name;</span></span>
<span class="line"><span style="color: #D73A49">protected:</span><span style="color: #6A737D"> // 保护权限</span></span>
<span class="line"><span style="color: #24292E">  string car;</span></span>
<span class="line"><span style="color: #D73A49">private:</span><span style="color: #6A737D"> // 私有权限</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> password;</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D"> // 类内可以访问</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    name </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"Jack"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    car </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"xiaomisu7"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    password </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">123456</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  p.name </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"Mary"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //p.car = "?" // protected 类外不可访问</span></span>
<span class="line"><span style="color: #6A737D">  //p.password = 123 // private 类外不可访问</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="struct与class的区别">struct与class的区别</h3>
<p>C++中class与struct的唯一区别在于<strong>默认的访问权限不同</strong></p>
<ul>
<li>class默认权限私有</li>
<li>struct默认权限公共</li>
</ul>
<h3 id="成员属性私有化">成员属性私有化</h3>
<p>优点：</p>
<ul>
<li>可以自己控制读写权限</li>
<li>可以检测数据有效性</li>
</ul>
<p>基本思路：<strong>用公有方法对私有属性进行操作</strong></p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;string&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #6A737D">// 属性私有</span></span>
<span class="line"><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  string name;</span><span style="color: #6A737D"> // 姓名：可读可写</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">18</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 年龄：只读</span></span>
<span class="line"><span style="color: #24292E">  string hobby;</span><span style="color: #6A737D"> // 爱好：只写</span></span>
<span class="line"><span style="color: #6A737D">// 方法公有</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 设置姓名</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">setName</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">s</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    name </span><span style="color: #D73A49">=</span><span style="color: #24292E"> s;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 获取姓名</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">getName</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"name:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">name</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 获取年龄</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">getAge</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"age:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 设置爱好</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">setHobby</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">s</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    hobby </span><span style="color: #D73A49">=</span><span style="color: #24292E"> s;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  p.</span><span style="color: #6F42C1">setName</span><span style="color: #24292E">(</span><span style="color: #032F62">"Jack"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  p.</span><span style="color: #6F42C1">getAge</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  p.</span><span style="color: #6F42C1">setHobby</span><span style="color: #24292E">(</span><span style="color: #032F62">"jerk"</span><span style="color: #24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="对象的初始化和清理">对象的初始化和清理</h2>
<p>对象的初始化和清理是很重要的安全问题：</p>
<ul>
<li>一个对象或变量没有初始状态，对其使用后果未知</li>
<li>使用完一个对象或变量，没有及时清理，也会造成安全问题</li>
</ul>
<h3 id="构造函数与析构函数">构造函数与析构函数</h3>
<p>C++提供了这两种函数，被编译器自动调用，完成对象初始化与清理工作</p>
<p>这两个工作是强制执行的，若我们不提供，编译器会提供自己的构造函数与析构函数，他们是<strong>空实现</strong></p>
<p><strong>构造函数：</strong>用于创建对象时为对象成员赋值</p>
<ul>
<li><p>语法：<code>&lt;类名&gt;(){}</code></p></li>
<li><p>无返回值，不用写void</p></li>
<li><p>函数名与类名相同</p></li>
<li><p>构造函数可以有参数，可以发生重载</p></li>
<li><p>调用对象时会自动调用构造，只会调用一次</p></li>
</ul>
<p>析构函数：用于对象销毁前自动调用，执行清理操作</p>
<ul>
<li>语法：<code>~&lt;类名&gt;(){}</code></li>
<li>无返回值，不用写void</li>
<li>函数名与类名相同，名前面加~</li>
<li>析构函数不可以有参数，不可发生重载</li>
<li>程序在对象销毁前会自动调用析构。只会调用一次</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 构造函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span><span style="color: #6A737D"> // 栈上的数据，执行完后会被释放，故执行析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="构造函数的分类与调用">构造函数的分类与调用</h3>
<p>分类：</p>
<ul>
<li>参数分：有参构造与无参构造（默认构造）</li>
<li>类型分：普通构造与拷贝构造</li>
</ul>
<p>调用：</p>
<ul>
<li>括号法</li>
<li>显式法</li>
<li>隐式转换法</li>
</ul>
<p><strong>注意：</strong></p>
<ul>
<li><strong>无参构造时不需要加括号，否则编译器会认为是一个函数声明</strong></li>
<li>显式声明中，单纯调用对象<code>&lt;类名&gt;([值])</code>称为<strong>匿名对象</strong>，特点是当前行执行后就会被立即回收</li>
<li><strong>不要利用拷贝构造函数初始化匿名对象</strong></li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 无参构造(默认构造)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"无参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 有参构造</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"有参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 拷贝构造 </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p.age;</span><span style="color: #6A737D"> // 将传入数据拷贝到当前对象</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"拷贝构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 括号法</span></span>
<span class="line"><span style="color: #24292E">  person p;</span><span style="color: #6A737D"> // 默认构造函数被调用(不加括号)</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p1</span><span style="color: #24292E">(</span><span style="color: #005CC5">10</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // 有参构造函数被调用</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(p1);</span><span style="color: #6A737D"> // 拷贝构造函数被调用</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"age of p1:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p1.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"age of p2:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p2.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #6A737D">  // 显式法</span></span>
<span class="line"><span style="color: #24292E">  person p3 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #005CC5">20</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  person p4 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(p3);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 隐式转换法</span></span>
<span class="line"><span style="color: #24292E">  person p5 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 相当于 person p5 = person(10);</span></span>
<span class="line"><span style="color: #24292E">  person p6 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p5;</span><span style="color: #6A737D"> // 相当于 person p6 = person(p5);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="拷贝构造函数调用时机">拷贝构造函数调用时机</h3>
<p>拷贝构造调用的三种情况：</p>
<ul>
<li>使用一个已经创建完毕的对象来初始化一个新对象</li>
<li>值传递的方式给函数参数传值</li>
<li>以值方式返回局部对象</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 无参构造(默认构造)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"无参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 有参构造</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"有参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 拷贝构造  </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p.age;</span><span style="color: #6A737D"> // 将传入数据拷贝到当前对象</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"拷贝构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 使用已经创建完毕的对象来初始化一个新对象</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">test1</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p1</span><span style="color: #24292E">(</span><span style="color: #005CC5">20</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(p1);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 值传递方式给函数参数传值</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">test2</span><span style="color: #24292E">(</span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> ;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 值传递返回局部对象</span></span>
<span class="line"><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #6F42C1">test3</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p1;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> p1;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p1;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">test1</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">test2</span><span style="color: #24292E">(p1);</span></span>
<span class="line"><span style="color: #24292E">  person p2 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">test3</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #24292e">无参构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">----------------</span></span>
<span class="line"><span style="color: #24292e">有参构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">拷贝构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">析构函数被调用</span></span>
<span class="line"><span style="color: #24292e">析构函数被调用</span></span>
<span class="line"><span style="color: #24292e">----------------</span></span>
<span class="line"><span style="color: #24292e">拷贝构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">析构函数被调用</span></span>
<span class="line"><span style="color: #24292e">----------------</span></span>
<span class="line"><span style="color: #24292e">无参构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">析构函数被调用</span></span>
<span class="line"><span style="color: #24292e">析构函数被调用</span></span></code></pre></div></div></figure>
<h3 id="构造函数调用规则">构造函数调用规则</h3>
<p>默认下，编译器至少给一个类添加三个函数：</p>
<ul>
<li>默认构造函数（无参，函数体为空）</li>
<li>默认析构函数（无参，函数体为空）</li>
<li>默认拷贝构造函数，对属性值拷贝</li>
</ul>
<p>调用规则：</p>
<ul>
<li>若用户定义有参构造函数，C++不再提供默认无参构造，但是会提供默认拷贝构造</li>
<li>如果用户定义拷贝构造函数 ，C++不再提供其他构造函数</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 无参构造(默认构造)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"无参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 有参构造</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"有参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // // 拷贝构造 </span></span>
<span class="line"><span style="color: #6A737D">  // person(const person &amp;p){</span></span>
<span class="line"><span style="color: #6A737D">  //   age = p.age; // 将传入数据拷贝到当前对象</span></span>
<span class="line"><span style="color: #6A737D">  //   cout &lt;&lt; "拷贝构造函数被调用" &lt;&lt; endl;</span></span>
<span class="line"><span style="color: #6A737D">  // }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  p.age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">18</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(p);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p2的年龄是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p2.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">```</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">此种情况下，编译器使用了默认拷贝构造，进行了值传递</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">```c</span><span style="color: #D73A49">++</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // // 无参构造(默认构造)</span></span>
<span class="line"><span style="color: #6A737D">  // person(){</span></span>
<span class="line"><span style="color: #6A737D">  //   cout &lt;&lt; "无参构造函数被调用" &lt;&lt; endl;</span></span>
<span class="line"><span style="color: #6A737D">  // }</span></span>
<span class="line"><span style="color: #6A737D">  // 有参构造</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"有参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  p.age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">18</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(p);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p2的年龄是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p2.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">```</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">此种情况下，由于有有参函数，编译器不会提供默认无参函数，同时会报错没有默认无参函数</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">```c</span><span style="color: #D73A49">++</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // // 无参构造(默认构造)</span></span>
<span class="line"><span style="color: #6A737D">  // person(){</span></span>
<span class="line"><span style="color: #6A737D">  //   cout &lt;&lt; "无参构造函数被调用" &lt;&lt; endl;</span></span>
<span class="line"><span style="color: #6A737D">  // }</span></span>
<span class="line"><span style="color: #6A737D">  // // 有参构造</span></span>
<span class="line"><span style="color: #6A737D">  // person(int a){</span></span>
<span class="line"><span style="color: #6A737D">  //   age = a;</span></span>
<span class="line"><span style="color: #6A737D">  //   cout &lt;&lt; "有参构造函数被调用" &lt;&lt; endl;</span></span>
<span class="line"><span style="color: #6A737D">  // }</span></span>
<span class="line"><span style="color: #6A737D">  // 拷贝构造 </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p.age;</span><span style="color: #6A737D"> // 将传入数据拷贝到当前对象</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"拷贝构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  p.age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">18</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(p);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p2的年龄是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p2.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>此种情况下，提供了拷贝函数，则编译器不再提供任何构造函数，同时报错没有默认构造函数</p>
<h3 id="深拷贝与浅拷贝">深拷贝与浅拷贝</h3>
<ul>
<li>浅拷贝：简单的赋值操作（默认拷贝构造即为浅拷贝 ）</li>
<li>深拷贝：在堆区重新申请空间，进行拷贝操作</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 无参构造(默认构造)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"无参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 有参构造</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">iheight</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    height </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E">(iheight);</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"有参构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // // 拷贝构造 </span></span>
<span class="line"><span style="color: #6A737D">  // person(const person &amp;p){</span></span>
<span class="line"><span style="color: #6A737D">  //   age = p.age; // 将传入数据拷贝到当前对象</span></span>
<span class="line"><span style="color: #6A737D">  //   cout &lt;&lt; "拷贝构造函数被调用" &lt;&lt; endl;</span></span>
<span class="line"><span style="color: #6A737D">  // }</span></span>
<span class="line"><span style="color: #6A737D">  // 析构函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">    // 在析构函数中进行堆区数据释放</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (height</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">NULL</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">delete</span><span style="color: #24292E"> height;</span></span>
<span class="line"><span style="color: #24292E">      height </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">NULL</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int*</span><span style="color: #24292E"> height;</span><span style="color: #6A737D"> // 身高，使用指针将数据创建在堆区</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p1</span><span style="color: #24292E">(</span><span style="color: #005CC5">18</span><span style="color: #24292E">,</span><span style="color: #005CC5">160</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p1的年龄是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p1.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p1的身高是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p1.height </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(p1);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p2的年龄是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p2.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p2的身高是:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p2.height </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>该代码会卡住，原因是利用拷贝构造只进行了值传递，p1与p2执行完毕后，均执行析构函数，对height指向的空间进行释放，但是其中一个已经执行释放后，另一个再次释放会产生非法操作，故出错</p>
<p>这也就是浅拷贝的缺点：只进行了值传递，我们需要利用深拷贝来结局</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6A737D">// 拷贝构造 </span></span>
<span class="line"><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> person </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">p){</span></span>
<span class="line"><span style="color: #24292E">  age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p.age;</span><span style="color: #6A737D"> // 将传入数据拷贝到当前对象</span></span>
<span class="line"><span style="color: #6A737D">  // 深拷贝，在堆区开辟新的空间</span></span>
<span class="line"><span style="color: #24292E">  height </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">p.height);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"拷贝构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>即在拷贝构造中，重新给拷贝的指针变量申请一块空间</p>
<p><strong>如果属性有在堆区开辟的，一定要自己提供拷贝构造函数，防止浅拷贝出现问题</strong></p>
<h3 id="初始化列表">初始化列表</h3>
<p>C++提供了初始化列表来初始化属性</p>
<p>语法：<code>&lt;构造函数&gt;(): &lt;属性1&gt;(&lt;值1&gt;), &lt;属性2&gt;(&lt;值2&gt;) ... {}</code></p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> c;</span></span>
<span class="line"><span style="color: #6A737D">  // 初始化列表赋值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">c</span><span style="color: #24292E">):</span><span style="color: #6F42C1">a</span><span style="color: #24292E">(</span><span style="color: #005CC5">10</span><span style="color: #24292E">), </span><span style="color: #6F42C1">b</span><span style="color: #24292E">(</span><span style="color: #005CC5">20</span><span style="color: #24292E">), </span><span style="color: #6F42C1">c</span><span style="color: #24292E">(</span><span style="color: #005CC5">30</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"a:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.a </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"b:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.b </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"c:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.c </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="类对象作为类成员">类对象作为类成员</h3>
<p>C++中的成员可以是另一个类的对象，称为<strong>对象成员</strong></p>
<p>如</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">A</span><span style="color: #24292E">{};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">B</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">    A a;</span></span>
<span class="line"><span style="color: #24292E">};</span></span></code></pre></div></div></figure>
<p>该B类中有对象A作为成员，则A为对象成员</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;string&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">phone</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  string brand;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">float</span><span style="color: #24292E"> price;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">phone</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">pname</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    brand </span><span style="color: #D73A49">=</span><span style="color: #24292E"> pname;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"phone构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~phone</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"phone析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  string name;</span></span>
<span class="line"><span style="color: #24292E">  phone iphone;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">pname</span><span style="color: #24292E">, </span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">pbrand</span><span style="color: #24292E">):</span><span style="color: #6F42C1">name</span><span style="color: #24292E">(pname),</span><span style="color: #6F42C1">iphone</span><span style="color: #24292E">(pbrand){</span></span>
<span class="line"><span style="color: #6A737D">    //相当于phone iphone = pname;的隐式转换</span></span>
<span class="line"><span style="color: #24292E">    cout</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"person构造函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"person析构函数被调用"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p</span><span style="color: #24292E">(</span><span style="color: #032F62">"小明"</span><span style="color: #24292E">,</span><span style="color: #032F62">"苹果"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"姓名:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.name </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"手机品牌:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.iphone.brand </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #24292e">phone构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">person构造函数被调用</span></span>
<span class="line"><span style="color: #24292e">姓名:小明</span></span>
<span class="line"><span style="color: #24292e">手机品牌:苹果</span></span>
<span class="line"><span style="color: #24292e">person析构函数被调用</span></span>
<span class="line"><span style="color: #24292e">phone析构函数被调用</span></span></code></pre></div></div></figure>
<p>注意构造函数的调用顺序：</p>
<ul>
<li>当其他类对象作为本类成员，构造时先构造类对象，在构造自身</li>
<li>当其他类对象作为本类成员，析构时先析构自身，再析构类对象</li>
</ul>
<h3 id="静态成员">静态成员</h3>
<p>在成员变量与成员函数前加上关键字static，称为静态成员</p>
<p>分类：</p>
<ul>
<li>静态成员变量
<ul>
<li>不属于某个对象，所有对象共享一份数据</li>
<li>编译阶段分配内存</li>
<li>类内声明，类外初始化</li>
</ul></li>
<li>静态成员函数
<ul>
<li>所有成员共享同一个函数</li>
<li>静态成员函数只能访问静态成员变量</li>
</ul></li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span><span style="color: #6A737D"> // 需要类内声明，类外初始化</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> c;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"静态成员函数f调用"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">    a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">    // c = 200; // 静态成员函数不可以访问非静态成员变量</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b;</span><span style="color: #6A737D"> // 静态成员变量也有权限</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">::a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 在类外初始化，需要指定作用域</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">::b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 也需要在类外初始化</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span><span style="color: #6A737D"> // 栈上的数据，执行完后会被释放，故执行析构函数</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  person p2;</span></span>
<span class="line"><span style="color: #24292E">  p2.a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">200</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 数据共享，此处改变即一起改变</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span><span style="color: #6A737D"> // 通过对象进行访问</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">::a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span><span style="color: #6A737D"> // 通过类名进行访问</span></span>
<span class="line"><span style="color: #6A737D">  // cout &lt;&lt; p.b&lt;&lt;endl; // 不可访问</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 同样两种访问模式</span></span>
<span class="line"><span style="color: #24292E">  p.</span><span style="color: #6F42C1">f</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">::</span><span style="color: #6F42C1">f</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>应用：实现单例对象，即一个类只有一个类对象</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> Singleton</span><span style="color: #D73A49">*</span><span style="color: #24292E"> m_insntance;</span><span style="color: #6A737D"> // 存储该类的唯一实例</span></span>
<span class="line"><span style="color: #6A737D">  // 将构造与析构设为私有</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">(){}</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~Singleton</span><span style="color: #24292E">(){}</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 删除拷贝构造与赋值运算符构造</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #E36209">obj</span><span style="color: #24292E">) </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">delete</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">Singleton</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">=</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">) </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">delete</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 创建该唯一实例, 只能通过该方法创建获得对象</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #6F42C1">getInstance</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">m_insntance){</span></span>
<span class="line"><span style="color: #24292E">      m_insntance </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> m_insntance;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  string m_name;</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">setName</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">string</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #E36209">name</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    m_name </span><span style="color: #D73A49">=</span><span style="color: #24292E"> name;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">string</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">getName</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> m_name;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #24292E">Singleton</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">::m_insntance </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">NULL</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 第一次调用创建实例</span></span>
<span class="line"><span style="color: #24292E">  Singleton</span><span style="color: #D73A49">*</span><span style="color: #24292E"> s1 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">::</span><span style="color: #6F42C1">getInstance</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> s1-&gt;</span><span style="color: #6F42C1">getName</span><span style="color: #24292E">()</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #6A737D">  // 第二次调用使用已经创建的实例</span></span>
<span class="line"><span style="color: #24292E">  Singleton</span><span style="color: #D73A49">*</span><span style="color: #24292E"> s2 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Singleton</span><span style="color: #24292E">::</span><span style="color: #6F42C1">getInstance</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> s1-&gt;</span><span style="color: #6F42C1">getName</span><span style="color: #24292E">()</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="c对象模型与this指针">C++对象模型与this指针</h2>
<h3 id="成员变量与成员函数分开存储">成员变量与成员函数分开存储</h3>
<p>c++中，类内成员变量与成员函数分开存储</p>
<p>只有非静态成员变量才属于类的对象上</p>
<p>对于空对象，编译器会给每个空对象分配一个字节空间，是为了区分空对象占内存的位置</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person2</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person3</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){}</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person p;</span></span>
<span class="line"><span style="color: #24292E">  person2 p2;</span></span>
<span class="line"><span style="color: #24292E">  person3 p3;</span></span>
<span class="line"><span style="color: #6A737D">  // 占用内存为1</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"size of empty class: "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(p)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 占用内存为4</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"size of class person2: "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(p2)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 静态成员与非静态成员函数不属于类的对象上，故占用内存也为4</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"size of class person3: "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(p3)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="this指针">this指针</h3>
<p>C++通过提供this指针解决了区分多个对象调用同一块代码分不清的问题</p>
<p><strong>this指针指向被调用的成员函数所属的对象</strong>，不需要定义，直接使用</p>
<p>用途：</p>
<ul>
<li>形参和成员变量同名时，可以用this指针来区分</li>
<li>在类的非静态成员函数中返回对象本身，可使用<code>retrun *this</code></li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">age</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #6A737D">    // 当形参和成员变量同名时,this 指针指向被调用成员函数所属对象</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> age;</span><span style="color: #6A737D"> // 此时this-&gt;age和定义的成员变量age是同一个</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 成员函数返回对象本身</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">addage</span><span style="color: #24292E">(</span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;age</span><span style="color: #D73A49">+=</span><span style="color: #24292E">p.age;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #005CC5">this</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 解决名称冲突</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p</span><span style="color: #24292E">(</span><span style="color: #005CC5">18</span><span style="color: #24292E">); </span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(</span><span style="color: #005CC5">10</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"age:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">p.age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 返回对象本身可以实现链式调用</span></span>
<span class="line"><span style="color: #24292E">  p2.</span><span style="color: #6F42C1">addage</span><span style="color: #24292E">(p).</span><span style="color: #6F42C1">addage</span><span style="color: #24292E">(p).</span><span style="color: #6F42C1">addage</span><span style="color: #24292E">(p);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"age of p2:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">p2.age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="空指针访问成员函数">空指针访问成员函数</h3>
<p>C++允许空指针调用成员函数，但是要注意有没有用到this指针</p>
<p>如果用到this指针，要注意保证代码的鲁棒性</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">show</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"this is person class"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">showage</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">    // 防止指向空 </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #005CC5">this</span><span style="color: #D73A49">==</span><span style="color: #005CC5">NULL</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">return</span><span style="color: #24292E"> ;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #6A737D">    // 调用成员变量时，默认在前面加this-&gt;,但此时p是空指针，故指向的是空对象，this没有指向数据</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"age = "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">=</span><span style="color: #24292E">  </span><span style="color: #005CC5">NULL</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  p-&gt;</span><span style="color: #6F42C1">show</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  p-&gt;</span><span style="color: #6F42C1">showage</span><span style="color: #24292E">(); </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="const修饰成员函数">const修饰成员函数</h3>
<p><strong>常函数：</strong></p>
<ul>
<li>成员函数后加const称该函数为常函数</li>
<li>常函数内不可以修改成员属性</li>
<li>成员属性声明时加关键字mutable后，在常函数内依然可以修改</li>
</ul>
<p><strong>常对象：</strong></p>
<ul>
<li>声明对象前加const称该对象为常对象</li>
<li>常对象构造时需要对内部成员变量初始化（构造函数）</li>
<li>常对象只能调用常函数</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">mutable</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b;</span><span style="color: #6A737D"> // 加上mutable也可以在常函数中修改</span></span>
<span class="line"><span style="color: #6A737D">  // this指针本身是指针常量，指针指向是不可修改的，指针指向的值是可以修改的</span></span>
<span class="line"><span style="color: #6A737D">  // 而加上const修饰后，修饰的是this指向的值，让指向的值也不可修改</span></span>
<span class="line"><span style="color: #6A737D">  // 相当于const person * const this;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">show</span><span style="color: #24292E">() </span><span style="color: #D73A49">const</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #6A737D">    //this-&gt;age = 100; // 此时不可修改 </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){}</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(){</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 常对象</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">const</span><span style="color: #24292E"> person p;</span></span>
<span class="line"><span style="color: #6A737D">  // p.age = 100; // 常对象下不能修改值</span></span>
<span class="line"><span style="color: #24292E">  p.b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 但有mutable的可以修改</span></span>
<span class="line"><span style="color: #6A737D">  // p.f() // 常对象只能调用常函数</span></span>
<span class="line"><span style="color: #24292E">  p.</span><span style="color: #6F42C1">show</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="类的特殊成员函数">类的特殊成员函数</h3>
<p>特殊成员函数包括默认构造函数、拷贝构造函数、拷贝赋值运算符、移动构造函数、移动赋值运算符、析构函数，他们均可以用以下两个关键字修饰</p>
<ul>
<li><p><code>=delete</code>：</p>
<p>可以在函数声明后添加
<code>=delete</code>来删除当前函数，如删除构造函数、删除不需要的传参类型</p></li>
<li><p><code>=default</code>：</p>
<p>加在特殊函数后，可以用来声明一个默认特殊函数，还可以自动使用默认值初始化变量</p></li>
</ul>
<h3 id="可平凡复制类">可平凡复制类</h3>
<p>C++中，各种数据类型及他们的数组、指针、枚举等在内存中是连续存储的，可以使用memcpy()函数进行拷贝，称为可平凡复制类型</p>
<p>一个类若满足以下条件，被称为可平凡复制类，也是一种可平凡复制类型</p>
<ul>
<li>没有虚函数</li>
<li>没有用户自定义的特殊成员函数</li>
<li>有自动生成的析构函数</li>
<li>所有非静态成员变量也是可平凡复制类型</li>
<li>拷贝、移动构造函数，拷贝、移动赋值运算符中至少有一个是未被删除的</li>
<li>对于继承类，其父类要满足上述条件</li>
</ul>
<p>可以使用<code>&lt;type_traits&gt;</code>库中的<code>is_trivially_copyable&lt;类&gt;::value</code>来判断是否可拷贝</p>
<h3 id="标准布局类">标准布局类</h3>
<p>C++中，所有标量类型都是标准布局类型</p>
<p>对一个非继承类，满足以下条件被称为标准布局类</p>
<ul>
<li>没有虚函数</li>
<li>所有类成员都具有相同访问属性</li>
<li>所有类成员都是标准布局类型</li>
<li>若类是继承类，则满足该类和父类中只有一个类有非静态数据成员，且类型与访问控制满足上述条件</li>
</ul>
<p>可以使用<code>&lt;type_traits&gt;</code>库中的<code>is_standard_;leyout&lt;类&gt;::value</code>来判断是否可拷贝</p>
<h2 id="友元">友元</h2>
<p>友元可以让一个函数或者类访问另一个类中的私有成员</p>
<p>友元的关键字为<code>friend</code></p>
<h3 id="全局函数做友元">全局函数做友元</h3>
<p>在class中声明对应全局函数，并在最前面加<code>friend</code>关键词，可以声明友元</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">building</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">friend</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fir</span><span style="color: #24292E">(</span><span style="color: #6F42C1">building</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">building</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // 声明该全局函数为building类的友元</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  string sitting_room;</span></span>
<span class="line"><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  string bedroom;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">building</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    sitting_room </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"客厅"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    bedroom </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"卧室"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fir</span><span style="color: #24292E">(</span><span style="color: #6F42C1">building</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">building</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"访问公共属性:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">building.sitting_room</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"访问私有属性:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">building.bedroom</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  building b;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">fir</span><span style="color: #24292E">(b);</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="类做友元">类做友元</h3>
<p>在class中声明对应类，并在最前面加<code>friend</code>关键词，可以声明友元，被声明的类可以访问原类中的私有属性</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">buildings</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fri</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  buildings</span><span style="color: #D73A49">*</span><span style="color: #24292E"> building;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">fri</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">visit</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">buildings</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">friend</span><span style="color: #24292E"> </span><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fri</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 声明fri类是building类的友元</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  string sitting_room;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">buildings</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  string bedroom;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 在类外写成员函数</span></span>
<span class="line"><span style="color: #6F42C1">buildings</span><span style="color: #24292E">::</span><span style="color: #6F42C1">buildings</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  sitting_room </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"客厅"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  bedroom </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"卧室"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6F42C1">fri</span><span style="color: #24292E">::</span><span style="color: #6F42C1">fri</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  building </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> buildings;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fri</span><span style="color: #24292E">::</span><span style="color: #6F42C1">visit</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"访问公共属性:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">building-&gt;sitting_room</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"访问私有属性:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">building-&gt;bedroom</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span><span style="color: #6A737D"> // 友元可以访问类中的私有属性</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  fri f;</span></span>
<span class="line"><span style="color: #24292E">  f.</span><span style="color: #6F42C1">visit</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="成员函数做友元">成员函数做友元</h3>
<p>在class中声明对应类中的成员函数，并在最前面加<code>friend</code>关键词，可以声明友元，被声明的成员函数可以访问原类中的私有属性</p>
<p><figure class="shiki C++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div><div class="code"><pre><code>#include <iostream>
using namespace std;
class buildings;
class fri{
public:
  buildings* building;
  fri(){
    building = new buildings;
  }
  void visit(); // 让visit可以访问buildings中的私有属性
};

class buildings{
  friend void fri::visit(); // 声明fri类下的visit成员函数是building类的友元
public:
  string sitting_room;
  buildings(){
    sitting_room = "客厅";
    bedroom = "卧室";
  }
private:
  string bedroom;
};

void fri::visit(){
  cout &lt;&lt;"访问公共属性:" &lt;<building->sitting_room&lt;&lt;endl;
  cout &lt;&lt;"访问私有属性:" &lt;<building->bedroom&lt;&lt;endl; // 友元可以访问类中的私有属性
}

int main(){
  fri f;
  f.visit();
}</building-></building-></iostream></code></pre></div></div></figure></p>
<h2 id="运算符重载">运算符重载</h2>
<p>运算符重载可以对已有的运算符重新定义，赋予另一种功能以适用于不同的数据类型</p>
<p>如我们通过写成员函数来实现两个类相加属性后返回新的对象</p>
<p>可以通过编译器提供的通用名称<code>operator</code>来重载运算符以简化运算</p>
<p>重载的本质调用为（以person类为例）：</p>
<ul>
<li>成员函数：<code>person p3 = p1.operator&lt;运算符&gt;(p2)</code></li>
<li>全局函数：<code>person p3 = p1.operator&lt;运算符&gt;(p1, p2)</code></li>
</ul>
<p>注意：</p>
<ul>
<li>运算符重载也可以实现函数重载</li>
<li>对于内置数据类型的表达式的运算符是不可以重载的</li>
<li>不要滥用运算符重载</li>
</ul>
<h3 id="加号运算符重载">加号运算符重载</h3>
<p>成员函数：</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">+</span><span style="color: #24292E">(</span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    person temp;</span></span>
<span class="line"><span style="color: #24292E">    temp.a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;a</span><span style="color: #D73A49">+</span><span style="color: #24292E">p.a;</span></span>
<span class="line"><span style="color: #24292E">    temp.b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;b</span><span style="color: #D73A49">+</span><span style="color: #24292E">p.b;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> temp;</span></span>
<span class="line"><span style="color: #24292E"> }</span></span></code></pre></div></div></figure>
<p>全局函数：</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">+</span><span style="color: #24292E">(</span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p1</span><span style="color: #24292E">, </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p2</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  person temp;</span></span>
<span class="line"><span style="color: #24292E">    temp.a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p1.a</span><span style="color: #D73A49">+</span><span style="color: #24292E">p2.a;</span></span>
<span class="line"><span style="color: #24292E">    temp.b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p1.b</span><span style="color: #D73A49">+</span><span style="color: #24292E">p2.b;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> temp;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="左移运算符重载">左移运算符重载</h3>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6A737D">// 只能全局重载左移运算符</span></span>
<span class="line"><span style="color: #6A737D">// 若在类内重载会称为p.operator&lt;&lt;(cout) 即p&lt;&lt;cout (cout是ostream流中的对象)</span></span>
<span class="line"><span style="color: #6A737D">// 这里先写cout即可实现cout在左边p在右边</span></span>
<span class="line"><span style="color: #6A737D">// 返回值作为cout本身的引用，可以实现链式编程</span></span>
<span class="line"><span style="color: #6F42C1">ostream</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">&lt;&lt;</span><span style="color: #24292E">(</span><span style="color: #6F42C1">ostream</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">cout</span><span style="color: #24292E">, </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"a="</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.a </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"b="</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> p.b;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> cout;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="递增运算符重载">递增运算符重载</h3>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6A737D">// 前置++</span></span>
<span class="line"><span style="color: #6A737D">// 这里返回引用是为了确保只对同一个数据进行操作</span></span>
<span class="line"><span style="color: #6F42C1">myint</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">++</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  num</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 先进行自增运算</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #005CC5">this</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 再返回自身</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 后置++</span></span>
<span class="line"><span style="color: #6A737D">// 这里为了防止重复，添加一个int占位符来实现函数重载以区分前后置</span></span>
<span class="line"><span style="color: #6F42C1">myint</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">++</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  myint temp </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #005CC5">this</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  num</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> temp;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="赋值运算符重载">赋值运算符重载</h3>
<p>C++编译器会额外给一个类添加赋值运算符的重载函数</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">age;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">person</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">age</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E">(age);</span><span style="color: #6A737D"> // 年龄放在堆区</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 将age内存释放</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~person</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (age</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">NULL</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">delete</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">      age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">NULL</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p1</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"p1's age:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p1.age </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  person </span><span style="color: #6F42C1">p2</span><span style="color: #24292E">(</span><span style="color: #005CC5">2</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  p2 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p1;</span><span style="color: #6A737D"> // 赋值操作</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"p2's age:"</span><span style="color: #D73A49">&lt;&lt;*</span><span style="color: #24292E">p2.age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>该代码出错，由于age开到了同一块堆区内存，故在p1赋值给p2时，两者的age指针都指向同一块区域</p>
<p>则当p2执行完毕，执行析构函数时，将该堆区内存释放；再等p1执行完毕，执行析构函数时，将已经释放的内存重复释放了，故报错</p>
<p>我们需要通过重载赋值运算符来实现深拷贝</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6A737D">// 重载赋值运算符</span></span>
<span class="line"><span style="color: #6F42C1">person</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">=</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #6A737D">  // 首先判断是否有属性在堆区，若有先释放，再深拷贝</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (age</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">NULL</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">delete</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">    age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">NULL</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">p.age);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #005CC5">this</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="关系运算符重载">关系运算符重载</h3>
<p>实现自定义数据类型的比较</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6A737D">// 重载==运算符</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">bool</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">==</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;name</span><span style="color: #D73A49">==</span><span style="color: #24292E">p.name </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;age</span><span style="color: #D73A49">==</span><span style="color: #24292E">p.age){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E"> </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">false</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 重载!=运算符</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">bool</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">!=</span><span style="color: #24292E">(</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">person</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;name</span><span style="color: #D73A49">==</span><span style="color: #24292E">p.name </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;age</span><span style="color: #D73A49">==</span><span style="color: #24292E">p.age){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">false</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E"> </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span></code></pre></div></div></figure>
<p>大于小于类似</p>
<h3 id="函数调用运算符重载">函数调用运算符重载</h3>
<ul>
<li>函数调用运算符即()</li>
<li>重载后的使用方式很像函数的调用，故也称为仿函数</li>
<li>仿函数没有固定写法</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">print</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  //重载函数调用运算符</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">()</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">s</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> s </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">operator</span><span style="color: #6F42C1">()</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">n1</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">n2</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> n1</span><span style="color: #D73A49">+</span><span style="color: #24292E">n2;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span></code></pre></div></div></figure>
<p>也可以用匿名函数对象进行调用</p>
<h2 id="继承">继承</h2>
<p>有些类与其他类之间除了有共性，还有自己的特性，我们可以用继承的技术来减少重复代码优点：减少重复代码</p>
<p>语法：<code>&lt;子类&gt;: &lt;继承方式&gt; &lt;父类&gt;</code></p>
<p>其中子类也称作派生类，父类也称基类</p>
<p>子类中的成员包含两部分：</p>
<p>一类是从基类继承过来的，一类是自己增加的成员</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">page</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f1</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">  {</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"f1"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f2</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"f2"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f3</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"f3"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">page2</span><span style="color: #24292E">:</span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">page</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">s1</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"s1"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span></code></pre></div></div></figure>
<h3 id="继承方式">继承方式</h3>
<img src="/C++/%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1/image-20250602151243297.png" class="" title="继承方式">
<p>即：</p>
<ul>
<li>私有成员子类均不可访问</li>
<li>公共继承下：各成员权限不变</li>
<li>保护继承下：public变为protected</li>
<li>私有继承下：public与protected变为private</li>
</ul>
<h3 id="继承中的对象模型">继承中的对象模型</h3>
<p>父类中所有非静态成员属性都会被子类继承</p>
<p>而私有属性被编译器隐藏，故访问不到</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">protected:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">private:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> c;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">son</span><span style="color: #24292E">:</span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> d;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 结果为16，即父类中所有属性都会被继承</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(son)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="继承中的构造与析构顺序">继承中的构造与析构顺序</h3>
<p>子类继承父类后，创建子类对象时，也会调用父类的构造函数</p>
<p>顺序：先构造父类，再构造子类，析构相反</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">base</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">base</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"base构造函数"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~base</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"base析构函数"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">son</span><span style="color: #24292E">:</span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">base</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">son</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"son构造函数"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~son</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"son析构函数"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  son s;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #24292e">base构造函数</span></span>
<span class="line"><span style="color: #24292e">son构造函数</span></span>
<span class="line"><span style="color: #24292e">son析构函数</span></span>
<span class="line"><span style="color: #24292e">base析构函数</span></span></code></pre></div></div></figure>
<h3 id="同名成员处理方式">同名成员处理方式</h3>
<p>当子类和父类出现同名成员：子类的同名成员会隐藏掉所有父类中同名成员（函数重载也会被隐藏）</p>
<ul>
<li>访问子类同名成员：直接访问</li>
<li>访问父类同名成员：加作用域</li>
</ul>
<p>静态与非静态处理方式一样</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b; </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"f in fa"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">ff</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"ff in fa"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">son</span><span style="color: #24292E">:</span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">son</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">200</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"f in son"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">static</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">ff</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"ff in son"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">::b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">son</span><span style="color: #24292E">::b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">20</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  son s;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"a in son:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s.a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #6A737D">  // 加作用域访问父类中的同名成员变量</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"a in fa:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s.fa::a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  s.</span><span style="color: #6F42C1">f</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #6A737D">  // 加作用域调用父类中的同名成员函数</span></span>
<span class="line"><span style="color: #24292E">  s.fa::</span><span style="color: #6F42C1">f</span><span style="color: #24292E">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 非静态同名成员访问：通过对象</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"static b in son:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s.b</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"static b in fa:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s.fa::b</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  s.</span><span style="color: #6F42C1">ff</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  s.fa::</span><span style="color: #6F42C1">ff</span><span style="color: #24292E">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 非静态同名成员访问：通过类名</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"static b in son:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #6F42C1">son</span><span style="color: #24292E">::b </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl; </span></span>
<span class="line"><span style="color: #6A737D">  // 第一个::代表通过类名访问，第二个::代表访问父类作用域下</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"static b in fa:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #6F42C1">son</span><span style="color: #24292E">::</span><span style="color: #6F42C1">fa</span><span style="color: #24292E">::b</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">son</span><span style="color: #24292E">::</span><span style="color: #6F42C1">ff</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">son</span><span style="color: #24292E">::</span><span style="color: #6F42C1">fa</span><span style="color: #24292E">::</span><span style="color: #6F42C1">ff</span><span style="color: #24292E">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="多继承">多继承</h3>
<p>C++允许一个类继承多个类</p>
<p>语法：<code>&lt;子类&gt;: &lt;继承方式&gt; &lt;父类1&gt;, &lt;继承方式&gt; &lt;父类2&gt;...</code></p>
<p>同名成员出现时需要加作用域区分</p>
<p><strong>实际开发时不建议使用多继承</strong></p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"f in fa"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa2</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">fa2</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    a</span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">200</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"f in fa"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">son</span><span style="color: #24292E">:</span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa</span><span style="color: #24292E">, </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fa2</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> c;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> d;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">son</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    c </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">300</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    d </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">400</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 多继承子类空间</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"size of son:"</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;sizeof</span><span style="color: #24292E">(son)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  son s;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"a in fa:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s.fa::a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"a in fa2:"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s.fa2::a</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="菱形继承">菱形继承</h3>
<p>概念：两个派生类继承同一个基类，又有某个类同时继承两个派生类</p>
<p>菱形继承时，两个父类拥有相同数据，需要加作用域区分</p>
<p>但该数据对于最后的子类来说存在两份，会浪费空间，需要利用<strong>虚继承</strong>来解决问题</p>
<p>在需要虚继承的部分的访问权限前添加关键字<code>vritual</code>即可，此时对应父类称为<strong>虚基类</strong></p>
<p>原理：此时的父类继承的是虚基类指针(vbptr)，指向一个虚基类表，该表存储了指针位置以及对应偏移量，根据偏移量便可以找到继承的那唯一一份数据</p>
<p>缺点：虚继承占用内存很大</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> age;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// sheep 继承了 animal</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">sheep</span><span style="color: #24292E">: </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// camel 继承了 animal</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">camel</span><span style="color: #24292E">: </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// alpaca 继承了 sheep和camel</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">alpaca</span><span style="color: #24292E">: </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">sheep</span><span style="color: #24292E">, </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">camel</span><span style="color: #24292E">{};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  alpaca st;</span></span>
<span class="line"><span style="color: #6A737D">  // 菱形继承时，两个父类有相同数据，需要加作用域区分</span></span>
<span class="line"><span style="color: #24292E">  st.sheep::age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">18</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  st.camel::age </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">20</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"age of sheep: "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">st.sheep::age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"age of camel: "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">st.camel::age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">"age of alpaca: "</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">st.alpaca::age</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="多态">多态</h2>
<h3 id="分类">分类</h3>
<ul>
<li>静态多态：函数和运算符重载属于静态多态，复用函数名；函数地址在编译阶段确定</li>
<li>动态多态：派生类和虚函数实现运行时多态；函数地址在运行阶段确定</li>
</ul>
<p>### 动态多态</p>
<p>满足条件：</p>
<ul>
<li><p>存在继承关系</p></li>
<li><p>子类要重写父类的虚函数</p>
<p>（重写即函数返回值类型、函数名、参数列表完全相同）</p></li>
</ul>
<p>使用：父类的指针或者引用指向子类对象</p>
<p>原理：父类记录的也是虚基类指针，指向对应虚基类表。当子类重写后，对应指向的虚基类表被现子类覆盖，得到对应参数</p>
<p>优点：</p>
<ul>
<li>组织结构清晰</li>
<li>可读性强</li>
<li>前期后期拓展以及维护性高</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">  // 虚函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">speak</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"speaking"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">cat</span><span style="color: #24292E">: </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">speak</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"cat is speaking"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 地址在编译阶段确定函数地址，但为了让多个类输出对应，需要在运行时确定</span></span>
<span class="line"><span style="color: #6A737D">// 当给animal中的speak变为虚函数后，便可以实现子类重写父类</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dospeak</span><span style="color: #24292E">(</span><span style="color: #6F42C1">animal</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">ani</span><span style="color: #24292E">){</span><span style="color: #6A737D"> // 父类引用</span></span>
<span class="line"><span style="color: #24292E">  ani.</span><span style="color: #6F42C1">speak</span><span style="color: #24292E">();</span><span style="color: #6A737D"> // 但调用的是animal中的speak函数</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  cat cat;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">dospeak</span><span style="color: #24292E">(cat);</span><span style="color: #6A737D"> // 父类引用指向了子类</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>在开发时，提倡开闭原则：即对扩展进行开放，对修改进行关闭</p>
<h3 id="纯虚函数与抽象类">纯虚函数与抽象类</h3>
<p>多态中，通常父类中的虚函数实现是毫无意义的，都是调用子类中的重写内容</p>
<p>因此可以将虚函数改为纯虚函数</p>
<p>语法：<code>virtual &lt;返回值类型&gt; &lt;函数名&gt;([参数列表]) = 0;</code></p>
<p>此时这个类称为<strong>抽象类</strong></p>
<ul>
<li>抽象类无法实例化对象</li>
<li>子类必须重写抽象类中的纯虚函数，否则也属于抽象类</li>
</ul>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">base</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">func</span><span style="color: #24292E">() </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 纯虚函数</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">son</span><span style="color: #24292E"> :</span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">base</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #6A737D">// 子类必须重写父类中的纯虚函数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">func</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"func调用"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // base b; 不允许实例化抽象类</span></span>
<span class="line"><span style="color: #24292E">  base </span><span style="color: #D73A49">*</span><span style="color: #24292E">b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> son;</span></span>
<span class="line"><span style="color: #24292E">  b-&gt;</span><span style="color: #6F42C1">func</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="虚析构与纯虚析构">虚析构与纯虚析构</h3>
<p>多态使用时，如果子类中有属性开辟到堆区，则父类指针在释放时就无法调用到子类的虚构代码，此时需要将父类中的析构函数改为<strong>虚析构或纯虚析构</strong></p>
<ul>
<li>可以解决父类指针释放子类对象</li>
<li>都需要有函数具体实现</li>
</ul>
<p>其中，纯虚析构需要类外实现</p>
<p>有纯虚析构后该类便成为了抽象类</p>
<p>语法：<code>virtual ~&lt;类名&gt;(){}</code>或<code>virtual ~&lt;类名&gt;()=0;</code></p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;iostream&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">speak</span><span style="color: #24292E">() </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // 用虚析构解决父类指针释放子类对象时释放不完全的问题</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #6F42C1">~animal</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"animal析构调用"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">cat</span><span style="color: #24292E">: </span><span style="color: #D73A49">public</span><span style="color: #24292E"> </span><span style="color: #6F42C1">animal</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #D73A49">public:</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">cat</span><span style="color: #24292E">(</span><span style="color: #6F42C1">string</span><span style="color: #24292E"> </span><span style="color: #E36209">name</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    cname </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #6F42C1">string</span><span style="color: #24292E">(name);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">virtual</span><span style="color: #24292E"> </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">speak</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;*</span><span style="color: #24292E">cname</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"'s speaking"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">~cat</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (cname </span><span style="color: #D73A49">!=</span><span style="color: #005CC5">NULL</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">"cat析构调用"</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">delete</span><span style="color: #24292E"> cname;</span></span>
<span class="line"><span style="color: #24292E">      cname </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">NULL</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  string </span><span style="color: #D73A49">*</span><span style="color: #24292E">cname;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  animal </span><span style="color: #D73A49">*</span><span style="color: #24292E"> ani </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #6F42C1">cat</span><span style="color: #24292E">(</span><span style="color: #032F62">"Tom"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  ani-&gt;</span><span style="color: #6F42C1">speak</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #6A737D">  // 父类指针析构时不会调用子类析构函数，导致若子类有析构属性时不会被释放</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">delete</span><span style="color: #24292E"> ani;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="杂项">杂项</h2>
<h3 id="override与final限定符">override与final限定符</h3>
<p>在基类是虚函数的情况下，子类对该虚函数进行重写，在要重写的函数后面加上<code>override</code>可以防止因为子类的拼写错误，数据类型错误等问题，导致无法调用到子类而直接调用了基类</p>
<p>（若不相同会直接报错）</p>
<p>在虚函数声明的结尾加上<code>final</code>可以防止该虚函数被子类重写，在类声明的后面加上<code>final</code>可以防止该类被继承</p>
<p>注意这两个限定符不是保留关键字</p>
<h3 id="const成员函数">const成员函数</h3>
<p>在成员函数声明和定义的后面加上关键字<code>const</code></p>
<p>const成员函数不能修改其成员变量，不能调用非const成员函数，不能通过const类型的对象调用非const成员函数</p>
<p><strong>即常量对象只可以调用常量方法</strong></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/C-C/" rel="tag"># C/C++</a>
              <a href="/tags/OOP/" rel="tag"># OOP</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/C++/%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/" rel="prev" title="【C++】命名空间">
                  <i class="fa fa-angle-left"></i> 【C++】命名空间
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/C++/%E5%AE%8F%E5%AE%9A%E4%B9%89/" rel="next" title="【C&#x2F;C++】宏定义">
                  【C/C++】宏定义 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">IzayoiSakuye</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

<!-- hexo injector body_end start -->
<script src="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.js"></script>

  <script>
  const CODE_CONFIG = {
    beautify: true,
    highlightCopy: true,
    highlightLang: true,
    highlightHeightLimit: undefined,
    isHighlightShrink: false,
    copy: {
      success: 'Copy Success',
      error: 'Copy Error',
      noSupport: 'Browser Not Support',
    }
  };
  console.log(
    `%c hexo-shiki-plugin %c v1.0.27 %c https://github.com/nova1751/hexo-shiki-plugin`,
    "color: #fff; background: #5f5f5f",
    "color: #fff; background: #80c8f8",
    ""
  );
  </script>
  <!-- hexo injector body_end end --></body>
</html>
