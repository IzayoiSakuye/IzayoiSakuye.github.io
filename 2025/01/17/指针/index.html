<!doctype html>
<html lang="zh"><head>
<title>【C/C++】指针 - 红魔咖啡馆</title>
<meta charset="UTF-8">
<meta name="keywords" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">

<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<meta name="description" content="指针 数据在内存中的存储  这是一段内存，他被分成了许多段，每段一个byte 当我们声明一个变量int a，计算机会给该变量分配一块空间，分配取决于数据类型与编译器 如：int 与float占4bytes，char占1bytes 当我们给变量a赋值a&#x3D;5，计算机会去寻找该变量，去到他的地址，以二进制写入数据 指针的基础使用 指针是一种变量，它可以存储变量的地址 使用数据类型*">
<meta property="og:type" content="article">
<meta property="og:title" content="【C&#x2F;C++】指针">
<meta property="og:url" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/index.html">
<meta property="og:site_name" content="红魔咖啡馆">
<meta property="og:description" content="指针 数据在内存中的存储  这是一段内存，他被分成了许多段，每段一个byte 当我们声明一个变量int a，计算机会给该变量分配一块空间，分配取决于数据类型与编译器 如：int 与float占4bytes，char占1bytes 当我们给变量a赋值a&#x3D;5，计算机会去寻找该变量，去到他的地址，以二进制写入数据 指针的基础使用 指针是一种变量，它可以存储变量的地址 使用数据类型*">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E5%86%85%E5%AD%98.png">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E4%B8%80%E4%B8%AA%E6%95%B4%E6%95%B0%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8.png">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E6%8C%87%E5%90%91%E6%8C%87%E9%92%88%E7%9A%84%E6%8C%87%E9%92%88.png">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E6%8C%87%E9%92%88%E4%B8%8E%E6%95%B0%E7%BB%84.png">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C2.png">
<meta property="og:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E6%8C%87%E9%92%88%E4%B8%8E%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84.png">
<meta property="article:published_time" content="2025-01-17T06:53:15.466Z">
<meta property="article:modified_time" content="2025-01-22T12:16:27.333Z">
<meta property="article:author" content="IzayoiSakuye">
<meta property="article:tag" content="C&#x2F;C++">
<meta property="article:tag" content="底层逻辑">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/%E5%86%85%E5%AD%98.png">

<link rel="stylesheet" href="/lib/fancybox/fancybox.css">
<link rel="stylesheet" href="/lib/mdui_043tiny/mdui.css">


<link rel="stylesheet" href="/lib/iconfont/iconfont.css?v=1737799443069">

<link rel="stylesheet" href="/css/style.css?v=1737799443069">




    
        <link rel="stylesheet" href="/custom.css?v=1737799443069">
    



<script src="/lib/mdui_043tiny/mdui.js" async></script>
<script src="/lib/fancybox/fancybox.umd.js" async></script>
<script src="/lib/lax.min.js" async></script>


<script async src="/js/app.js?v=1737799443070"></script>

 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4D4ZJ9G024"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag("js", new Date());

  gtag("config", "G-4D4ZJ9G024");
</script>


<link rel="stylesheet"  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.css">
<style>:root{--hl-color:#90a4ae;--hl-bg:#f6f8fa;--hltools-bg:#e6ebf1;--hltools-color:#90a4ae;--hlnumber-bg:#f6f8fa;--hlnumber-color:rgba(144,164,174,0.5);--hlscrollbar-bg:#dce4eb;--hlexpand-bg:linear-gradient(180deg,rgba(246,248,250,0.1),rgba(246,248,250,0.9))}</style><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body class="nexmoe mdui-drawer-body-left"><div id="nexmoe-background"><div class="nexmoe-bg" style="background-image: url(https://s21.ax1x.com/2024/12/05/pATuvH1.jpg)"></div><div class="mdui-appbar mdui-shadow-0"><div class="mdui-toolbar"><a class="mdui-btn mdui-btn-icon mdui-ripple" mdui-drawer="{target: &#039;#drawer&#039;, swipe: true}" title="menu"><i class="mdui-icon nexmoefont icon-menu"></i></a><div class="mdui-toolbar-spacer"></div><a class="mdui-btn mdui-btn-icon" href="/" title="IzayoiSakuye"><img src="https://s21.ax1x.com/2024/12/05/pATKLPf.jpg" alt="IzayoiSakuye"></a></div></div></div><div id="nexmoe-header"><div class="nexmoe-drawer mdui-drawer" id="drawer">
    <div class="nexmoe-avatar mdui-ripple">
        <a href="/" title="IzayoiSakuye">
            <img src="https://s21.ax1x.com/2024/12/05/pATKLPf.jpg" alt="IzayoiSakuye" alt="IzayoiSakuye">
        </a>
    </div>
    <div class="nexmoe-count">
        <div><span>文章</span>14</div>
        <div><span>标签</span>11</div>
        <div><span>分类</span>7</div>
    </div>
    <div class="nexmoe-list mdui-list" mdui-collapse="{accordion: true}">
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/" title="回到首页">
            <i class="mdui-list-item-icon nexmoefont icon-home"></i>
            <div class="mdui-list-item-content">
                回到首页
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/archive.html" title="文章归档">
            <i class="mdui-list-item-icon nexmoefont icon-container"></i>
            <div class="mdui-list-item-content">
                文章归档
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" href="/PY.html" title="我的朋友">
            <i class="mdui-list-item-icon nexmoefont icon-unorderedlist"></i>
            <div class="mdui-list-item-content">
                我的朋友
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" target="_blank" rel="noopener" href="https://nexmoe.com/donate.html" title="给我赞助">
            <i class="mdui-list-item-icon nexmoefont icon-coffee"></i>
            <div class="mdui-list-item-content">
                给我赞助
            </div>
        </a>
        
        <a class="nexmoe-list-item mdui-list-item mdui-ripple false" target="_blank" rel="noopener" href="https://i.nexmoe.com/" title="关于博主">
            <i class="mdui-list-item-icon nexmoefont icon-info-circle"></i>
            <div class="mdui-list-item-content">
                关于博主
            </div>
        </a>
        
    </div>
    
    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-search">
         
            <form id="search_form" action_e="https://cn.bing.com/search?q=site:nexmoe.com" onsubmit="return search();">
                <label><input id="search_value" name="q" type="search" placeholder="搜索"></label>
            </form>
         
    </div>
</div>




    
        
        <div class="nexmoe-widget-wrap">
	<div class="nexmoe-widget nexmoe-social">
		<a
			class="mdui-ripple"
			href="https://space.bilibili.com/124721786"
			target="_blank"
			mdui-tooltip="{content: '哔哩哔哩'}"
			style="
				color: rgb(231, 106, 141);
				background-color: rgba(231, 106, 141, .1);
			"
		>
			<i
				class="nexmoefont icon-bilibili"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://github.com/IzayoiSakuye"
			target="_blank"
			mdui-tooltip="{content: 'GitHub'}"
			style="
				color: rgb(25, 23, 23);
				background-color: rgba(25, 23, 23, .1);
			"
		>
			<i
				class="nexmoefont icon-github"
			></i> </a
		><a
			class="mdui-ripple"
			href="https://twitter.com/exusiai_pl"
			target="_blank"
			mdui-tooltip="{content: 'Twitter'}"
			style="
				color: rgb(59, 151, 239);
				background-color: rgba(59, 151, 239, .1);
			"
		>
			<i
				class="nexmoefont icon-twitter"
			></i> </a
		>
	</div>
</div>

    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章分类</h3>
    <div class="nexmoe-widget">

      <ul class="category-list">

        


        

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/C-C/">C/C++</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/Python/">Python</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/数据结构/">数据结构</a>
          <span class="category-list-count">3</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/数论/">数论</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/杂项/">杂项</a>
          <span class="category-list-count">1</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/算法/">算法</a>
          <span class="category-list-count">2</span>
        </li>

        

        <li class="category-list-item">
          <a class="category-list-link" href="/categories/题解/">题解</a>
          <span class="category-list-count">5</span>
        </li>

        
      </ul>

    </div>
  </div>


    
        
        
  <div class="nexmoe-widget-wrap">
    <div id="randomtagcloud" class="nexmoe-widget tagcloud nexmoe-rainbow">
      <a href="/tags/ACM/" style="font-size: 20px;">ACM</a> <a href="/tags/C-C/" style="font-size: 10px;">C/C++</a> <a href="/tags/CF%E9%A2%98%E8%A7%A3/" style="font-size: 10px;">CF题解</a> <a href="/tags/CS61A/" style="font-size: 10px;">CS61A</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/STL/" style="font-size: 10px;">STL</a> <a href="/tags/%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/" style="font-size: 13.33px;">基础算法</a> <a href="/tags/%E5%BA%95%E5%B1%82%E9%80%BB%E8%BE%91/" style="font-size: 10px;">底层逻辑</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size: 10px;">数学</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 13.33px;">数据结构</a> <a href="/tags/%E7%89%9B%E5%AE%A2%E9%A2%98%E8%A7%A3/" style="font-size: 16.67px;">牛客题解</a>
    </div>
    
      <script>
        var maxTagcloud = parseInt(17);
        var tags_length = parseInt(11);
        var tags_arr = [];
        for(var i = 0; i < tags_length; i++){
          tags_arr.push(i);
        }
        tags_arr.sort(function (l, r) {
          return Math.random() > 0.5 ? -1 : 1;
        });
        tags_arr = tags_arr.slice(0, maxTagcloud < tags_length ? tags_length - maxTagcloud : 0);
        for(var tag_i = 0; tag_i < tags_arr.length; tag_i++){
          document.getElementById("randomtagcloud").children[tags_arr[tag_i]].style.display = 'none';
        }
      </script>
    
  </div>

    
        
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">文章归档</h3>
    <div class="nexmoe-widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/">2025</a><span class="archive-list-count">10</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">4</span></li></ul>
    </div>
  </div>



    
        
        
  <div class="nexmoe-widget-wrap">
    <h3 class="nexmoe-widget-title">最新文章</h3>
    <div class="nexmoe-widget">
      <ul>
        
          <li>
            <a href="/2025/01/25/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/">【数据结构】树状数组</a>
          </li>
        
          <li>
            <a href="/2025/01/24/2025%E7%89%9B%E5%AE%A2%E5%AF%92%E5%81%87%E9%9B%86%E8%AE%AD-2/">【题解】2025牛客寒假集训-2</a>
          </li>
        
          <li>
            <a href="/2025/01/23/%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/">【算法】滑动窗口</a>
          </li>
        
          <li>
            <a href="/2025/01/22/%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97(priority_queue)/">【数据结构】优先队列</a>
          </li>
        
          <li>
            <a href="/2025/01/21/2025%E7%89%9B%E5%AE%A2%E5%AF%92%E5%81%87%E9%9B%86%E8%AE%AD-1/">【题解】2025牛客寒假集训-1</a>
          </li>
        
      </ul>
    </div>
  </div>

    
        
        <div class="nexmoe-widget-wrap">
    <div class="nexmoe-widget nexmoe-link">
		<ul>
        
            <li>
                <a href="" target="_blank" >
                    <img src="" alt=""></img>
                    <p></p>
                </a>
            </li>
        
		</ul>
    </div>
</div>
<style>
.nexmoe-widget-wrap .nexmoe-link ul li a {
    text-align : center;
}
.nexmoe-widget-wrap .nexmoe-link ul li a img {
    max-width : 100%;
}
.nexmoe-widget-wrap .nexmoe-link ul li a p {
    margin: 10px 0;
}
</style>

    
   
    <div class="nexmoe-copyright">
        &copy; 2025 IzayoiSakuye
        Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
        & <a href="https://github.com/theme-nexmoe/hexo-theme-nexmoe" target="_blank">Nexmoe</a>
        <br><a target="_blank" href="https://beian.miit.gov.cn/">鄂ICP备2020018486号</a>
<br><a target="_blank" href=" ">
<img src=" " width="150px"></a>

    </div>
</div><!-- .nexmoe-drawer --></div><div id="nexmoe-content"><div class="nexmoe-primary"><div class="nexmoe-post">
  <article>
    
        <div class="nexmoe-post-cover"> 
            <img src="https://s21.ax1x.com/2024/12/05/pATuvH1.jpg" alt="【C/C++】指针" loading="lazy">
            <h1>【C/C++】指针</h1>
        </div>
    
    
    <div class="nexmoe-post-meta">
    <div class="nexmoe-rainbow">
        <a class="nexmoefont icon-calendar-fill">2025年01月17日</a>
        
            <a class="nexmoefont icon-appstore-fill -link" href="/categories/C-C/">C/C++</a>
        
        
    </div>
    
    
    
    
    
</div>

    <h1 id="指针">指针</h1>
<h2 id="数据在内存中的存储">数据在内存中的存储</h2>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E5%86%85%E5%AD%98.png" class="" title="一段内存">
<p>这是一段内存，他被分成了许多段，每段一个byte</p>
<p>当我们声明一个变量<code>int a</code>，计算机会给该变量分配一块空间，分配取决于<strong>数据类型与编译器</strong></p>
<p>如：int 与float占4bytes，char占1bytes</p>
<p>当我们给变量a赋值<code>a=5</code>，计算机会去寻找该变量，去到他的地址，以二进制写入数据</p>
<h2 id="指针的基础使用">指针的基础使用</h2>
<p>指针是一种变量，它可以存储变量的地址</p>
<p>使用<strong>数据类型*
变量名</strong>创建一个指针：<code>int *p</code>
<code>char *c</code></p>
<p>使用<strong>取地址符&amp;获取一个变量的地址</strong>，并可以将指针指向该变量地址：<code>p=&amp;a</code></p>
<blockquote>
<p>print p，print &amp;a，print
&amp;p分别对应打印p指向(a)的地址，a的地址，p的地址</p>
</blockquote>
<p>将一个*放在指针变量前，可以对指针进行<strong>解引用</strong>，即获取p指向地址的值</p>
<p>则<code>print *p</code>会返回a的值，<code>*p = 8</code>会更改a的值到8</p>
<h3 id="实例代码">实例代码：</h3>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a</span><span style="color: #D73A49">=</span><span style="color: #005CC5">5</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int*</span><span style="color: #24292E"> p;</span><span style="color: #6A737D">  // 若该指针p没有被初始化，p会变成一个野指针，会因为指向任意位置而报错</span></span>
<span class="line"><span style="color: #24292E">    p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">a;</span><span style="color: #6A737D">  // 储存a的地址</span></span>
<span class="line"><span style="color: #6A737D">    // 上两行等同于int* p = &amp;a;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"A:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p);</span><span style="color: #6A737D"> // a的地址</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"V:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span><span style="color: #6A737D"> // a的值</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"A:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">a);</span><span style="color: #6A737D"> // a的地址</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">12</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 更改p指向地址(a)的元素值</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"A:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,a);</span><span style="color: #6A737D"> // 更改后的a值</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">20</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> b;</span><span style="color: #6A737D"> // p不会指向b，只会将b的值赋给a</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"A:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p);</span><span style="color: #6A737D"> // 还是a的地址</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"V:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span><span style="color: #6A737D"> // b的值</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="指针类型">指针类型</h2>
<p>不同的数据类型占据不同的内存：</p>
<p>int：4bytes</p>
<p>char：1byte</p>
<p>float：4bytes</p>
<p><strong>void指针</strong>：</p>
<ol type="1">
<li>可以存放任意类型的指针，且无需强制类型转换</li>
<li>需要进行显式转换后才能赋值给其他类型</li>
<li>可以与其他类型指针直接比较地址值</li>
<li>只有强制类型转换后才能操作（解引用、算术运算等）</li>
<li>可以和普通指针一样传入NULL或nullptr表示空指针</li>
<li>作为函数输入输出时，表示可以接受任意类型和输出任意类型的指针</li>
</ol>
<h3 id="指针类型间的转换">指针类型间的转换</h3>
<p>定义一个变量int a=1025：</p>
<p>他在内存中的布局为（从右到左分别为第0 1 2
3个字节，他们的地址也是连续的）：</p>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E4%B8%80%E4%B8%AA%E6%95%B4%E6%95%B0%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8.png" class="" title="一个整数在内存中的存储">
<p>其中，最左边的一位为符号位，0为整数1为负数</p>
<p>若我们定义一个字符指针c指向a，由于字符只占一个字节，故c只会指向a的第一个字节：</p>
<p>对c进行算术运算(+1)会让他指向下一个字节 以至于得到4</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  // 一个整形指针</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1025</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 在二进制中为四字节:00000000 00000000 00000100 00000001</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int*</span><span style="color: #24292E"> p;</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"size of integer is </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">));</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">, value = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 一个字符指针</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">char</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">c;</span></span>
<span class="line"><span style="color: #24292E">  c </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">char*</span><span style="color: #24292E">)p;</span><span style="color: #6A737D"> // 进行强制类型转换</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"size of integer is </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">char</span><span style="color: #24292E">));</span></span>
<span class="line"><span style="color: #6A737D">  // 由于char指针只有一个字节,则机器只看从右边开始的一个字节 即00000001</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">, value = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,c,</span><span style="color: #D73A49">*</span><span style="color: #24292E">c);</span></span>
<span class="line"><span style="color: #6A737D">  // 增加一个字节,则指针指向从右边开始的第一个字节 即00000100</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">, value = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,c</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">(c</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">));</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // 一个void指针</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p0;</span></span>
<span class="line"><span style="color: #24292E">  p0 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p;</span><span style="color: #6A737D">  // 不需要显式的类型转换</span></span>
<span class="line"><span style="color: #6A737D">  // 当p0没指向任何特定类型时,不能解引用</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">, value = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p0,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p0);</span></span>
<span class="line"><span style="color: #6A737D">  // 也不要进行算术运算</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d</span><span style="color: #032F62"> </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p0,p0</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="指针算术运算">指针算术运算</h2>
<p>对一个指针进行加1操作，相当于将该指针增加一个该指针数据类型所占字节数的字节数</p>
<p>例如对<code>int *p=&amp;a; p++;</code>得到p的值为a的地址加4</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p;</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">a;</span></span>
<span class="line"><span style="color: #6A737D">  // 指针加法 : +1代表增加一个数据类型的字节数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address p is </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p);</span><span style="color: #6A737D"> // p的地址</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Value at address p is </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span><span style="color: #6A737D"> // p指向的值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"size of integer is </span><span style="color: #005CC5">%d</span><span style="color: #032F62"> bytes</span><span style="color: #005CC5">\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">));</span><span style="color: #6A737D"> // int类型所占的字节数</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address p+1 is </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,p</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // p+1指向的地址</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Value at address p+1 is </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">(p</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">));</span><span style="color: #6A737D"> // p+1指向的值(垃圾值)</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C.png" class="" title="输出结果">
<h2 id="指向指针的指针">指向指针的指针</h2>
<p>假设定义了一个数据<code>int x = 5;</code></p>
<p>我们定义一个指针指向x <code>int *p = &amp;x</code></p>
<p>此时我们可以再定义一个指针指向指针p <code>int **q = &amp;p</code></p>
<p>甚至还可以定义一个指针指向指针q <code>int ***r = &amp;q</code></p>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E6%8C%87%E5%90%91%E6%8C%87%E9%92%88%E7%9A%84%E6%8C%87%E9%92%88.png" class="" title="指向指针的指针示意">
<p>(r是205)</p>
<h3 id="示例代码">示例代码</h3>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x </span><span style="color: #D73A49">=</span><span style="color: #005CC5">5</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int*</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">x;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">6</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int**</span><span style="color: #24292E"> q </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">p;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int***</span><span style="color: #24292E"> r </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">q;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span><span style="color: #6A737D"> // p指向x的值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">q);</span><span style="color: #6A737D"> // q指向p的值(x的地址)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">q));</span><span style="color: #6A737D"> // q指向p的值指向x的值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">r));</span><span style="color: #6A737D"> // r指向q的值,q指向p的值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">r)));</span><span style="color: #6A737D"> // r指向q的值,q指向p的值,p指向x的值</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #6A737D">  // 更改x的值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">***</span><span style="color: #24292E">r </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(</span><span style="color: #032F62">"x = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, x);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">  // **q与*p都指向x的值,则相当于x自加2</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">**</span><span style="color: #24292E">q </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">+</span><span style="color: #005CC5">2</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(</span><span style="color: #032F62">"x = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, x);</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="指针用例函数传引用-or-传值">指针用例—函数传引用 or 传值？</h2>
<h3 id="e.g.-局部变量与全局变量">e.g. 局部变量与全局变量：</h3>
<p>有以下代码</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    x</span><span style="color: #D73A49">=</span><span style="color: #24292E">x</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x</span><span style="color: #D73A49">=</span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">	</span><span style="color: #6F42C1">f</span><span style="color: #24292E">(x);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,x);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>该代码中的函数想让变量+1，但输出的结果显然还是10，这是为什么呢？</p>
<p>看以下代码：</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address of x in f is:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">x);</span></span>
<span class="line"><span style="color: #24292E">    x</span><span style="color: #D73A49">=</span><span style="color: #24292E">x</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x</span><span style="color: #D73A49">=</span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">	  </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(x);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address of x in main is:</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">x);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>你会惊奇的发现，f函数中的x与main函数中的x的地址不一样，这也就说明了为什么+1不成立</p>
<p>当程序运行时，计算机会预留一部分内存给程序，他们被分为四个部分：<strong>栈、堆、数据区、代码区</strong></p>
<ul>
<li>栈：非静态局部变量（函数参数等）。栈是向下生长的</li>
<li>堆：用于动态内存分配。堆是向上生长的</li>
<li>数据区：存储全局变量和静态变量</li>
<li>代码区：可执行的代码与常量</li>
</ul>
<p>当一个程序进行时，main函数被调用，关于这个函数的信息（如参数，局部变量，返回地址）会存在栈上，栈便为该函数开辟一块空间，称为<strong>栈帧</strong>(stack
frame)，每个函数都会有一个栈帧</p>
<p>让一个函数调用另一个函数时，两个函数分别称为主调函数与被调函数，在主调函数中调用其他函数用到的参数称为实际参数，被调函数中的函数称为形式参数，实参会被映射到形参。这个操作即传值</p>
<p>当main函数调用f函数时，一块它的栈帧会被创建，其中的参数会被分配到对应空间，执行+1操作后，这个函数的栈帧中的变量执行了+1，但不影响其他地方的变量。</p>
<p>当f函数执行完毕，程序回到main函数，此时f的栈帧会被清除，main函数会被继续执行，故局部变量的生命周期只是<strong>函数执行期间</strong>。</p>
<p>接下来进行的函数是printf函数，这是一个库函数，在栈中创建它的栈帧并指型。这一个结构被称为<strong>(函数)调用栈</strong>，即：是将一个个函数的<strong>栈帧</strong>，按照调用的顺序依次压入栈中，等最上层的函数执行完了，就弹出相应的栈帧的过程</p>
<p><strong>注意：栈是有大小的，如果因为无限递归等原因导致栈帧一直被创建而不清除，程序会因为栈溢出而终止</strong></p>
<h4 id="那传引用能否实现">那传引用能否实现？</h4>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #E36209">p</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">*</span><span style="color: #24292E">p)</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">f</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">a);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"a = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">"</span><span style="color: #24292E">, a);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>该函数传的是地址</p>
<p>当调用main函数，它的栈帧被创建，a=10进入栈。</p>
<p>调用f函数，它的栈帧被创建，则p接收到a的地址，入栈，此时p指向a。</p>
<p>在函数中解引用p，并执行操作，p指向的内存(a)的值就会增加，即a的值增加1</p>
<p>回到main函数，a的值就是11</p>
<p>这就是传引用，它可以节省很多内存空间，也可以处理一些复杂数据类型以节省内存</p>
<h2 id="指针与数组">指针与数组</h2>
<p>让我们声明一个数组 <code>int a[5]</code></p>
<p>即我们创建了五个整型变量，在内存中连续存在(int
占四个字节)，则整个数组占的大小为20bytes，作为一个连续的块</p>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E6%8C%87%E9%92%88%E4%B8%8E%E6%95%B0%E7%BB%84.png" class="" title="指针与一维数组">
<p>我们定义一个指针<code>int* p</code>，将p指向a的第一个元素，则p解引用后打印的是a[0]的值</p>
<p>回忆之前说的指针算术，若我们将p+1，则p会往前移动四个字节，**此时*(p+1)即a[0]后四个字节的值，即a[1]**</p>
<p>与之前不同，一个值它的地址+1后会移动到一个未知内容的地址，而数组a中+1后p指向的值是已知的</p>
<p><strong>若直接将数组名赋值给p，则p默认接收到的是数组a首元素的地址，称为数组的基地址</strong></p>
<p>若想获得数组某个值的地址，可以使用<code>&amp;a[i]</code>或者<code>a+i</code></p>
<p>若想获得数组某个值，可以使用<code>a[i]</code>或者<code>*(a+i)</code></p>
<p><strong>注意：对数组名（常量
）自加是非法的，可以定义一个指针指向数组名让该指针自加</strong></p>
<h4 id="实例代码-1">实例代码：</h4>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a[]</span><span style="color: #D73A49">=</span><span style="color: #24292E">{</span><span style="color: #005CC5">2</span><span style="color: #24292E">,</span><span style="color: #005CC5">4</span><span style="color: #24292E">,</span><span style="color: #005CC5">5</span><span style="color: #24292E">,</span><span style="color: #005CC5">8</span><span style="color: #24292E">,</span><span style="color: #005CC5">1</span><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #005CC5">5</span><span style="color: #24292E">;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">a[i]);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Address = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,a</span><span style="color: #D73A49">+</span><span style="color: #24292E">i);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Value = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,a[i]);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"Value = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, </span><span style="color: #D73A49">*</span><span style="color: #24292E">(a</span><span style="color: #D73A49">+</span><span style="color: #24292E">i));</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="指针用例数组传参">指针用例—数组传参</h2>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">suma</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">[],</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">size</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> sum </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">size;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    sum</span><span style="color: #D73A49">+=</span><span style="color: #24292E">a[i];</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> sum;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">sumb</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">[]){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> sum </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> size </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(a)</span><span style="color: #D73A49">/sizeof</span><span style="color: #24292E">(a[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"In sumb - size of a = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">, size of a[0] = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(a),</span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(a[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]));</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">size;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    sum</span><span style="color: #D73A49">+=</span><span style="color: #24292E">a[i];</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> sum;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a[]</span><span style="color: #D73A49">=</span><span style="color: #24292E">{</span><span style="color: #005CC5">1</span><span style="color: #24292E">,</span><span style="color: #005CC5">2</span><span style="color: #24292E">,</span><span style="color: #005CC5">3</span><span style="color: #24292E">,</span><span style="color: #005CC5">4</span><span style="color: #24292E">,</span><span style="color: #005CC5">5</span><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #6A737D">  // 计算数组大小</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"In main - size of a = </span><span style="color: #005CC5">%d</span><span style="color: #032F62">, size of a[0] = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(a),</span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(a[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]));</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> size </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(a)</span><span style="color: #D73A49">/sizeof</span><span style="color: #24292E">(a[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]);</span></span>
<span class="line"><span style="color: #6A737D">  // 传入数组大小后进行加和</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tot </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">suma</span><span style="color: #24292E">(a,size);</span></span>
<span class="line"><span style="color: #6A737D">  // 在函数中计算数组大小并加和</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tot2 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">sumb</span><span style="color: #24292E">(a);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"tot = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, tot);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"tot2 = </span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">, tot2);</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>以上代码会出现一些问题：</p>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C2.png" class="" title="输出结果">
<p>在调用main与sumb函数时，它们的栈帧会被创建</p>
<p>调用sumb函数时，编译器只会创建一个同名的指针在sumb的栈帧中，即它只指向main函数中数组a的首元素地址（<strong>即<code>int a[]</code>等同于<code>int *a</code></strong>）</p>
<p>因此函数中的sizeof a是一个8字节的指针。</p>
<h2 id="指针与字符数组">指针与字符数组</h2>
<h3 id="字符数组">字符数组</h3>
<p><strong>C中的字符串存储在数组中，必须以’\0’结束</strong></p>
<p>字符数组赋值：</p>
<p>可以指定每一位进行赋值，</p>
<p>或者使用字符串字面值（用双引号括起来的字符串）赋值，该方法会隐式地添加一个’\0’</p>
<p>或者使用大括号初始化每一位，以逗号间隔并在结尾加上’\0’</p>
<p><strong>注意：只能在声明同时用字符串字面值赋值</strong></p>
<h3 id="使用指针">使用指针</h3>
<p>字符数组中数组名代表的是数组首元素的地址，可以用一个指针变量指向它，该变量也可以对字符数组进行操作</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">char</span><span style="color: #24292E"> c1[</span><span style="color: #005CC5">6</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #032F62">"Hello"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">char</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">c2;</span></span>
<span class="line"><span style="color: #24292E">    c2 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> c1;</span></span>
<span class="line"><span style="color: #24292E">    c2[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #032F62">'A'</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // equal to c1[0]='A';</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #24292E">    c2</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 指向下一个元素</span></span>
<span class="line"><span style="color: #24292E">    c1</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 非法</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>有等价关系：</p>
<p><code>c2[i]</code>等同于<code>*(c2+i)</code>
<code>c1[i]</code>等同于<code>*(c1+i)</code></p>
<h3 id="函数传参">函数传参</h3>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(</span><span style="color: #D73A49">char</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #E36209">c</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // while (c[i]!='\0'){ // *(c+i)也可以</span></span>
<span class="line"><span style="color: #6A737D">  //   printf("%c",c[i]);</span></span>
<span class="line"><span style="color: #6A737D">  //   i++;</span></span>
<span class="line"><span style="color: #6A737D">  // }</span></span>
<span class="line"><span style="color: #6A737D">  // 由于c是指针，故可以通过自增与解引用来进行访问</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">c</span><span style="color: #D73A49">!=</span><span style="color: #032F62">'</span><span style="color: #005CC5">\0</span><span style="color: #032F62">'</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%c</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">c);</span></span>
<span class="line"><span style="color: #24292E">    c</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">\n</span><span style="color: #032F62">"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">char</span><span style="color: #24292E"> c[</span><span style="color: #005CC5">20</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">"Hello"</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(c);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="指针与二维数组">指针与二维数组</h2>
<p>如果我们要创建一个二维数组<code>b[2][3]</code></p>
<p>此时，<code>b[0]</code>与<code>b[1]</code>表示三个整数的一维数组，在内存中占用3*4=12个字节，是按行存储的</p>
<p>故<code>int *p=b;</code>指代的是返回一个指向一维数组的指针，此时不能指针运算或解引用，故不能这么用</p>
<p>故应使用<code>int (*p)[3]</code>来创建一个二维指针数组，其中3表示三个指向一维数组的指针</p>
<p>这时<code>print b or &amp;b[0]</code>都指代第一个元素的地址</p>
<p>​
<code>print *b or b[0] or &amp;b[0][0]</code>都指代第一个元素地址的值</p>
<p>​
<code>print b+1 or &amp;b[1]</code>会跳到下一个数组的首地址（+12）</p>
<p>使用<code>print *(b+ 1)</code>or
<code>b[i]</code>or<code>&amp;b[1][0]</code>指代下一个指向一维数组的并返回
值</p>
<p>解引用时，需要一步步解</p>
<blockquote>
<p>例 <code>*(*b+1)</code></p>
</blockquote>
<p>*b
为b[0]，一个一维数组的首元素地址，<code>*b+1</code>会让指针移动四个字节带到下一个整型变量，</p>
<p>相当于<code>&amp;b[0][1]</code></p>
<p>我们解引用后，<code>*(*b+1)</code>就相当于<code>b[0][1]</code></p>
<p><strong>指针运算：<code>b[i][j]</code>=<code>*(b[i]+j)</code>=<code>*(*(b+i)+j)</code></strong></p>
<h2 id="指针与多维数组">指针与多维数组</h2>
<h3 id="原理">原理</h3>
<p>与二维数组类似</p>
<p>假如我们有一个int数组<code>c[3][2][2]</code>，在内存中的存储如下</p>
<img src="/2025/01/17/%E6%8C%87%E9%92%88/%E6%8C%87%E9%92%88%E4%B8%8E%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84.png" class="" title="指针与多维数组">
<p>简化为三个二维数组线性存储，每个二维数组内两个一维数组线性存储</p>
<p>故我们可以声明一个指针<code>int (*p)[2][2] = c;</code>，指向2*2的二维数组</p>
<p>这时<code>print c</code>，<code>print *c</code>，<code>print c[0]</code>，<code>print &amp;c[0][0]</code>均输出第一个一维数组的地址</p>
<p><strong>指针运算：<code>c[i][j][k]=*(c[i][j]+k)=*(*(c[i]+j)+k)=*(*(*(c+i)+j)+k)</code></strong></p>
<p>可以理解为解引用一次就脱一层[]</p>
<p>e.g.</p>
<p><code>print *(c[0][1]+1)</code>指向的是<code>c[0][1][1]</code></p>
<p><code>print *(c[1]+1)</code>指向的是<code>c[1][1]</code>，即<code>c[1][1][0]</code></p>
<h3 id="用于函数传参">用于函数传参</h3>
<p>如一维数组传参，我们可以通过传值或传引用两种方法传参</p>
<p><strong>注意：传值时除了最高维度，其他维度必须要指定偏移量（即形参定义时必须和传入数组长度一样）</strong></p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">two_dim</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">[][</span><span style="color: #005CC5">3</span><span style="color: #24292E">]){</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">three_dim</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">[][</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">2</span><span style="color: #24292E">]){</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>而根据数组名就是指向第一个元素的指针，我们可以直接传引用来实现降维度</p>
<p><strong>注意：只能降到次一级维度，且其余的必须指定偏移量</strong></p>
<p><figure class="shiki"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #24292e">int two_dim(int (*a)[3]){</span></span>
<span class="line"><span style="color: #24292e"></span></span>
<span class="line"><span style="color: #24292e">}</span></span>
<span class="line"><span style="color: #24292e">int three_dim(int (*a)[2][2]){</span></span>
<span class="line"><span style="color: #24292e"></span></span>
<span class="line"><span style="color: #24292e">}</span></span></code></pre></div></div></figure></p>
<h2 id="指针与动态内存">指针与动态内存</h2>
<h3 id="内存的分配">内存的分配</h3>
<p>在一个典型架构中，分配给应用程序的内存分为四个区段：<strong>栈、堆、数据区、代码区</strong></p>
<ul>
<li>栈：非静态局部变量（函数参数等），函数调用信息。栈是向下生长的</li>
<li>堆：用于动态内存分配。堆是向上生长的</li>
<li>数据区：存储全局变量和静态变量</li>
<li>代码区：可执行的代码与常量</li>
</ul>
<h3 id="栈">栈</h3>
<p>当一个程序进行时，main函数被调用，关于这个函数的信息（如参数，局部变量，返回地址）会存在栈上，栈便为该函数开辟一块空间，称为<strong>栈帧</strong>(stack
frame)，每个函数都会有一个栈帧，大小在编译期间决定</p>
<p>所有函数从下往上开辟栈帧后，在执行时总是栈顶的函数在执行，其余函数暂停，等待上方函数返回值等。当上方函数返回后，它占用栈的内存也会被清除，下一个函数运行。<strong>任何时候正在执行的函数都是栈顶的那个函数</strong></p>
<p>预留给栈的空间在运行期间并不会增长，也不能请求更多内存。如果运行时的栈增长超过了程序预留的栈内存大小，那么会造成<strong>栈溢出(stack
overflow)</strong></p>
<p>因此栈有两个限制：</p>
<ol type="1">
<li>在栈上的变量无法操作骑作用域</li>
<li>当声明一个很大的数据类型，可能会造成溢出；且只能在编译时分配他的大小，无法在程序运行时分配它的大小</li>
</ol>
<h3 id="堆动态内存">堆(动态内存)</h3>
<p>这时我们需要用到<strong>堆</strong>来分配或销毁或内存。我们可以任意使用堆上的内存，只要不超过系统内存限制。</p>
<p>堆又称为<strong>动态内存</strong>，使用堆内存称为<strong>动态内存分配</strong>
(注意这里的堆并不是数据结构)</p>
<h4 id="c风格">C风格：</h4>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdlib.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span><span style="color: #6A737D"> // 分配到栈上</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p;</span><span style="color: #6A737D"> // 指向堆内存的指针</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int*</span><span style="color: #24292E">)</span><span style="color: #6F42C1">malloc</span><span style="color: #24292E">(</span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">));</span><span style="color: #6A737D"> // 在堆上开辟一块四字节的内存，让指针p指向其地址</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">*</span><span style="color: #24292E">p</span><span style="color: #D73A49">=</span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 解引用将值存入堆</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">free</span><span style="color: #24292E">(p);</span><span style="color: #6A737D"> // 释放内存</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int*</span><span style="color: #24292E">)</span><span style="color: #6F42C1">malloc</span><span style="color: #24292E">(</span><span style="color: #005CC5">20</span><span style="color: #D73A49">*sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">));</span><span style="color: #6A737D"> // 在堆上再开辟一块20个四字节的内存作为数组，让指针p指向其首元素地址</span></span>
<span class="line"><span style="color: #6A737D">  // 可以用以下两种方式访问</span></span>
<span class="line"><span style="color: #24292E">  p[</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">*</span><span style="color: #24292E">(p</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">) </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>定义一个指针变量p，它被存储在栈中，指向堆中分配的内存地址</p>
<p>通过malloc在堆上分配一块四字节的内存，malloc会返回一个指向这块内存起始地址的指针，<strong>void类型</strong>。故我们需要进行一个强制类型转换，并赋给指针变量p</p>
<p>使用堆上内存的唯一方式是通过<strong>引用</strong>，自己维护一个指针指向这块内存。我们通过对指针变量p解引用并赋值来使用。</p>
<p>若我们再以同样方式分配一块四字节内存，让p指向它，并赋值为20，p此时指向的便是堆中的另一块内存。而之前那块内存仍在堆上，并不会被自动回收，此时称为<strong>内存泄漏</strong>，因此我们<strong>需要在用完一块内存后，及时调用free()释放内存。</strong></p>
<p>如果要分配一个数组内存，我们只需要传入数组大小字节数即可，返回的是内存的初始地址</p>
<p>若malloc无法在堆上成功分配内存，会返回<strong>NULL</strong></p>
<h4 id="c风格-1">C++风格：</h4>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">p;</span><span style="color: #6A737D"> // 指向堆内存的指针</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 在堆上开辟一块int大小的内存(四字节)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">*</span><span style="color: #24292E">p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 解引用并赋值</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">delete</span><span style="color: #24292E"> p;</span><span style="color: #6A737D"> // 释放内存</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E">[</span><span style="color: #005CC5">20</span><span style="color: #24292E">];</span><span style="color: #6A737D"> // 在堆上开辟一个20大小的int数组</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">delete[]</span><span style="color: #24292E"> p;</span><span style="color: #6A737D"> // 释放数组内存</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>c++中使用关键字new与delete开辟与释放内存，不需要类型转换</p>
<h3 id="相关函数">相关函数</h3>
<h4 id="malloc">malloc</h4>
<p>定义：<code>void* malloc(size_t size)</code>(size_t相当于无符号整数)</p>
<p>用法：<code>int *p = (int*)malloc(分配空间大小)</code></p>
<ul>
<li>分配空间大小一般习惯通过sizeof计算，如想要开辟一个存储三个int变量的数组，我们可以用<code>3*sizeof(int)</code>来计算大小，一般不直接写。</li>
<li>由于malloc返回的是void指针，指向其初始地址，而void指针无法解引用，因此我们一般在前面进行强制类型转换来转化成int指针以方便操作</li>
<li>malloc不会将分配的空间初始化，建议使用<code>memset(p,0x00,sizeof(p))</code>初始化</li>
</ul>
<h4 id="calloc">calloc</h4>
<p>定义：<code>void* calloc(size_t num, size_t size)</code></p>
<p>用法：<code>int *p = (int*)calloc(分配元素个数, 每个元素空间大小)</code></p>
<ul>
<li>calloc可以指定分配的元素个数</li>
<li>calloc在分配空间后会自动将其初始化为0</li>
</ul>
<h4 id="realloc">realloc</h4>
<p>定义：<code>void* realloc(void* ptr, size_t size)</code></p>
<p>用法：<code>realloc(已指向某处内存的指针, 修改空间大小)</code></p>
<ul>
<li>realloc用于修改分配的内存大小</li>
<li>若需要的新内存块比原来大，程序会创建一块新内存并将内容复制过去</li>
<li>若之前的内存的相邻部分还有可用内存，程序会直接拓展原空间</li>
<li>若需要的新内存块比原来小，则多余部分的内存会被释放掉</li>
</ul>
<p>注意以下用法：</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int*</span><span style="color: #24292E">)</span><span style="color: #6F42C1">realloc</span><span style="color: #24292E">(a,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // 相当于free(a)</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int*</span><span style="color: #24292E">)</span><span style="color: #6F42C1">realloc</span><span style="color: #24292E">(</span><span style="color: #005CC5">NULL</span><span style="color: #24292E">,n</span><span style="color: #D73A49">*sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">));</span><span style="color: #6A737D"> // 相当于malloc</span></span></code></pre></div></div></figure>
<h3 id="内存泄漏">内存泄漏</h3>
<p>当我们动态申请了内存后，忘记去释放，此时程序占用了一些未使用的内存，称为内存泄露</p>
<p>对于栈：由于栈帧在使用完后会被自动销毁，故不会发生内存泄漏</p>
<p>对于堆：在开辟空间后，堆上的内存必须要被显式地释放掉，否则会一直存在</p>
<p><strong>注意：任何未使用和未引用的堆上内存都是垃圾，程序员要确保不要浪费内存</strong></p>
<h2 id="函数返回指针">函数返回指针</h2>
<p>我们可以在函数类型处加上*来声明函数返回值是一个指针。</p>
<p>注意以下情况：</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdlib.h&gt;</span></span>
<span class="line"><span style="color: #6A737D">// 现在该函数返回的是一个int类型的指针，即c的地址</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"hello world"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int*</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add</span><span style="color: #24292E">(</span><span style="color: #D73A49">int*</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">,</span><span style="color: #D73A49">int*</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> c </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">*</span><span style="color: #24292E">a)</span><span style="color: #D73A49">+</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">b);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">c;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E">,y</span><span style="color: #D73A49">=</span><span style="color: #005CC5">4</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int*</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #6F42C1">add</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">x,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">y);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">print</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"sum=</span><span style="color: #005CC5">%d</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>该程序对print的输出正常，而输出sum时出现了异常，从底层原理分析：</p>
<p>执行main函数，开辟栈帧，执行add函数，在main函数上再开辟栈帧，main函数会等待add返回</p>
<p>此时add中a与b存储了main函数中x与y的地址，c存储了<code>*a</code>与<code>*b</code>的和，返回的是c的地址，故main函数中的p指针存储的是c的地址</p>
<p>add执行完毕，占用空间被清除。但注意，<strong>此时p指向的内存仍未变化，即此时它指向了被释放掉的内存空间，值是随机的</strong></p>
<p>现在执行print函数，开辟栈帧，原空间被覆盖，因此p存储的地址对应的值已经不是c的值了，因此输出异常。</p>
<p>还有一种情况：若不执行print函数，输出的值可能会正确。因为此时程序还没重写或清除那个空间上的数据（虽然已经释放空间）</p>
<p>而对于main与add函数，由于<strong>被调函数的栈空间总是在主调函数之上</strong>，因此被调函数执行时主调函数仍在栈内存中，因此add可以访问main函数中的变量。但若我们想要返回被调函数的一个局部变量给主调函数，当被调函数结束后，内存已被释放，因此会出问题。</p>
<p>因此<strong>可以从栈底向上传局部变量或局部变量的地址，但不能从栈顶向下传局部变量或局部变量的地址</strong></p>
<p>因此我们可以修改：</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdlib.h&gt;</span></span>
<span class="line"><span style="color: #6A737D">// 现在该函数返回的是一个int类型的指针，即c的地址</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"hello world"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int*</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add</span><span style="color: #24292E">(</span><span style="color: #D73A49">int*</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">,</span><span style="color: #D73A49">int*</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E">c </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int*</span><span style="color: #24292E">)</span><span style="color: #6F42C1">malloc</span><span style="color: #24292E">(</span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E">));</span><span style="color: #6A737D"> // 在堆上开辟内存</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">*</span><span style="color: #24292E">c </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">*</span><span style="color: #24292E">a)</span><span style="color: #D73A49">+</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">b);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> c;</span><span style="color: #6A737D"> // 返回的是堆上的指针</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E">,y</span><span style="color: #D73A49">=</span><span style="color: #005CC5">4</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int*</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #6F42C1">add</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">x,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">y);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">print</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"sum=</span><span style="color: #005CC5">%d</span><span style="color: #032F62">"</span><span style="color: #24292E">,</span><span style="color: #D73A49">*</span><span style="color: #24292E">p);</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>我们将c开辟在堆上，此时就不会被清除了，返回c是安全的</p>
<h2 id="函数指针">函数指针</h2>
<p>我们可以用指针指向函数地址，即指向函数的指针。我们可以用这种指针解引用和调用函数。</p>
<h3 id="函数的地址">函数的地址</h3>
<p>在内存中，一个函数就是一块连续的内存。</p>
<p>一般程序执行指令会按照地址依次执行，而函数调用可以让程序跳到某一个地址开始执行其中的指令。</p>
<p>此时对应的函数地址可以称为函数的入口点，即函数第一条指令的地址</p>
<h3 id="函数指针的使用">函数指针的使用</h3>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdlib.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(</span><span style="color: #D73A49">char</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #E36209">name</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"hello"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> a</span><span style="color: #D73A49">+</span><span style="color: #24292E">b;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> c;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> (*p)(</span><span style="color: #D73A49">int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // 函数指针</span></span>
<span class="line"><span style="color: #24292E">  p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">add;</span><span style="color: #6A737D"> // 指针指向add函数的地址(不用&amp;也可)</span></span>
<span class="line"><span style="color: #24292E">  c </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">*</span><span style="color: #24292E">p)(</span><span style="color: #005CC5">2</span><span style="color: #24292E">,</span><span style="color: #005CC5">3</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // 解引用，并传入参数执行函数(不用解引用也行)</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">"</span><span style="color: #24292E">,c);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> (*ptr)(</span><span style="color: #D73A49">char*</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  ptr </span><span style="color: #D73A49">=</span><span style="color: #24292E"> print;</span><span style="color: #6A737D"> // 不用&amp;的情况</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">ptr</span><span style="color: #24292E">(</span><span style="color: #032F62">"mixbp"</span><span style="color: #24292E">);</span><span style="color: #6A737D"> // 不用解引用的情况</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>由于单纯的函数名代表函数入口点，故不用&amp;与解引用也可以</p>
<p><strong>注意：为了指向一个函数，函数指针的类型必须是正确的</strong></p>
<h3 id="回调函数">回调函数</h3>
<p>将函数指针作为函数参数传入，并在函数内部通过该函数指针调用函数，被调用的函数即为回调函数</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdlib.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">print</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"hello"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">b</span><span style="color: #24292E">(</span><span style="color: #D73A49">void</span><span style="color: #24292E"> (*</span><span style="color: #E36209">ptr</span><span style="color: #24292E">)()){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">ptr</span><span style="color: #24292E">();</span><span style="color: #6A737D"> // 用ptr回调传进来的函数</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">void</span><span style="color: #24292E"> (*p)() </span><span style="color: #D73A49">=</span><span style="color: #24292E"> print;</span><span style="color: #6A737D"> // 定义一个指针指向print</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">b</span><span style="color: #24292E">(p);</span><span style="color: #6A737D"> // 传入该函数指针</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">b</span><span style="color: #24292E">(print);</span><span style="color: #6A737D"> // 这样也可以传</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>代码中，函数b可以通过函数指针来回调函数print</p>
<p>可以定义一个指向print函数的指针传入，也可以直接传入print，此时指代的是print函数的首地址</p>
<h3 id="应用排序">应用：排序</h3>
<p>设计一个排序函数，并可以按照不同逻辑进行排序</p>
<p>我们可以在普通排序函数中添加一个函数指针参数(比较函数)，通过设计<del>蚂蚁</del>比较逻辑并传入排序函数，可以灵活实现不同情景的比较，而不用每次都根据不同逻辑重新写一遍排序函数</p>
<p>如实现正序、逆序、按绝对值排序</p>
<figure class="shiki c++"><div class="codeblock"><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;math.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">compare</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">,</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (a</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E">b) </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">else</span><span style="color: #24292E"> </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">r_compare</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (a</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E">b) </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">else</span><span style="color: #24292E"> </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">abs_compare</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #6F42C1">abs</span><span style="color: #24292E">(a)</span><span style="color: #D73A49">&gt;</span><span style="color: #6F42C1">abs</span><span style="color: #24292E">(b)) </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">else</span><span style="color: #24292E"> </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">sort</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> (*</span><span style="color: #E36209">cmp</span><span style="color: #24292E">)(</span><span style="color: #D73A49">int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int</span><span style="color: #24292E">)){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tep;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #6F42C1">cmp</span><span style="color: #24292E">(a[j],a[j</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">])</span><span style="color: #D73A49">&gt;</span><span style="color: #005CC5">0</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        tep </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a[j];</span></span>
<span class="line"><span style="color: #24292E">        a[j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a[j</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">];</span></span>
<span class="line"><span style="color: #24292E">        a[j</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #24292E">tep;</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a[]</span><span style="color: #D73A49">=</span><span style="color: #24292E">{</span><span style="color: #005CC5">3</span><span style="color: #24292E">,</span><span style="color: #005CC5">2</span><span style="color: #24292E">,</span><span style="color: #005CC5">1</span><span style="color: #24292E">,</span><span style="color: #005CC5">5</span><span style="color: #24292E">,</span><span style="color: #005CC5">6</span><span style="color: #24292E">,</span><span style="color: #005CC5">4</span><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> b[]</span><span style="color: #D73A49">=</span><span style="color: #24292E">{</span><span style="color: #D73A49">-</span><span style="color: #005CC5">2</span><span style="color: #24292E">,</span><span style="color: #D73A49">-</span><span style="color: #005CC5">3</span><span style="color: #24292E">,</span><span style="color: #005CC5">5</span><span style="color: #24292E">,</span><span style="color: #005CC5">4</span><span style="color: #24292E">,</span><span style="color: #005CC5">1</span><span style="color: #24292E">,</span><span style="color: #D73A49">-</span><span style="color: #005CC5">6</span><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">sort</span><span style="color: #24292E">(a,</span><span style="color: #005CC5">6</span><span style="color: #24292E">,compare);</span><span style="color: #6A737D"> // 正序排序</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #005CC5">6</span><span style="color: #24292E">;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> "</span><span style="color: #24292E">,a[i]);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">\n</span><span style="color: #032F62">"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">sort</span><span style="color: #24292E">(a,</span><span style="color: #005CC5">6</span><span style="color: #24292E">,r_compare);</span><span style="color: #6A737D"> // 逆序排序</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #005CC5">6</span><span style="color: #24292E">;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> "</span><span style="color: #24292E">,a[i]);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">\n</span><span style="color: #032F62">"</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">sort</span><span style="color: #24292E">(b,</span><span style="color: #005CC5">6</span><span style="color: #24292E">,abs_compare);</span><span style="color: #6A737D"> // 绝对值排序</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #005CC5">6</span><span style="color: #24292E">;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> "</span><span style="color: #24292E">,b[i]);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">"</span><span style="color: #005CC5">\n</span><span style="color: #032F62">"</span><span style="color: #24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>同样的逻辑，在c的stdlib.h库中有一个qsort函数，只要给予它排序逻辑并传入就可以对任意数组排序</p>

    <p><img src=" " loading="lazy"></p>

  </article>

  
      
    <div class="nexmoe-post-copyright">
        <strong>本文作者：</strong>IzayoiSakuye<br>
        <strong>本文链接：</strong><a href="https://izayoisakuye.github.io/2025/01/17/%E6%8C%87%E9%92%88/" title="https:&#x2F;&#x2F;izayoisakuye.github.io&#x2F;2025&#x2F;01&#x2F;17&#x2F;%E6%8C%87%E9%92%88&#x2F;" target="_blank" rel="noopener">https:&#x2F;&#x2F;izayoisakuye.github.io&#x2F;2025&#x2F;01&#x2F;17&#x2F;%E6%8C%87%E9%92%88&#x2F;</a><br>
        
            <strong>版权声明：</strong>本文采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/cn/deed.zh" target="_blank">CC BY-NC-SA 3.0 CN</a> 协议进行许可

        
    </div>


  
  
  <div class="nexmoe-post-meta nexmoe-rainbow">
   
    
        <a class="nexmoefont icon-tag-fill -none-link" href="/tags/C-C/" rel="tag">C/C++</a> <a class="nexmoefont icon-tag-fill -none-link" href="/tags/%E5%BA%95%E5%B1%82%E9%80%BB%E8%BE%91/" rel="tag">底层逻辑</a>
    
</div>
  
  
    <script async src="/js/copy-codeblock.js?v=1737799442952"></script>
  

  
      <div class="nexmoe-post-footer">
          
      </div>
  
</div></div><div class="nexmoe-post-right">    <div class="nexmoe-fixed">
        <div class="nexmoe-tool">

            

            
            
            <button class="mdui-fab catalog" style="overflow:unset;">
                <i class="nexmoefont icon-i-catalog"></i>
                <div class="nexmoe-toc">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8C%87%E9%92%88"><span class="toc-number">1.</span> <span class="toc-text">指针</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%9C%A8%E5%86%85%E5%AD%98%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-number">1.1.</span> <span class="toc-text">数据在内存中的存储</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">指针的基础使用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">1.2.1.</span> <span class="toc-text">实例代码：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.3.</span> <span class="toc-text">指针类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E7%B1%BB%E5%9E%8B%E9%97%B4%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.3.1.</span> <span class="toc-text">指针类型间的转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="toc-number">1.4.</span> <span class="toc-text">指针算术运算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E5%90%91%E6%8C%87%E9%92%88%E7%9A%84%E6%8C%87%E9%92%88"><span class="toc-number">1.5.</span> <span class="toc-text">指向指针的指针</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81"><span class="toc-number">1.5.1.</span> <span class="toc-text">示例代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E7%94%A8%E4%BE%8B%E5%87%BD%E6%95%B0%E4%BC%A0%E5%BC%95%E7%94%A8-or-%E4%BC%A0%E5%80%BC"><span class="toc-number">1.6.</span> <span class="toc-text">指针用例—函数传引用 or 传值？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#e.g.-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E4%B8%8E%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">1.6.1.</span> <span class="toc-text">e.g. 局部变量与全局变量：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%82%A3%E4%BC%A0%E5%BC%95%E7%94%A8%E8%83%BD%E5%90%A6%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.6.1.1.</span> <span class="toc-text">那传引用能否实现？</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%B8%8E%E6%95%B0%E7%BB%84"><span class="toc-number">1.7.</span> <span class="toc-text">指针与数组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E4%BB%A3%E7%A0%81-1"><span class="toc-number">1.7.0.1.</span> <span class="toc-text">实例代码：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E7%94%A8%E4%BE%8B%E6%95%B0%E7%BB%84%E4%BC%A0%E5%8F%82"><span class="toc-number">1.8.</span> <span class="toc-text">指针用例—数组传参</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%B8%8E%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84"><span class="toc-number">1.9.</span> <span class="toc-text">指针与字符数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84"><span class="toc-number">1.9.1.</span> <span class="toc-text">字符数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%8C%87%E9%92%88"><span class="toc-number">1.9.2.</span> <span class="toc-text">使用指针</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82"><span class="toc-number">1.9.3.</span> <span class="toc-text">函数传参</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%B8%8E%E4%BA%8C%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">1.10.</span> <span class="toc-text">指针与二维数组</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%B8%8E%E5%A4%9A%E7%BB%B4%E6%95%B0%E7%BB%84"><span class="toc-number">1.11.</span> <span class="toc-text">指针与多维数组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.11.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E4%BA%8E%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82"><span class="toc-number">1.11.2.</span> <span class="toc-text">用于函数传参</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%87%E9%92%88%E4%B8%8E%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98"><span class="toc-number">1.12.</span> <span class="toc-text">指针与动态内存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%9A%84%E5%88%86%E9%85%8D"><span class="toc-number">1.12.1.</span> <span class="toc-text">内存的分配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%88"><span class="toc-number">1.12.2.</span> <span class="toc-text">栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A0%86%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98"><span class="toc-number">1.12.3.</span> <span class="toc-text">堆(动态内存)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#c%E9%A3%8E%E6%A0%BC"><span class="toc-number">1.12.3.1.</span> <span class="toc-text">C风格：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#c%E9%A3%8E%E6%A0%BC-1"><span class="toc-number">1.12.3.2.</span> <span class="toc-text">C++风格：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-number">1.12.4.</span> <span class="toc-text">相关函数</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#malloc"><span class="toc-number">1.12.4.1.</span> <span class="toc-text">malloc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calloc"><span class="toc-number">1.12.4.2.</span> <span class="toc-text">calloc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#realloc"><span class="toc-number">1.12.4.3.</span> <span class="toc-text">realloc</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F"><span class="toc-number">1.12.5.</span> <span class="toc-text">内存泄漏</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E6%8C%87%E9%92%88"><span class="toc-number">1.13.</span> <span class="toc-text">函数返回指针</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88"><span class="toc-number">1.14.</span> <span class="toc-text">函数指针</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E5%9C%B0%E5%9D%80"><span class="toc-number">1.14.1.</span> <span class="toc-text">函数的地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.14.2.</span> <span class="toc-text">函数指针的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"><span class="toc-number">1.14.3.</span> <span class="toc-text">回调函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E6%8E%92%E5%BA%8F"><span class="toc-number">1.14.4.</span> <span class="toc-text">应用：排序</span></a></li></ol></li></ol></li></ol>
                </div>
            </button>
            

            

            <a href="#nexmoe-content" class="backtop toc-link" aria-label="Back To Top" title="top"><button class="mdui-fab mdui-ripple"><i class="nexmoefont icon-caret-top"></i></button></a>
        </div>
    </div>
</div></div><div id="nexmoe-footer"><!--!--></div><div id="nexmoe-search-space"><div class="search-container"><div class="search-header"><div class="search-input-container"><input class="search-input" type="text" placeholder="搜索" onInput="sinput();"></div><a class="search-close" onclick="sclose();">×</a></div><div class="search-body"></div></div></div><div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2058306854838448" crossorigin="anonymous"></script>
</div><!-- hexo injector body_end start -->
<script src="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.js"></script>

  <script>
  const CODE_CONFIG = {
    beautify: true,
    highlightCopy: true,
    highlightLang: true,
    highlightHeightLimit: undefined,
    isHighlightShrink: false,
    copy: {
      success: 'Copy Success',
      error: 'Copy Error',
      noSupport: 'Browser Not Support',
    }
  };
  console.log(
    `%c hexo-shiki-plugin %c v1.0.27 %c https://github.com/nova1751/hexo-shiki-plugin`,
    "color: #fff; background: #5f5f5f",
    "color: #fff; background: #80c8f8",
    ""
  );
  </script>
  <!-- hexo injector body_end end --></body></html>