<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"izayoisakuye.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="红魔咖啡馆">
<meta property="og:url" content="https://izayoisakuye.github.io/list/page/8/index.html">
<meta property="og:site_name" content="红魔咖啡馆">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="IzayoiSakuye">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://izayoisakuye.github.io/list/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>红魔咖啡馆</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.css">
<style>:root{--hl-color:#90a4ae;--hl-bg:#f6f8fa;--hltools-bg:#e6ebf1;--hltools-color:#90a4ae;--hlnumber-bg:#f6f8fa;--hlnumber-color:rgba(144,164,174,0.5);--hlscrollbar-bg:#dce4eb;--hlexpand-bg:linear-gradient(180deg,rgba(246,248,250,0.1),rgba(246,248,250,0.9))}</style><!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">红魔咖啡馆</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">头发越掉越多，头发越掉越少</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" class="post-title-link" itemprop="url">【数学】组合数学</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-05-21 22:47:53 / 修改时间：22:48:26" itemprop="dateCreated datePublished" datetime="2025-05-21T22:47:53+08:00">2025-05-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">数学</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="组合数学">组合数学</h1>
<h2 id="抽屉原理">抽屉原理</h2>
<ul>
<li><p>将n+1个物体划分为n组，至少有一组有两个及以上的物体</p></li>
<li><p>将n个物体划分为k组，至少存在一个分组，含有大于等于<span
class="math inline">\(\lceil \frac{n}{k}\rceil\)</span>个物体</p></li>
</ul>
<h2 id="插板法">插板法</h2>
<blockquote>
<p>n个完全相同的元素分为k组，每组至少一个元素，一共有多少分发</p>
</blockquote>
<p>我们通过插板子来实现分组，用k-1块板子插入n-1个空中，即有$ $中分发</p>
<p>若每组允许为空，我们将条件转化为在n+k个元素形成的n+k-1个空里面插板子，即有$
$</p>
<h2 id="容斥原理">容斥原理</h2>
<p>前置知识：德摩根律</p>
<p>简单形式：设A,B是分别具有性质<span
class="math inline">\(P_1\)</span>和<span
class="math inline">\(P_2\)</span>的元素集合，则<span
class="math inline">\(|A\cup B|=|A|+|B|-|A\cap B|\)</span></p>
<p>推广：设集合S的子集<span
class="math inline">\(A_1\)</span>具有性质<span
class="math inline">\(P_1\)</span>，…，<span
class="math inline">\(A_n\)</span>具有性质<span
class="math inline">\(P_n\)</span>，则</p>
<ol type="1">
<li><p>集合S至少具有性质<span
class="math inline">\(P_1,P_2,\cdots,P_n\)</span>之一的元素个数为$
_{i=1}^{n}
|A_i|=|A_i|-|A_iA_j|+|A_iA_jA_k|-+(-1)<sup>n|_{i=1}</sup>{n}A_i|
$</p></li>
<li><p>集合S不具有性质<span
class="math inline">\(P_1,P_2,\cdots,P_n\)</span>之一的元素个数为$
_{i=1}^{n}
||=|S|-(|A_i|-|A_iA_j|+|A_iA_jA_k|-+(-1)<sup>n|_{i=1}</sup>{n}A_i|
)$</p></li>
</ol>
<h2 id="求组合数">求组合数</h2>
<blockquote>
<p>求解<span
class="math inline">\(\binom{n}{m}\mod{p}\)</span>(其中p为质数)</p>
</blockquote>
<h3 id="阶乘乘法逆元">阶乘+乘法逆元</h3>
<ol type="1">
<li>求出阶乘n!,m!,(n-m)!，每次乘法后取模</li>
<li>求出阶乘对应的乘法逆元</li>
</ol>
<p>这里我们可以预处理掉对应阶乘与对应逆元，在计算组合数时直接计算</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #24292E">ll fac[N], infac[N];</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 快速幂计算</span></span>
<span class="line"><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #6F42C1">qpow</span><span style="color: #24292E">(</span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">, </span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">m</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">    ll r </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (n) {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (n </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">) r </span><span style="color: #D73A49">=</span><span style="color: #24292E"> r </span><span style="color: #D73A49">*</span><span style="color: #24292E"> a </span><span style="color: #D73A49">%</span><span style="color: #24292E"> m;</span></span>
<span class="line"><span style="color: #24292E">        a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a </span><span style="color: #D73A49">*</span><span style="color: #24292E"> a </span><span style="color: #D73A49">%</span><span style="color: #24292E"> m;</span></span>
<span class="line"><span style="color: #24292E">        n </span><span style="color: #D73A49">&gt;&gt;=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> r;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 初始化阶乘和逆元</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">init_fac</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">    fac[</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> infac[</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (ll i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> N; </span><span style="color: #D73A49">++</span><span style="color: #24292E">i) {</span></span>
<span class="line"><span style="color: #24292E">        fac[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> fac[i </span><span style="color: #D73A49">-</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">*</span><span style="color: #24292E"> i </span><span style="color: #D73A49">%</span><span style="color: #24292E"> mod;</span></span>
<span class="line"><span style="color: #24292E">        infac[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">qpow</span><span style="color: #24292E">(fac[i], mod </span><span style="color: #D73A49">-</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E">, mod);</span><span style="color: #6A737D"> // 使用快速幂计算逆元</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 组合数计算</span></span>
<span class="line"><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #6F42C1">C</span><span style="color: #24292E">(</span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">, </span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">m</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (m </span><span style="color: #D73A49">&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">||</span><span style="color: #24292E"> m </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">) </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 边界条件</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> fac[n] </span><span style="color: #D73A49">*</span><span style="color: #24292E"> infac[m] </span><span style="color: #D73A49">%</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">*</span><span style="color: #24292E"> infac[n </span><span style="color: #D73A49">-</span><span style="color: #24292E"> m] </span><span style="color: #D73A49">%</span><span style="color: #24292E"> mod;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p><strong>别忘了调用<code>init_fac()</code>进行初始化！！！</strong></p>
<h3 id="卢卡斯定理">卢卡斯定理</h3>
<p><span class="math display">\[
\begin{array}{c}C_{a}^{b}\equiv
C_{\lfloor\frac{a}{p}\rfloor}^{\lfloor\frac{b}{p}\rfloor} \cdot C_{a
\bmod p }^{b\bmod p}\pmod{p}\end{array}
\]</span></p>
<p>其中前半部分可以用卢卡斯定理递归求解，后半部分用上方方法求解</p>
<p>卢卡斯定理可以优化求解速度，而且适用于求解a，b较大而p较小的情况</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #6F42C1">lucas</span><span style="color: #24292E">(</span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">, </span><span style="color: #6F42C1">ll</span><span style="color: #24292E"> </span><span style="color: #E36209">m</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">m)</span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #6F42C1">lucas</span><span style="color: #24292E">(n</span><span style="color: #D73A49">/</span><span style="color: #24292E">mod, m</span><span style="color: #D73A49">/</span><span style="color: #24292E">mod)</span><span style="color: #D73A49">*</span><span style="color: #6F42C1">C</span><span style="color: #24292E">(n</span><span style="color: #D73A49">%</span><span style="color: #24292E">mod,m</span><span style="color: #D73A49">%</span><span style="color: #24292E">mod)</span><span style="color: #D73A49">%</span><span style="color: #24292E">mod;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88(LCA)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E8%BF%91%E5%85%AC%E5%85%B1%E7%A5%96%E5%85%88(LCA)/" class="post-title-link" itemprop="url">【图论】最近公共祖先(LCA)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:51:52" itemprop="dateCreated datePublished" datetime="2025-05-18T21:51:52+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:58:28" itemprop="dateModified" datetime="2025-07-31T17:58:28+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="最近公共祖先lca">最近公共祖先(LCA)</h1>
<h2 id="概念">概念</h2>
<ul>
<li><p>祖先：从某个节点上溯到根节点的所有节点都是该节点的祖先，如图中节点5的祖先为节点3
1 0</p></li>
<li><p>公共祖先：两个节点共有的祖先，如图中节点2和节点5的公共祖先为1
0</p></li>
<li><p>最近公共祖先：所有公共祖先中深度最深的祖先，若待求的一个节点本身是另一个节点的祖先，则该节点即为所求最近公共祖先</p>
<figure>
<img src="最近公共祖先(LCA)/image-20250506113430524.png" alt="LCA" />
<figcaption aria-hidden="true">LCA</figcaption>
</figure></li>
</ul>
<h2 id="朴素算法">朴素算法</h2>
<p>思路：将两节点跳至同一深度，让两节点同时上跳至同一节点</p>
<p>方法：DFS</p>
<h2 id="倍增lca">倍增LCA</h2>
<p>使用倍增思想，以及st表来寻找祖先。</p>
<p>由倍增思想，我们可以得到某节点<span
class="math inline">\(2^i\)</span>级祖先是<span
class="math inline">\(2^{i-1}\)</span>级祖先的<span
class="math inline">\(2^{i-1}\)</span>级祖先</p>
<p>故我们只需要每次寻找两节点尽可能相遇的位置，则它们的父节点一定相遇，此时父节点便为LCA</p>
<p>具体来说，同时往上走的时候要<strong>保证各自到达的节点不同</strong>，走到最后在往上走一步即可</p>
<p>时间复杂度<span class="math inline">\(O(\log n)\)</span></p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ll;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E"> PII;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5</span><span style="color: #D73A49">e</span><span style="color: #005CC5">5</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e</span><span style="color: #005CC5">9</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, s;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> st[N][</span><span style="color: #005CC5">20</span><span style="color: #24292E">];</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> head[N],depth[N];</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> power, cnt;</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node2</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, f ,e;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> to, nxt;</span></span>
<span class="line"><span style="color: #24292E">}edge[</span><span style="color: #005CC5">2</span><span style="color: #D73A49">*</span><span style="color: #24292E">N];</span><span style="color: #6A737D"> // 无向图 开两倍</span></span>
<span class="line"><span style="color: #6A737D">// 链式前向星建图</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">from</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">to</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  edge[</span><span style="color: #D73A49">++</span><span style="color: #24292E">cnt].to </span><span style="color: #D73A49">=</span><span style="color: #24292E"> to;</span></span>
<span class="line"><span style="color: #24292E">  edge[cnt].nxt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[from];</span></span>
<span class="line"><span style="color: #24292E">  head[from]</span><span style="color: #D73A49">=</span><span style="color: #24292E">cnt;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 非递归版本 防止爆栈</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dfs_stack</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">i</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">fat</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  stack</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">node2</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E"> stk;</span></span>
<span class="line"><span style="color: #24292E">  stk.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">({i,</span><span style="color: #005CC5">0</span><span style="color: #24292E">,</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">});</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">stk.</span><span style="color: #6F42C1">empty</span><span style="color: #24292E">()){</span></span>
<span class="line"><span style="color: #24292E">    node2 cur </span><span style="color: #D73A49">=</span><span style="color: #24292E"> stk.</span><span style="color: #6F42C1">top</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">    stk.</span><span style="color: #6F42C1">pop</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (cur.e</span><span style="color: #D73A49">==-</span><span style="color: #005CC5">1</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      depth[cur.u] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> depth[cur.f]</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">      st[cur.u][</span><span style="color: #005CC5">0</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #24292E">cur.f;</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> s</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">s)</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">depth[cur.u];s</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        st[cur.u][s] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> st[st[cur.u][s</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">]][s</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">];</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">      cur.e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[cur.u];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E"> cur.e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> edge[cur.e].nxt;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (cur.e</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">0</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      stk.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(cur);</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (edge[cur.e].to</span><span style="color: #D73A49">!=</span><span style="color: #24292E">cur.f){</span></span>
<span class="line"><span style="color: #24292E">        stk.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">({edge[cur.e].to, cur.u, </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">});</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 递归查找每个节点的深度</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dfs</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">i</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">fat</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  depth[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> depth[fat]</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  st[i][</span><span style="color: #005CC5">0</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #24292E">fat;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">p)</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">depth[i];p</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    st[i][p] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> st[st[i][p</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">]][p</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">];</span><span style="color: #6A737D"> // 跳</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[i]; e; e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> edge[e].nxt){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (edge[e].to</span><span style="color: #D73A49">!=</span><span style="color: #24292E">fat){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">dfs</span><span style="color: #24292E">(edge[e].to, i);      </span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 开始向上走寻找</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">lca</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #6A737D">  // 将深度大的设为a，深度小的设为b</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (depth[a]</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">depth[b]){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> temp </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">    a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">    b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> temp;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 让更深的a上跳</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> power; p</span><span style="color: #D73A49">&gt;=</span><span style="color: #005CC5">0</span><span style="color: #24292E">; p</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (depth[st[a][p]]</span><span style="color: #D73A49">&gt;=</span><span style="color: #24292E">depth[b]){</span><span style="color: #6A737D"> // 保证上跳不超过b</span></span>
<span class="line"><span style="color: #24292E">      a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> st[a][p];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 特判来到同一层时两者相同，即b是a的祖先</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (a</span><span style="color: #D73A49">==</span><span style="color: #24292E">b){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> a;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 到达同一层，开始上跳，保证每次上跳两者不到同一节点</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> power; p</span><span style="color: #D73A49">&gt;=</span><span style="color: #005CC5">0</span><span style="color: #24292E">; p</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (st[a][p]</span><span style="color: #D73A49">!=</span><span style="color: #24292E">st[b][p]){</span></span>
<span class="line"><span style="color: #24292E">      a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> st[a][p];</span></span>
<span class="line"><span style="color: #24292E">      b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> st[b][p];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> st[a][</span><span style="color: #005CC5">0</span><span style="color: #24292E">];</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">  cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> s;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(u,v);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(v,u);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  power </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">log2</span><span style="color: #24292E">(n);</span></span>
<span class="line"><span style="color: #24292E">  cnt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //dfs_stack(s,0);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">dfs</span><span style="color: #24292E">(s,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E">(m</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> a, b;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> a </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">lca</span><span style="color: #24292E">(a,b)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">ios</span><span style="color: #24292E">::</span><span style="color: #6F42C1">sync_with_stdio</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cin.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cout.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tomorin</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //cin &gt;&gt; tomorin;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (tomorin</span><span style="color: #D73A49">--</span><span style="color: #24292E">) </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="tarjan算法">Tarjan算法</h2>
<p>Tarjan将所有询问存储，并在dfs中离线处理</p>
<p>步骤：</p>
<ul>
<li>建好每个节点的问题列表，并遍历树，即建立两节点之间的关系，双向</li>
<li>来到当前节点cur，标记vis数组为true，表示当前节点已经访问</li>
<li>遍历cur的所有子树，每棵子树遍历完后和cur节点合并，cur为头节点</li>
</ul>
<p>​ 此时cur为该节点子树节点集合的头节点</p>
<ul>
<li>遍历完所有子树后，处理cur节点的每一条查询(cur, x)
<ul>
<li>若x已经访问过，则cur与x的最低公共祖先 = x所在集合头节点</li>
<li>若没有访问过，则先不处理，等到x节点时再去处理(x, cur)得到答案</li>
</ul></li>
</ul>
<p>时间复杂度：<span class="math inline">\(O(n+m)\)</span></p>
<p>只能离线查询</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ll;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E"> PII;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5</span><span style="color: #D73A49">e</span><span style="color: #005CC5">5</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e</span><span style="color: #005CC5">9</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, s;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> tcnt, qcnt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> headt[N], headq[N];</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> vis[N], ans[N], disj[N];</span></span>
<span class="line"><span style="color: #6A737D">// 储存树</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> to, nxt;</span></span>
<span class="line"><span style="color: #24292E">}edge[</span><span style="color: #005CC5">2</span><span style="color: #D73A49">*</span><span style="color: #24292E">N];</span></span>
<span class="line"><span style="color: #6A737D">// 储存询问</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node2</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> to, idx, nxt;</span></span>
<span class="line"><span style="color: #24292E">}query[</span><span style="color: #005CC5">2</span><span style="color: #D73A49">*</span><span style="color: #24292E">N];</span></span>
<span class="line"><span style="color: #6A737D">// 对树加边</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_tedge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">from</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">to</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  edge[</span><span style="color: #D73A49">++</span><span style="color: #24292E">tcnt].to </span><span style="color: #D73A49">=</span><span style="color: #24292E"> to;</span></span>
<span class="line"><span style="color: #24292E">  edge[tcnt].nxt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> headt[from];</span></span>
<span class="line"><span style="color: #24292E">  headt[from] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> tcnt;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 对询问加边</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_qedge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">from</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">to</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">i</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  query[</span><span style="color: #D73A49">++</span><span style="color: #24292E">qcnt].to </span><span style="color: #D73A49">=</span><span style="color: #24292E"> to;</span></span>
<span class="line"><span style="color: #24292E">  query[qcnt].nxt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> headq[from];</span></span>
<span class="line"><span style="color: #24292E">  query[qcnt].idx </span><span style="color: #D73A49">=</span><span style="color: #24292E"> i;</span></span>
<span class="line"><span style="color: #24292E">  headq[from] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> qcnt;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 并查集查找操作</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">find</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (disj[x]</span><span style="color: #D73A49">!=</span><span style="color: #24292E">x) disj[x] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">find</span><span style="color: #24292E">(disj[x]);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> disj[x];</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">tarjan</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">u</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">f</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  vis[u] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 当前节点已访问</span></span>
<span class="line"><span style="color: #6A737D">  // 遍历该节点的孩子</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> headt[u], v; e; e</span><span style="color: #D73A49">=</span><span style="color: #24292E">edge[e].nxt){</span></span>
<span class="line"><span style="color: #24292E">    v </span><span style="color: #D73A49">=</span><span style="color: #24292E"> edge[e].to;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (v</span><span style="color: #D73A49">!=</span><span style="color: #24292E">f){</span><span style="color: #6A737D"> // 孩子和父节点不能相同</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">tarjan</span><span style="color: #24292E">(v,u);</span><span style="color: #6A737D"> // 递归，让现在的孩子作为子过程的父亲节点</span></span>
<span class="line"><span style="color: #24292E">      disj[v] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> u;</span><span style="color: #6A737D"> // 子树头节点改为当前节点，即合并</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 开始处理问题</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> headq[u], v; e; e</span><span style="color: #D73A49">=</span><span style="color: #24292E">query[e].nxt){</span></span>
<span class="line"><span style="color: #24292E">    v </span><span style="color: #D73A49">=</span><span style="color: #24292E"> query[e].to;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (vis[v]){</span><span style="color: #6A737D"> // 问题已遍历，可以处理</span></span>
<span class="line"><span style="color: #24292E">      ans[query[e].idx]</span><span style="color: #D73A49">=</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(v);</span><span style="color: #6A737D"> // 问题编号位置找到v所在集合的头节点，填入ans即为答案</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">  cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> s;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    disj[i]</span><span style="color: #D73A49">=</span><span style="color: #24292E">i;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  qcnt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> tcnt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">add_tedge</span><span style="color: #24292E">(u, v);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">add_tedge</span><span style="color: #24292E">(v, u);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">m;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">add_qedge</span><span style="color: #24292E">(u, v, i);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">add_qedge</span><span style="color: #24292E">(v, u, i);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">tarjan</span><span style="color: #24292E">(s, </span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">m;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> ans[i]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">ios</span><span style="color: #24292E">::</span><span style="color: #6F42C1">sync_with_stdio</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cin.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cout.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tomorin</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //cin &gt;&gt; tomorin;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (tomorin</span><span style="color: #D73A49">--</span><span style="color: #24292E">) </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/" class="post-title-link" itemprop="url">【图论】最小生成树</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:51:14" itemprop="dateCreated datePublished" datetime="2025-05-18T21:51:14+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:58:33" itemprop="dateModified" datetime="2025-07-31T17:58:33+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="最小生成树">最小生成树</h1>
<h2 id="定义">定义</h2>
<p>生成树：一个连通图的生成树是一个极小的连通子图，包含图中的n个顶点，但只有构成一棵树的n-1条边</p>
<p>最小生成树：对带权图，它的最小生成树即为原图中边权之和最小的生成树</p>
<h2 id="性质">性质</h2>
<ul>
<li>一个连通图可以有多个生成树</li>
<li>所有生成树都包含相同顶点个数和边数</li>
<li>生成树中不存在环，添加一条鞭会构成环</li>
<li>移除生成树中的任意一条边都会导致图的不连通</li>
<li>对于包含<span
class="math inline">\(n\)</span>个顶点的无向连通图，，生成树包含<span
class="math inline">\(n\)</span>个顶点和<span
class="math inline">\(n-1\)</span>条边，最多包含<span
class="math inline">\(n^{n-2}\)</span>棵生成树</li>
</ul>
<h2 id="prim算法">Prim算法</h2>
<blockquote>
<p>有一个无向图G，每条边有对应边权，从A顶点开始，寻找一个权值最小的路径使其生成一个极小连通子图</p>
</blockquote>
<p>Prim算法即通过加点来构造最小生成树，可以从任何点开始</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250420211824850.png" class="" title="最小生成树1">
<p>从A出发，跟A相连的两条路，选权值最小的A-B</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250420211911784.png" class="" title="最小生成树2">
<p>此时待选路径有A-F, B-I, B-C, B-G</p>
<p>选择权值最小的路径，即A-F</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250420212010372.png" class="" title="最小生成树3">
<p>此时待选路径有B-I, B-C, B-G, F-G, F-E</p>
<p>选择权值最小的路径，即B-I，以此类推</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250420212112027.png" class="" title="最小生成树4">
<p>这里我们依次选择了A-B,A-F, B-I, I-C, B-G</p>
<p>此时权值最小的路径为G-F，但如果连上G-F，则形成了环，不符合极小连通子图</p>
<p>选择G-H</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250420213152794.png" class="" title="最小生成树5">
<p>最后我们生成了这样的路径，即最小生成树</p>
<p><strong>Prim算法更适合稠密图</strong></p>
<p>(邻接矩阵)</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> MAX </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">0x</span><span style="color: #005CC5">7fffffff</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">char</span><span style="color: #24292E"> VertexType ;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> EdgeType;</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  VertexType vertex[N];</span></span>
<span class="line"><span style="color: #24292E">  EdgeType arc[N][N];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> vertex_num;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> edge_num;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">create_graph</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">9</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;edge_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">15</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;A&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;B&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;C&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;D&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;E&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;F&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;G&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;H&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;I&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E">(i</span><span style="color: #D73A49">==</span><span style="color: #24292E">j) G-&gt;arc[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">else</span><span style="color: #24292E"> G-&gt;arc[i][j]</span><span style="color: #D73A49">=</span><span style="color: #24292E">MAX;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">11</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">18</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">16</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">12</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">22</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">8</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">20</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">24</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">16</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">21</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">26</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">5</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">17</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">6</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">19</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // 无向图，把对称的也复制过去</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      G-&gt;arc[j][i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G-&gt;arc[i][j];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">prim</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">   </span><span style="color: #D73A49">int</span><span style="color: #24292E"> i, j, k;</span></span>
<span class="line"><span style="color: #24292E">   </span><span style="color: #D73A49">int</span><span style="color: #24292E"> minn;</span></span>
<span class="line"><span style="color: #24292E">   </span><span style="color: #D73A49">int</span><span style="color: #24292E"> weight[N];</span><span style="color: #6A737D"> // 侯选边</span></span>
<span class="line"><span style="color: #24292E">   </span><span style="color: #D73A49">int</span><span style="color: #24292E"> vex_index[N];</span><span style="color: #6A737D"> // 表示下标和对应值分别代表的顶点间存在一条连线</span></span>
<span class="line"><span style="color: #6A737D">   // 从顶点A开始</span></span>
<span class="line"><span style="color: #24292E">   weight[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // vex_index某点与下标对应点赋值为0</span></span>
<span class="line"><span style="color: #24292E">   vex_index[</span><span style="color: #005CC5">0</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">   </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    weight[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][i];</span><span style="color: #6A737D"> // 存放第i个节点的待选权值</span></span>
<span class="line"><span style="color: #24292E">    vex_index[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 都从0开始连接</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    minn </span><span style="color: #D73A49">=</span><span style="color: #24292E"> MAX;</span></span>
<span class="line"><span style="color: #24292E">    j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    k </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">    // 从0到9，寻找最小的与之连接</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(j</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (weight[j]</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">0</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> weight[j]</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">minn){</span></span>
<span class="line"><span style="color: #24292E">        minn </span><span style="color: #D73A49">=</span><span style="color: #24292E"> weight[j];</span></span>
<span class="line"><span style="color: #24292E">        k </span><span style="color: #D73A49">=</span><span style="color: #24292E"> j;</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> G-&gt;vertex[vex_index[k]]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&quot;, &quot;</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">G-&gt;vertex[k]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">    weight[k]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 该点已被选完，不能再用</span></span>
<span class="line"><span style="color: #6A737D">    // 找新连接点的待选路径</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (weight[j]</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">0</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> G-&gt;arc[k][j]</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">weight[j]){</span></span>
<span class="line"><span style="color: #24292E">        weight[j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G-&gt;arc[k][j];</span><span style="color: #6A737D"> // 更新备选项</span></span>
<span class="line"><span style="color: #24292E">        vex_index[j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> k;</span><span style="color: #6A737D"> // 更新前一个节点的下标为新值</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  mat_grph G;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">create_graph</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">prim</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>(邻接表/链式前向星)</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5005</span><span style="color: #24292E">, M </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">400005</span><span style="color: #24292E">; </span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Edge</span><span style="color: #24292E"> {</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> to, w, next;</span></span>
<span class="line"><span style="color: #24292E">} edge[M];</span><span style="color: #6A737D"> // 无向图 开两倍</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> head[N], cnt;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> dist[N];</span><span style="color: #6A737D">  // 到生成树的距离</span></span>
<span class="line"><span style="color: #D73A49">bool</span><span style="color: #24292E"> vis[N];</span><span style="color: #6A737D">  // 是否已加入生成树</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> parent[N];</span><span style="color: #6A737D"> // 记录父节点</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, ans;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 链式前向星加边</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">u</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">v</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">w</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">    edge[cnt].to </span><span style="color: #D73A49">=</span><span style="color: #24292E"> v;</span></span>
<span class="line"><span style="color: #24292E">    edge[cnt].w </span><span style="color: #D73A49">=</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">    edge[cnt].next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[u];</span></span>
<span class="line"><span style="color: #24292E">    head[u] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> cnt</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">prim</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(dist, </span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f</span><span style="color: #24292E">, sizeof dist);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(parent, </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">, sizeof parent);</span></span>
<span class="line"><span style="color: #24292E">    dist[</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    ans </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E"> n; i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">, minn </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f3f3f3f</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">        // 找到距离生成树最近的点</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; j </span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E"> n; j</span><span style="color: #D73A49">++</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">if</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">vis[j] </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> dist[j] </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> minn) {</span></span>
<span class="line"><span style="color: #24292E">                minn </span><span style="color: #D73A49">=</span><span style="color: #24292E"> dist[j];</span></span>
<span class="line"><span style="color: #24292E">                u </span><span style="color: #D73A49">=</span><span style="color: #24292E"> j;</span></span>
<span class="line"><span style="color: #24292E">            }</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E">(u </span><span style="color: #D73A49">==</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">) </span><span style="color: #D73A49">break</span><span style="color: #24292E">;</span><span style="color: #6A737D">  // 找不到新的点，说明图不连通</span></span>
<span class="line"><span style="color: #24292E">        vis[u] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        ans </span><span style="color: #D73A49">+=</span><span style="color: #24292E"> minn;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (parent[u]</span><span style="color: #D73A49">!=-</span><span style="color: #005CC5">1</span><span style="color: #24292E">) cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">parent[u] </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&quot; &quot;</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">u</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span><span style="color: #6A737D"> // 非起点输出</span></span>
<span class="line"><span style="color: #6A737D">        // 更新其他点到生成树的距离</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[u]; </span><span style="color: #D73A49">~</span><span style="color: #24292E">i; i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> edge[i].next) {</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">int</span><span style="color: #24292E"> v </span><span style="color: #D73A49">=</span><span style="color: #24292E"> edge[i].to;</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">if</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">vis[v] </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> edge[i].w </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> dist[v]) {</span></span>
<span class="line"><span style="color: #24292E">                dist[v] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> edge[i].w;</span></span>
<span class="line"><span style="color: #24292E">                parent[v]</span><span style="color: #D73A49">=</span><span style="color: #24292E">u;</span></span>
<span class="line"><span style="color: #24292E">            }</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(head, </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #D73A49">sizeof</span><span style="color: #24292E">(head));</span></span>
<span class="line"><span style="color: #24292E">    cnt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E"> m; i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v, w;</span></span>
<span class="line"><span style="color: #24292E">        cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(u, v, w);</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(v, u, w);</span><span style="color: #6A737D">  // 无向图需要加两条边</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">prim</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">bool</span><span style="color: #24292E"> check </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E"> n; i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">vis[i]) {</span></span>
<span class="line"><span style="color: #24292E">          check </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">false</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">break</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E">(check) cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> ans </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E"> cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">&quot;orz&quot;</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="kruskal算法">Kruskal算法</h2>
<p>Kruskal算法是通过加边来构建最小生成树的</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250421205358929.png" class="" title="kruskal-1">
<p>按边权从小到大排序，最小的是V1-V3</p>
<p>首先判断加入前这两个端点是否在同一个连通分量中，若可以则添加</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250421205650259.png" class="" title="kruskal-2">
<p>按边权顺序依次添加V4-V6， V2-V5</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250421205746899.png" class="" title="kruskal-3">
<p>此时有两个相同最小边权的情况，证明有多个最小生成树，且都不在同一连通分量，故随便选一个</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250421205855795.png" class="" title="kruskal-4">
<p>此时发现，V3与V6已经位于同一连通分量，故不能加边</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/image-20250421210045002.png" class="" title="kruskal-5">
<p>直到所有点被连通，此时构建了最小生成树</p>
<p><strong>Kruskal算法更适合稀疏图</strong></p>
<p>代码部分使用了并查集来实现判断是否有环</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5005</span><span style="color: #24292E">, M </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">400005</span><span style="color: #24292E">; </span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Edge</span><span style="color: #24292E"> {</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u,v,w;</span></span>
<span class="line"><span style="color: #24292E">} edge[M];</span><span style="color: #6A737D"> // 无向图 开两倍</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> parent[N];</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, cnt </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">, ans </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">// 查找操作</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">find</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (parent[x]</span><span style="color: #D73A49">!=</span><span style="color: #24292E">x)parent[x]</span><span style="color: #D73A49">=</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(parent[x]);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> parent[x];</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 合并操作</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">merge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(a)</span><span style="color: #D73A49">&gt;</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(b)) parent[</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(a)]</span><span style="color: #D73A49">=</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(b);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">else</span><span style="color: #24292E"> parent[</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(b)]</span><span style="color: #D73A49">=</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(a);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m;</span></span>
<span class="line"><span style="color: #6A737D">  // 建图，不需要链式前向星</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">m;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x, y, w;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> y </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">    edge[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> {x,y,w};</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 按权值排序</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">sort</span><span style="color: #24292E">(edge</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">,edge</span><span style="color: #D73A49">+</span><span style="color: #24292E">m</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">, [</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">](</span><span style="color: #6F42C1">Edge</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #6F42C1">Edge</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span><span style="color: #D73A49">return</span><span style="color: #24292E"> a.w</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">b.w;});</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) parent[i]</span><span style="color: #D73A49">=</span><span style="color: #24292E">i;</span><span style="color: #6A737D"> // 自己是自己的</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> temp </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">m;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(edge[i].u)</span><span style="color: #D73A49">==</span><span style="color: #6F42C1">find</span><span style="color: #24292E">(edge[i].v)) </span><span style="color: #D73A49">continue</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 若两者是连通分量则跳过</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">merge</span><span style="color: #24292E">(edge[i].u,edge[i].v);</span><span style="color: #6A737D"> // 建边</span></span>
<span class="line"><span style="color: #24292E">      temp</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 记录建的边数</span></span>
<span class="line"><span style="color: #24292E">      ans</span><span style="color: #D73A49">+=</span><span style="color: #24292E">edge[i].w;</span><span style="color: #6A737D"> // 累加权值</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (temp</span><span style="color: #D73A49">!=</span><span style="color: #24292E">n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">) cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&quot;orz&quot;</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 若建边数不是n-1，则没有生成最小生成树</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">else</span><span style="color: #24292E"> cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> ans ;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/" class="post-title-link" itemprop="url">【图论】最短路径</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:49:50" itemprop="dateCreated datePublished" datetime="2025-05-18T21:49:50+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 18:00:52" itemprop="dateModified" datetime="2025-07-31T18:00:52+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>12 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="最短路径">最短路径</h1>
<h2 id="dijkstra">Dijkstra</h2>
<h3 id="思路">思路</h3>
<p>基本步骤：</p>
<ul>
<li>选定一个点，满足：
<ul>
<li>未被选过</li>
<li>距离最短</li>
</ul></li>
<li>对这个点的所有邻接点尝试<strong>松弛</strong>(如下图，从a到c权值为5，而从a到b到c权值为3，我们用后者代替前者成为最短路，此之为成功的松弛)</li>
</ul>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/image-20250424221240261.png" class="" title="dij">
<p>从a开始，依次寻找下一个节点，使得从a到当前节点的路径最短，直到找到结尾</p>
<p>遍历时，我们依次寻找a到当前节点的最短路径以及最近节点</p>
<p>当我们得到了最短权值，我们可以反推回a从而获取最短路径</p>
<p>用矩阵表示如下</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/image-20250424221254089.png" class="" title="dij矩阵">
<h3 id="代码">代码</h3>
<p>邻接矩阵</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ll;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E"> PII;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #D73A49">e</span><span style="color: #005CC5">5</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e</span><span style="color: #005CC5">9</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;&gt;</span><span style="color: #24292E"> G;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> path;</span></span>
<span class="line"><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; </span><span style="color: #6F42C1">dijkstra</span><span style="color: #24292E">(</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;&gt; </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">G</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">s</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> n </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G.</span><span style="color: #6F42C1">size</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dis</span><span style="color: #24292E">(n,</span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f3f3f3f</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vis</span><span style="color: #24292E">(n,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  dis[s] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> node </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">vis[j]</span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E">(node</span><span style="color: #D73A49">==-</span><span style="color: #005CC5">1</span><span style="color: #D73A49">||</span><span style="color: #24292E">dis[j]</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">dis[node])){</span></span>
<span class="line"><span style="color: #24292E">        node </span><span style="color: #D73A49">=</span><span style="color: #24292E"> j;</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (dis[node]</span><span style="color: #D73A49">+</span><span style="color: #24292E">G[node][j]</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">dis[j]){</span></span>
<span class="line"><span style="color: #24292E">        dis[j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> dis[node]</span><span style="color: #D73A49">+</span><span style="color: #24292E">G[node][j];</span></span>
<span class="line"><span style="color: #24292E">        path[j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> node;</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    vis[node] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> dis;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #6A737D">// 路径获取</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">get_path</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E">, </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">P</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">x){</span></span>
<span class="line"><span style="color: #24292E">    P.</span><span style="color: #6F42C1">push_back</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> ;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 若该节点前有节点，则先获取前面节点的内容</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (path[x]</span><span style="color: #D73A49">!=-</span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span><span style="color: #6F42C1">get_path</span><span style="color: #24292E">(path[x], P);</span></span>
<span class="line"><span style="color: #24292E">  P.</span><span style="color: #6F42C1">push_back</span><span style="color: #24292E">(x);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, s;</span></span>
<span class="line"><span style="color: #24292E">  cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> s;</span></span>
<span class="line"><span style="color: #24292E">  path </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;(n,</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  G </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;&gt; (n,</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;(n, </span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f3f3f3f</span><span style="color: #24292E">));</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">m;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u,v,w;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">    u</span><span style="color: #D73A49">--</span><span style="color: #24292E">,v</span><span style="color: #D73A49">--</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">G[u][v])G[u][v]</span><span style="color: #D73A49">=</span><span style="color: #24292E">w;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E"> G[u][v]</span><span style="color: #D73A49">=</span><span style="color: #6F42C1">min</span><span style="color: #24292E">(G[u][v],w);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">auto</span><span style="color: #24292E"> dis </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dijkstra</span><span style="color: #24292E">(G, s</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">auto</span><span style="color: #24292E"> it: dis)cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> it </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&#39; &#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">ios</span><span style="color: #24292E">::</span><span style="color: #6F42C1">sync_with_stdio</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cin.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cout.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tomorin</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //cin &gt;&gt; tomorin;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (tomorin</span><span style="color: #D73A49">--</span><span style="color: #24292E">) </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h3 id="最小堆优化">最小堆优化</h3>
<p>上述朴素算法的问题：</p>
<ul>
<li>寻找最小点时，通过遍历n个点来获得最小点</li>
<li>对该点邻接点进行松弛时，我们也是通过遍历去寻找邻接点</li>
</ul>
<p>对于以上问题，我们可以选用小根堆与邻接表直接获取，可以实现代码的优化</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> edge, weight, Next, head;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, s;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> idx</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; </span><span style="color: #6F42C1">dijkstra</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">s</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dis</span><span style="color: #24292E">(n,</span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f3f3f3f</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vis</span><span style="color: #24292E">(n,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    dis[s]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">    // 最小堆，first记录dis， second记录node</span></span>
<span class="line"><span style="color: #24292E">    priority_queue</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E">, vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;&gt;</span><span style="color: #24292E">, greater</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;&gt;&gt;</span><span style="color: #24292E"> mh;</span></span>
<span class="line"><span style="color: #24292E">    mh.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">({dis[s],</span><span style="color: #005CC5">0</span><span style="color: #24292E">});</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">mh.</span><span style="color: #6F42C1">empty</span><span style="color: #24292E">()){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> node </span><span style="color: #D73A49">=</span><span style="color: #24292E"> mh.</span><span style="color: #6F42C1">top</span><span style="color: #24292E">().second;</span></span>
<span class="line"><span style="color: #24292E">        mh.</span><span style="color: #6F42C1">pop</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E">(vis[node]) </span><span style="color: #D73A49">continue</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[node];</span><span style="color: #D73A49">~</span><span style="color: #24292E">i;i</span><span style="color: #D73A49">=</span><span style="color: #24292E">Next[i]){</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (dis[edge[i]]</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E">dis[node]</span><span style="color: #D73A49">+</span><span style="color: #24292E">weight[i]){</span></span>
<span class="line"><span style="color: #24292E">                dis[edge[i]]</span><span style="color: #D73A49">=</span><span style="color: #24292E">dis[node]</span><span style="color: #D73A49">+</span><span style="color: #24292E">weight[i];</span></span>
<span class="line"><span style="color: #24292E">                mh.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">({dis[edge[i]],edge[i]});</span></span>
<span class="line"><span style="color: #24292E">            }</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">        vis[node]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> dis;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">u</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">v</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">w</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    edge[idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> v;</span></span>
<span class="line"><span style="color: #24292E">    weight[idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">    Next[idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[u];</span></span>
<span class="line"><span style="color: #24292E">    head[u]</span><span style="color: #D73A49">=</span><span style="color: #24292E">idx</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> s;</span></span>
<span class="line"><span style="color: #24292E">    head </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; (n,</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    edge </span><span style="color: #D73A49">=</span><span style="color: #24292E"> weight </span><span style="color: #D73A49">=</span><span style="color: #24292E"> Next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; (m,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(m</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v, w;</span></span>
<span class="line"><span style="color: #24292E">        cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">        u</span><span style="color: #D73A49">--</span><span style="color: #24292E">,v</span><span style="color: #D73A49">--</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(u,v,w);</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">auto</span><span style="color: #24292E"> dis </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dijkstra</span><span style="color: #24292E">(s</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">auto</span><span style="color: #24292E"> it:dis) cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> it </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&#39; &#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="floyd">Floyd</h2>
<h3 id="思路-1">思路</h3>
<p>Floyd与Dijkstra都是看节点间的值，但是前者看的是每两点间最短距离</p>
<p><strong>Dis数组，记录两点距离：</strong></p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/image-20250423210341040.png" class="" title="floyd">
<p>这里矩阵中每个位置表示两点间的距离，而D上的下标表示从何处中转得到的距离（-1表示不进行中转）</p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/image-20250423210633734.png" class="" title="floyd2">
<p>如此时<span class="math inline">\(D^0\)</span>为从<span
class="math inline">\(v_0\)</span>进行中转得到的两点间距离，且距离可以根据红色式子表示，即经过中转点后的距离与上一步已有距离的最小值</p>
<p><strong>Path数组，记录经过点(最短路径)</strong></p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/image-20250423211054681.png" class="" title="floyd3">
<p>Path数组记录了两点间经过的中转点是哪个点，若为直达则记录终点，如<span
class="math inline">\(P^{-1}\)</span>指的是没有中转，其中记录的都是终点，<span
class="math inline">\(P^0\)</span>指经过<span
class="math inline">\(v_0\)</span>中转，故<span
class="math inline">\(v_1\to v_2\)</span>对应的值为0，表示中转点为<span
class="math inline">\(v_0\)</span></p>
<p>通过path数组推出最短路径：</p>
<p>如寻找<span class="math inline">\(v_1\)</span>到<span
class="math inline">\(v_0\)</span>的最短路径：找到第一行第零列的点对应的点，该点即为到达终点的前一个点；再找到该点对应的点，即为到达该点的前一个点，直到推到起点</p>
<h3 id="代码-1">代码</h3>
<p>(邻接矩阵)</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> M </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">200</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> MAX </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">0x</span><span style="color: #005CC5">10000</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">char</span><span style="color: #24292E"> VertexType ;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> EdgeType;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  VertexType vertex[N];</span></span>
<span class="line"><span style="color: #24292E">  EdgeType arc[N][N];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> vertex_num;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> edge_num;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">createGraph</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">9</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;edge_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">15</span><span style="color: #24292E">; </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">; i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    G-&gt;vertex[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> i;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E">(i</span><span style="color: #D73A49">==</span><span style="color: #24292E">j) G-&gt;arc[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">else</span><span style="color: #24292E"> G-&gt;arc[i][j]</span><span style="color: #D73A49">=</span><span style="color: #24292E">MAX;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">3</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">3</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">3</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">6</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">9</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">5</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">6</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">6</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">7</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">4</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">; j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      G-&gt;arc[j][i] </span><span style="color: #D73A49">=</span><span style="color: #24292E">  G-&gt;arc[i][j];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">floyd</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E"> </span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> path[N][N];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> dis[N][N];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      dis[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G.arc[i][j];</span><span style="color: #6A737D"> // 最初的dis数组</span></span>
<span class="line"><span style="color: #24292E">      path[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> j;</span><span style="color: #6A737D"> // 最初的path数组</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> k </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;k</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;k</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E">(dis[j][k]</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E">dis[j][i]</span><span style="color: #D73A49">+</span><span style="color: #24292E">dis[i][k]){</span></span>
<span class="line"><span style="color: #24292E">          dis[j][k] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> dis[j][i]</span><span style="color: #D73A49">+</span><span style="color: #24292E">dis[i][k];</span></span>
<span class="line"><span style="color: #24292E">          path[j][k] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> path[j][i];</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> k;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">; i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> i</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">; j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;v</span><span style="color: #005CC5">%d</span><span style="color: #032F62">-&gt;v</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> weight:</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> &quot;</span><span style="color: #24292E">, i, j, dis[i][j]);</span></span>
<span class="line"><span style="color: #24292E">      k </span><span style="color: #D73A49">=</span><span style="color: #24292E"> path[i][j];</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;path:v</span><span style="color: #005CC5">%d</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">, i);</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">while</span><span style="color: #24292E">(k</span><span style="color: #D73A49">!=</span><span style="color: #24292E">j){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;-&gt;v</span><span style="color: #005CC5">%d</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">, k);</span></span>
<span class="line"><span style="color: #24292E">        k </span><span style="color: #D73A49">=</span><span style="color: #24292E"> path[k][j];</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;-&gt;v</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">, j);</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;</span><span style="color: #005CC5">\n</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  mat_grph G;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">createGraph</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">floyd</span><span style="color: #24292E">(G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="a">A*</h2>
<p>解决问题：给定原点与目标点，最少代价路径是什么</p>
<p>特点：与dijkstra不同，A*算法考虑从原点到当前点的距离+当前点到目标点距离的估计距离，最后排大小</p>
<style>.yeccugerihyh{zoom:50%;}</style>

<p>如该方格，起点为G，终点为U</p>
<p>从G到U预估走4步，G到G走0步，故参与排序为0+4，放入小根堆，并将原点到当前点距离放入distance表中</p>
<p>G
4取出，G到L,N,H,F为1，放入distance，并分别算出到U的预估距离，相加放入小根堆</p>
<p>在取出堆顶并重复上述操作</p>
<p>dij可以看作A*每次预估距离都为0，是一个特例</p>
<h3 id="预估函数">预估函数</h3>
<p>预估函数是一种吸引力，合适的预估函数（越接近真实距离）会大大提升速度</p>
<p>要求：预估距离<strong>小于等于</strong>到终点的真实距离</p>
<p>预估距离经常选择：曼哈顿距离、欧氏距离、对角线距离等</p>
<p>如：若允许走斜线，曼哈顿距离就不能保证正确性了，此时可以取行与行、列与列间差值最大值</p>
<h3 id="板子">板子</h3>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> edge, weight, Next, head;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, s, t;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> idx</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> idis;</span><span style="color: #6A737D"> // 根据需求填入计算合适理想距离</span></span>
<span class="line"><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; </span><span style="color: #6F42C1">astar</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">s</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dis</span><span style="color: #24292E">(n,</span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f3f3f3f</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vis</span><span style="color: #24292E">(n,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    dis[s]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">    // 最小堆，first记录dis， second记录node</span></span>
<span class="line"><span style="color: #24292E">    priority_queue</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E">, vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;&gt;</span><span style="color: #24292E">, greater</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;&gt;&gt;</span><span style="color: #24292E"> mh;</span></span>
<span class="line"><span style="color: #24292E">    mh.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">({dis[s]</span><span style="color: #D73A49">+</span><span style="color: #24292E">idis[s],s});</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">mh.</span><span style="color: #6F42C1">empty</span><span style="color: #24292E">()){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> node </span><span style="color: #D73A49">=</span><span style="color: #24292E"> mh.</span><span style="color: #6F42C1">top</span><span style="color: #24292E">().second;</span></span>
<span class="line"><span style="color: #24292E">        mh.</span><span style="color: #6F42C1">pop</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E">(vis[node]) </span><span style="color: #D73A49">continue</span><span style="color: #24292E">; </span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (s</span><span style="color: #D73A49">==</span><span style="color: #24292E">t) </span><span style="color: #D73A49">return</span><span style="color: #24292E"> dis;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[node];</span><span style="color: #D73A49">~</span><span style="color: #24292E">i;i</span><span style="color: #D73A49">=</span><span style="color: #24292E">Next[i]){</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (dis[edge[i]]</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E">dis[node]</span><span style="color: #D73A49">+</span><span style="color: #24292E">weight[i]){</span></span>
<span class="line"><span style="color: #24292E">                dis[edge[i]]</span><span style="color: #D73A49">=</span><span style="color: #24292E">dis[node]</span><span style="color: #D73A49">+</span><span style="color: #24292E">weight[i];</span></span>
<span class="line"><span style="color: #24292E">                mh.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">({dis[edge[i]]</span><span style="color: #D73A49">+</span><span style="color: #24292E">idis[edge[i]],edge[i]});</span></span>
<span class="line"><span style="color: #24292E">            }</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">        vis[node]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">true</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> dis;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">u</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">v</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">w</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    edge[idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> v;</span></span>
<span class="line"><span style="color: #24292E">    weight[idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">    Next[idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[u];</span></span>
<span class="line"><span style="color: #24292E">    head[u]</span><span style="color: #D73A49">=</span><span style="color: #24292E">idx</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> s </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> t;</span></span>
<span class="line"><span style="color: #24292E">    head </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; (n,</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    edge </span><span style="color: #D73A49">=</span><span style="color: #24292E"> weight </span><span style="color: #D73A49">=</span><span style="color: #24292E"> Next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; (m,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    idis </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; (n,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(m</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v, w;</span></span>
<span class="line"><span style="color: #24292E">        cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">        u</span><span style="color: #D73A49">--</span><span style="color: #24292E">,v</span><span style="color: #D73A49">--</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(u,v,w);</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">auto</span><span style="color: #24292E"> dis </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">astar</span><span style="color: #24292E">(s</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">auto</span><span style="color: #24292E"> it:dis) cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> it </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&#39; &#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">    // if (it==0x3f3f3f3f) cout &lt;&lt;2147483647&lt;&lt;&#39; &#39;;</span></span>
<span class="line"><span style="color: #6A737D">    // else cout &lt;&lt; it &lt;&lt;&#39; &#39;;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE%E4%B8%8ABFS%E4%B8%8EDFS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE%E4%B8%8ABFS%E4%B8%8EDFS/" class="post-title-link" itemprop="url">【图论】图上BFS/DFS</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:49:15" itemprop="dateCreated datePublished" datetime="2025-05-18T21:49:15+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:58:00" itemprop="dateModified" datetime="2025-07-31T17:58:00+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="图上bfs">图上BFS</h1>
<p>将BFS扩展到图，从顶点0开始访问，逐层访问其邻居顶点，持续到访问完毕</p>
<p>最后获得序列：按照访问距离离起始顶点最近的所有顶点</p>
<p>按照该序列，访问到每个顶点后，就找到了达到该顶点的最短路径（适用于权值相等）</p>
<p><strong>对相同距离邻居顶点，访问顺序不重要</strong></p>
<p>同样可以使用队列实现</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">bool</span><span style="color: #24292E"> vis[N];</span><span style="color: #6A737D"> // 访问标记数组</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">char</span><span style="color: #24292E"> VertexType ;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> EdgeType;</span></span>
<span class="line"><span style="color: #24292E">queue</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> q;</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  VertexType vertex[N];</span></span>
<span class="line"><span style="color: #24292E">  EdgeType arc[N][N];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> vertex_num;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> edge_num;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">create_graph</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">9</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;edge_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">15</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;A&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;B&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;C&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;D&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;E&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;F&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;G&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;H&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;I&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      G-&gt;arc[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">5</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">6</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // 无向图，把对称的也复制过去</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      G-&gt;arc[j][i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G-&gt;arc[i][j];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">bfs</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  vis[i]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> G.vertex[i]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  q.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(i);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">q.</span><span style="color: #6F42C1">empty</span><span style="color: #24292E">()){</span></span>
<span class="line"><span style="color: #24292E">    i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> q.</span><span style="color: #6F42C1">front</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">    q.</span><span style="color: #6F42C1">pop</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">(vis[j])</span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E">G.arc[i][j]</span><span style="color: #D73A49">==</span><span style="color: #005CC5">1</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        vis[j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> G.vertex[j]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">        q.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(j);</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  mat_grph G;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">create_graph</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(vis, </span><span style="color: #005CC5">0</span><span style="color: #24292E">, sizeof vis);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">bfs</span><span style="color: #24292E">(G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h1 id="图上dfs">图上DFS</h1>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE%E4%B8%8ABFS%E4%B8%8EDFS/image-20250420205037428.png" class="" title="DFS邻接矩阵">
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">100</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">bool</span><span style="color: #24292E"> vis[N];</span><span style="color: #6A737D"> // 访问标记数组</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">char</span><span style="color: #24292E"> VertexType ;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> EdgeType;</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  VertexType vertex[N];</span></span>
<span class="line"><span style="color: #24292E">  EdgeType arc[N][N];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> vertex_num;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> edge_num;</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">create_graph</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #E36209">G</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">9</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;edge_num </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">15</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;A&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;B&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;C&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;D&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;E&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;F&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;G&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;H&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;vertex[</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;I&#39;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      G-&gt;arc[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">1</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">0</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">2</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">1</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">3</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">2</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">4</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">3</span><span style="color: #24292E">][</span><span style="color: #005CC5">8</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">5</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">4</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">5</span><span style="color: #24292E">][</span><span style="color: #005CC5">6</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  G-&gt;arc[</span><span style="color: #005CC5">6</span><span style="color: #24292E">][</span><span style="color: #005CC5">7</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // 无向图，把对称的也复制过去</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G-&gt;vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      G-&gt;arc[j][i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> G-&gt;arc[i][j];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">dfs</span><span style="color: #24292E">(</span><span style="color: #6F42C1">mat_grph</span><span style="color: #24292E"> </span><span style="color: #D73A49">&amp;</span><span style="color: #E36209">G</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">i</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  vis[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> G.vertex[i]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">G.vertex_num;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span><span style="color: #6A737D"> // 寻找邻接矩阵中和第i个顶点间有边的顶点</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> ((</span><span style="color: #D73A49">!</span><span style="color: #24292E">vis[j]) </span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E"> G.arc[i][j]</span><span style="color: #D73A49">==</span><span style="color: #005CC5">1</span><span style="color: #24292E">){</span><span style="color: #6A737D"> // 如果没被访问过且存在边，则从其对应的顶点开始搜索与其有边的顶点</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">dfs</span><span style="color: #24292E">(G, j);</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">  mat_grph G;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">create_graph</span><span style="color: #24292E">(</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">G);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(vis, </span><span style="color: #005CC5">0</span><span style="color: #24292E">, sizeof vis);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">dfs</span><span style="color: #24292E">(G, </span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE/" class="post-title-link" itemprop="url">【图论】图</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:48:42" itemprop="dateCreated datePublished" datetime="2025-05-18T21:48:42+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:57:51" itemprop="dateModified" datetime="2025-07-31T17:57:51+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="图">图</h1>
<h2 id="定义">定义</h2>
<p>由顶点的有穷非空集合和顶点间的边的集合组成的</p>
<p>通常记为<code>G(v,e)</code>，G表示一个图，v是G中顶点集合，e是边的集合</p>
<p>即<code>V(G)</code>和<code>E(G)</code>分别成为G的点集和边集</p>
<p><strong>必须有顶点，但可以没有边</strong></p>
<h2 id="无向图与有向图">无向图与有向图</h2>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE/image-20250418191304599.png" class="" title="类型">
<p>有向图用有序对表示，视为集合<span
class="math inline">\(V\)</span>上的一个二元关系<span
class="math inline">\(R\subseteq V\times V\)</span></p>
<p>无向图用无序对表示，视为集合<span
class="math inline">\(V\)</span>上的对称二元关系，即<span
class="math inline">\((u,v)\in R\)</span>必有<span
class="math inline">\((v,u)\in R\)</span></p>
<h2 id="简单图与多重图">简单图与多重图</h2>
<p>简单图：</p>
<ul>
<li>图中不能有顶点到自身的边</li>
<li>同一条便在途中不能出现两次及以上</li>
</ul>
<p>不满足上述条件的成为多重图</p>
<h2 id="完全图">完全图</h2>
<p>具有最多边数的图</p>
<p>对于一个具有n个顶点的无向完全图，边数量的最大值为<span
class="math inline">\(\frac{n(n-1)}{2}\)</span></p>
<p>对于一个具有n个顶点的有向完全图，边数量的最大值为<span
class="math inline">\(n(n-1)\)</span></p>
<h2 id="路径与路径长度">路径与路径长度</h2>
<p>路径：从一个顶点开始，经过一系列的边到达另一个顶点形成的顶点序列</p>
<p>路径长度：路径上边的条数</p>
<p>回路（环）：起点与终点相同的路径</p>
<p>简单路径：如果路径中不出现相同顶点，则成为简单路径</p>
<p>简单回路：除了第一个顶点和最后一个顶点外，其余顶点不重复出现的回路</p>
<h2 id="度">度</h2>
<p>对于无向图，顶点的度指的是与顶点相关联边的数目</p>
<p>入度：有向图中，箭头指向顶点v的边的数目</p>
<p>出度：有向图中，从该顶点出发的边的数目</p>
<p>与边的关系：</p>
<ul>
<li>图中所有顶点度之和等于边数的两倍</li>
<li>对于有向图，所有顶点的出度与入度之和相等，弧数量也相等</li>
</ul>
<h2 id="子图">子图</h2>
<p>图G的子图H，满足<span class="math inline">\(V(H)\)</span>是<span
class="math inline">\(V(G)\)</span>子集且<span
class="math inline">\(E(H)\)</span>是<span
class="math inline">\(E(G)\)</span>子集</p>
<h2 id="连通图">连通图</h2>
<p>连通图：在无向图中，如果顶点v到顶点w有路径，则称顶点v到顶点w是连通的。如果对于图中任意两个顶点都是连通的，则称此图为连通图</p>
<p>极大连通子图：在这个子图中任意两个顶点都是连通的，而且不能通过添加更多顶点或边来扩大这种连通性</p>
<p>连通分量：无向图中的极大连通子图称为连通分量</p>
<p>强连通图：在有向图中，对于每一对顶点v和w，从v到w和从w到v都有路径，则称该有向图是强连通图。</p>
<p>强连通分量：有向图中的极大强连通子图称为有向图的强连通分量</p>
<h2 id="生成树">生成树</h2>
<p>含有图中全部顶点的极小联通子树</p>
<p><strong>包含所有顶点n，但只有足以构成一棵树的n-1条边</strong></p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%9B%BE/image-20250418194932122.png" class="" title="生成树">
<h2 id="边权和网">边权和网</h2>
<p>权：在一个图中，每条边可以标注上一个代表某种含义的数值，该数值称为这个边的权值</p>
<p>网：边上带权值的图，也称为带权图</p>
<h2 id="例">例</h2>
<blockquote>
<p>若无向图<span
class="math inline">\(G=(v,e)\)</span>中含有七个顶点，要保证图G在任何情况下连通，则需要边数最少是</p>
</blockquote>
<p>即6个顶点的最多边数+1即为7个顶点最少边数</p>
<p>用公式<span class="math inline">\(\frac{n(n-1)}{2}\)</span></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/" class="post-title-link" itemprop="url">【图论】拓扑排序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:47:51" itemprop="dateCreated datePublished" datetime="2025-05-18T21:47:51+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:57:36" itemprop="dateModified" datetime="2025-07-31T17:57:36+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="拓扑排序">拓扑排序</h1>
<h2 id="节点的度">节点的度</h2>
<ul>
<li>度：与节点相连的边的条数</li>
<li>入度：有向图中，指向当前节点的边的条数</li>
<li>出度：有向图中，从当前节点发出的边的条数</li>
</ul>
<h2 id="aov网">AOV网</h2>
<p>在一个表示工程的有向图中，用顶点表示活动，用弧表示活动之间的优先级，这样的有向图为顶点表示活动的网，称为AOV(Activity
On Vertex Network)网</p>
<h2 id="定义">定义</h2>
<p>将一个有向无环图G的所有顶点排成一个线性序列，使得有向无环图G的边集中的任意一条边&lt;u,v&gt;，始终满足u出现在v的前面</p>
<h2 id="构造">构造</h2>
<ol type="1">
<li>在有向无环图中找到一个没有前驱（入度为0）的节点入栈</li>
<li>将栈顶节点出栈，然后从图中将此节点删除，并删除以该节点为尾的弧</li>
<li>重复操作</li>
<li>如果所有节点都已经输出，则结束，否则重复1</li>
</ol>
<h2 id="实现邻接矩阵">实现(邻接矩阵)</h2>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/image-20250416213937211.png" class="" title="例">
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ll;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E"> PII;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1000</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e</span><span style="color: #005CC5">9</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> g[N][N], indgr[N], res[N];</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">topsort</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> k </span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span><span style="color: #6A737D"> // 寻找入度为0的点</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">indgr[j]){</span></span>
<span class="line"><span style="color: #24292E">        res[i]</span><span style="color: #D73A49">=</span><span style="color: #24292E">j;</span><span style="color: #6A737D"> // 记录已经处理的点</span></span>
<span class="line"><span style="color: #24292E">        indgr[j]</span><span style="color: #D73A49">--</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 删除入读为0的点</span></span>
<span class="line"><span style="color: #24292E">        k</span><span style="color: #D73A49">=</span><span style="color: #24292E">j;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">break</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (g[k][j]</span><span style="color: #D73A49">==</span><span style="color: #005CC5">1</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        g[k][j]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 删除对应边 可省略，因为拓扑排序只看入度</span></span>
<span class="line"><span style="color: #24292E">        indgr[j]</span><span style="color: #D73A49">--</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 入读-1</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #6A737D">  // 视频中第一个例题</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">~</span><span style="color: #6F42C1">scanf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> </span><span style="color: #005CC5">%d</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">, </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">n, </span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">m)){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x, y;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(indgr, </span><span style="color: #005CC5">0</span><span style="color: #24292E">, sizeof indgr);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">memset</span><span style="color: #24292E">(g, </span><span style="color: #005CC5">0</span><span style="color: #24292E">, sizeof g);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">m;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">scanf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> </span><span style="color: #005CC5">%d</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">x,</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">y);</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (</span><span style="color: #D73A49">!</span><span style="color: #24292E">g[x][y]) {</span></span>
<span class="line"><span style="color: #24292E">        g[x][y]</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        indgr[y]</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #6F42C1">topsort</span><span style="color: #24292E">(n);</span></span>
<span class="line"><span style="color: #24292E">      </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n) </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;</span><span style="color: #005CC5">%d</span><span style="color: #032F62"> &quot;</span><span style="color: #24292E">, res[i]);</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">else</span><span style="color: #24292E"> </span><span style="color: #6F42C1">printf</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;</span><span style="color: #005CC5">%d\n</span><span style="color: #032F62">&quot;</span><span style="color: #24292E">, res[i]);</span></span>
<span class="line"><span style="color: #24292E">      }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E"> </span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #6A737D">  //ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tomorin</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //cin &gt;&gt; tomorin;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (tomorin</span><span style="color: #D73A49">--</span><span style="color: #24292E">) </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<p>注意：</p>
<ul>
<li>编号大的节点优先输出：寻找入度0的点时倒序遍历</li>
<li>如何判断有环：不存在入度为0的点</li>
</ul>
<h2 id="实现邻接表">实现(邻接表)</h2>
<p><strong>对于稀疏图，使用邻接矩阵会浪费大量空间</strong>，我们可以使用邻接表</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 邻接表节点结构</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> x;</span><span style="color: #6A737D"> // 节点编号</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> w;</span><span style="color: #6A737D"> // 权值</span></span>
<span class="line"><span style="color: #24292E">    node</span><span style="color: #D73A49">*</span><span style="color: #24292E"> next;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6F42C1">node</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x_</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">w_</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;x </span><span style="color: #D73A49">=</span><span style="color: #24292E"> x_;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">this</span><span style="color: #24292E">-&gt;w </span><span style="color: #D73A49">=</span><span style="color: #24292E"> w_;</span></span>
<span class="line"><span style="color: #24292E">        next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">nullptr</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">node</span><span style="color: #D73A49">*&gt;</span><span style="color: #24292E"> head;</span><span style="color: #6A737D">      // 邻接表头节点数组</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> in_degree;</span><span style="color: #6A737D">   // 记录每个节点的入度</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 添加有向边</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">u</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">v</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">w</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    node</span><span style="color: #D73A49">*</span><span style="color: #24292E"> a </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[u];</span></span>
<span class="line"><span style="color: #24292E">    node</span><span style="color: #D73A49">*</span><span style="color: #24292E"> b </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E">(v,w);</span></span>
<span class="line"><span style="color: #24292E">    b-&gt;next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> a-&gt;next;</span></span>
<span class="line"><span style="color: #24292E">    a-&gt;next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> b;</span></span>
<span class="line"><span style="color: #24292E">    in_degree[v]</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span><span style="color: #6A737D">      // 目标节点入度加1</span></span>
<span class="line"><span style="color: #24292E">}	</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A737D">// 拓扑排序</span></span>
<span class="line"><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt; </span><span style="color: #6F42C1">topological_sort</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">    vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> result;</span><span style="color: #6A737D">          // 存储拓扑序列结果</span></span>
<span class="line"><span style="color: #24292E">    queue</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> q;</span><span style="color: #6A737D">               // 存储入度为0的节点</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #6A737D">    // 将所有入度为0的节点入队</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E"> n; i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E">(in_degree[i] </span><span style="color: #D73A49">==</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">            q.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(i);</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #6A737D">    // 不断取出入度为0的节点，更新其邻接点的入度</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #D73A49">!</span><span style="color: #24292E">q.</span><span style="color: #6F42C1">empty</span><span style="color: #24292E">()) {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> cur </span><span style="color: #D73A49">=</span><span style="color: #24292E"> q.</span><span style="color: #6F42C1">front</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">        q.</span><span style="color: #6F42C1">pop</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">        result.</span><span style="color: #6F42C1">push_back</span><span style="color: #24292E">(cur);</span><span style="color: #6A737D">   // 将当前节点加入结果序列</span></span>
<span class="line"><span style="color: #24292E">        </span></span>
<span class="line"><span style="color: #6A737D">        // 遍历当前节点的所有邻接点</span></span>
<span class="line"><span style="color: #24292E">        node</span><span style="color: #D73A49">*</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> head[cur]-&gt;next;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">while</span><span style="color: #24292E">(p) {</span></span>
<span class="line"><span style="color: #24292E">            in_degree[p-&gt;x]</span><span style="color: #D73A49">--</span><span style="color: #24292E">;</span><span style="color: #6A737D">   // 将邻接点的入度减1</span></span>
<span class="line"><span style="color: #6A737D">            // 如果入度减为0，则入队</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">if</span><span style="color: #24292E">(in_degree[p-&gt;x] </span><span style="color: #D73A49">==</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">                q.</span><span style="color: #6F42C1">push</span><span style="color: #24292E">(p-&gt;x);</span></span>
<span class="line"><span style="color: #24292E">            }</span></span>
<span class="line"><span style="color: #24292E">            p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> p-&gt;next;</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> result;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m;</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m;</span><span style="color: #6A737D">              // 输入节点数和边数</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #6A737D">    // 初始化</span></span>
<span class="line"><span style="color: #24292E">    head.</span><span style="color: #6F42C1">resize</span><span style="color: #24292E">(n</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    in_degree.</span><span style="color: #6F42C1">resize</span><span style="color: #24292E">(n</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E"> n; i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        head[i] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E">(i,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #6A737D">    // 输入边的信息</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">; i </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> m; i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">int</span><span style="color: #24292E"> u, v, w;</span></span>
<span class="line"><span style="color: #24292E">        cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> u </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> v </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> w;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6F42C1">add_edge</span><span style="color: #24292E">(u,v,w);</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #6A737D">    // 执行拓扑排序</span></span>
<span class="line"><span style="color: #24292E">    vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> topo </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">topological_sort</span><span style="color: #24292E">(n);</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #6A737D">    // 判断是否存在环并输出结果</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E">(topo.</span><span style="color: #6F42C1">size</span><span style="color: #24292E">() </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> n) {</span></span>
<span class="line"><span style="color: #24292E">        cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">&quot;图中存在环，无法进行拓扑排序&quot;</span><span style="color: #24292E"> </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">    } </span><span style="color: #D73A49">else</span><span style="color: #24292E"> {</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> x : topo) {</span></span>
<span class="line"><span style="color: #24292E">            cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> x </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #032F62">&quot; &quot;</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">        }</span></span>
<span class="line"><span style="color: #24292E">        cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> endl;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h1 id="关键路径">关键路径</h1>
<h2 id="aoe网">AOE网</h2>
<p>在一个表示工程的带权有向图中，用顶点表示事件，用有向边表示活动，用边上的权值表示活动持续时间，这种有向图的边表示活动的网，称为AOE（Activity
On Edge Network）网</p>
<h2 id="etv与ltv">ETV与LTV</h2>
<p>ETV：表示事件最早发生的时间(earliest time of vertex)</p>
<p><strong>注意：考虑到多线程操作，事件最早发生时间应该是多个同步事件完成时间的最大值</strong></p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/image-20250423222115389.png" class="" title="etv">
<p>LTV：表示事件最晚发生的时间(latest time of vertex)</p>
<p><strong>注意：同理，事件最晚发生时间应该是减去多个同步事件完成时间后的最小值</strong></p>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/image-20250423222735385.png" class="" title="ltv">

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%80%8D%E5%A2%9E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%80%8D%E5%A2%9E/" class="post-title-link" itemprop="url">【算法】倍增</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:45:21" itemprop="dateCreated datePublished" datetime="2025-05-18T21:45:21+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:54:44" itemprop="dateModified" datetime="2025-07-31T17:54:44+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">算法与数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="倍增">倍增</h1>
<h2 id="问题引入">问题引入</h2>
<blockquote>
<p>Q1:
给定一个正数x，已知x一定可用m个二进制位表示，从高位到低位打印x每一位的状态</p>
</blockquote>
<p>从数二进制位左往右第i位计算<code>1&lt;&lt;i</code>，让原数与其相减，若结果小于0则不减，并将该位状态标记为0，若大于0则减去，并将该位状态标记为1</p>
<p>如数101，二进制为0001100101，</p>
<p><code>1&lt;&lt;9</code>为512&gt;101，不减，第九位状态为0</p>
<p><code>1&lt;&lt;8</code>为256&gt;101，不减，第八位状态为0</p>
<p><code>1&lt;&lt;7</code>为128&gt;101，不减，第七位状态为0</p>
<p><code>1&lt;&lt;6</code>为64&lt;101，减成37，第六位状态为1</p>
<p><code>1&lt;&lt;5</code>为25&lt;32，减成5，第五位状态为1</p>
<p>以此类推</p>
<blockquote>
<p>Q2: 给定一个正数x，打印&lt;=x的最大的2的幂是2的几次方，注意防溢出</p>
</blockquote>
<p>若x=13，则<span
class="math inline">\(2^3=8\)</span>最接近13，输出3</p>
<p>若x=16，则<span
class="math inline">\(2^4=16\)</span>最接近16，输出4</p>
<p>溢出：若x非常接近INT_MAX，则每次从<span
class="math inline">\(2^{p-1}\leq x\leq2^p\)</span>时很有可能溢出</p>
<p>解决方案：当<span class="math inline">\(2^p\leq
\frac{x}{2}\)</span>时就让p++</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">q2</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">x</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">int</span><span style="color: #24292E"> power </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">power)</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">(x</span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #005CC5">1</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">        power</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> power;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="倍增算法">倍增算法</h2>
<blockquote>
<p>线段上有n个点，给定每个点i往右边跳1步能最远覆盖的点jump[i]</p>
<p>已知从任意点出发都能到达最后的点，并且在i&lt;j时，必定有jump[i]&lt;=jump[j]</p>
<ol type="1">
<li>如何构建一张表可以查询从任意点i出发，任意跳<span
class="math inline">\(2^p\)</span>步，最远能到达的点</li>
<li>如何快速计算任意两点之间，最少跳几步能到达</li>
</ol>
</blockquote>
<img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%80%8D%E5%A2%9E/image-20250430100833228.png" class="" title="图解">
<ol type="1">
<li></li>
</ol>
<p>如该表，行代表p，表示<span
class="math inline">\(2^p\)</span>次方内对应点是否能到达，列代表点i</p>
<p>初始jump[i]填入第一列，即<code>st[i][0]=jump[i]</code>，后面列的填充满足转移方程<code>st[i][p]=st[st[i][p-1]][p-1]</code>，即跳<span
class="math inline">\(2^p\)</span>内能到达的可以转化为从<span
class="math inline">\(2^{p-1}\)</span>跳<span
class="math inline">\(2^{p-1}\)</span>内能到达</p>
<p>该表列最多<span class="math inline">\(\log_2n\)</span>列</p>
<p>这就是<strong>ST表</strong>，我们利用ST表从x到y跳跃的过程中，先从最大步长开始，每次减少一半尝试，最后得到答案</p>
<ol start="2" type="1">
<li></li>
</ol>
<p>假设计算17到77至少要多少步</p>
<p>我们知道至多需要60步，而60可以用六个二进制位表示</p>
<p>从左往右，让17往右跳<span
class="math inline">\(2^i\)</span>步，看对应数值大于还是小于77，大于则该位标0，小于则标1，且将步数转为49</p>
<p>最后需要的是逼近77的结果，如最后到达了73，再加一步就能到达77</p>
<h2 id="例-倍增跳跃">例-倍增跳跃</h2>
<blockquote>
<p><strong>P4155 [SCOI2015] 国旗计划</strong></p>
</blockquote>
<p>题意：给定m个点，编号1-m，所有点围城一个环，i号点顺时针到达i+1号点，最终m号点顺时针回到1号点</p>
<p>给定n条线段，每条线段(a,b)表示线段顺时针从a到b</p>
<p>保证所有线段可以把整个环覆盖，且线段间可能重合但一定互不包含</p>
<p>返回长度为n的结果数组ans，ans[x]表示一定选x号线段下，至少选几条线段能覆盖整个环</p>
<p><img src="/%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%80%8D%E5%A2%9E/image-20250430113318806.png" class="" title="例"></p>
<p>我们将环展开成条进行计算，即每次寻找包含在内且尽量靠右的线段跳跃，寻找离转一圈后的起始点所在的最近的线段</p>
<p>如从A开始，需要经过A-&gt;B-&gt;D才能到达10(2)点，故需要三条线段覆盖</p>
<p>构建时只需要看第i个点所在线段的末尾是哪个即可，表示一步内从i可以跳到末尾</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ll;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E"> PII;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #D73A49">e</span><span style="color: #005CC5">5</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e</span><span style="color: #005CC5">9</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">struct</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> idx;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> s,e;</span></span>
<span class="line"><span style="color: #24292E">}line[</span><span style="color: #005CC5">2</span><span style="color: #D73A49">*</span><span style="color: #24292E">N];</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n, m, power;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;&gt;</span><span style="color: #24292E"> st;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> ans;</span></span>
<span class="line"><span style="color: #6A737D">// 将环状展开为线性</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">lgp</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">n</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> ans </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E">((</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">ans)</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">(n</span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #005CC5">1</span><span style="color: #24292E">)){</span></span>
<span class="line"><span style="color: #24292E">    ans</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> ans;</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">build</span><span style="color: #24292E">(){</span></span>
<span class="line"><span style="color: #6A737D">  /*如C(6,1),m=8</span></span>
<span class="line"><span style="color: #6A737D">  * 有1 2 3 4 5 6 7 8 9 10 11 ...</span></span>
<span class="line"><span style="color: #6A737D">                      1  2  3...</span></span>
<span class="line"><span style="color: #6A737D">    故转化后的C是(6,9)</span></span>
<span class="line"><span style="color: #6A737D">  */</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (line[i].s</span><span style="color: #D73A49">&gt;</span><span style="color: #24292E">line[i].e){</span></span>
<span class="line"><span style="color: #24292E">      line[i].e</span><span style="color: #D73A49">+=</span><span style="color: #24292E">m;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 按起始点排序</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">sort</span><span style="color: #24292E">(line</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">,line</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #D73A49">+</span><span style="color: #24292E">n,[</span><span style="color: #D73A49">&amp;</span><span style="color: #24292E">](</span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E"> </span><span style="color: #E36209">a</span><span style="color: #24292E">, </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">node</span><span style="color: #24292E"> </span><span style="color: #E36209">b</span><span style="color: #24292E">){</span><span style="color: #D73A49">return</span><span style="color: #24292E"> a.s</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">b.s;});</span></span>
<span class="line"><span style="color: #6A737D">  // 对点在线性上进行复制即 A B C D A&#39; B&#39; C&#39; D&#39;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    line[i</span><span style="color: #D73A49">+</span><span style="color: #24292E">n].idx </span><span style="color: #D73A49">=</span><span style="color: #24292E"> line[i].idx;</span></span>
<span class="line"><span style="color: #24292E">    line[i</span><span style="color: #D73A49">+</span><span style="color: #24292E">n].s </span><span style="color: #D73A49">=</span><span style="color: #24292E"> line[i].s</span><span style="color: #D73A49">+</span><span style="color: #24292E">m;</span></span>
<span class="line"><span style="color: #24292E">    line[i</span><span style="color: #D73A49">+</span><span style="color: #24292E">n].e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> line[i].e</span><span style="color: #D73A49">+</span><span style="color: #24292E">m;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 新线段数量</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> e </span><span style="color: #D73A49">=</span><span style="color: #24292E"> n</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  // 寻找跳一步的最大值, 应满足下一条线段开头&lt;=当前线段结尾</span></span>
<span class="line"><span style="color: #6A737D">  /*如线段开头如下</span></span>
<span class="line"><span style="color: #6A737D">  3</span></span>
<span class="line"><span style="color: #6A737D">    34 </span></span>
<span class="line"><span style="color: #6A737D">      56</span></span>
<span class="line"><span style="color: #6A737D">        89</span></span>
<span class="line"><span style="color: #6A737D">          102</span></span>
<span class="line"><span style="color: #6A737D">  到102就超过了结尾，故选择到89</span></span>
<span class="line"><span style="color: #6A737D">  */</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">, j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">e;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">while</span><span style="color: #24292E">(j</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">e</span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E">line[j</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">].s</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">line[i].e){</span></span>
<span class="line"><span style="color: #24292E">      j</span><span style="color: #D73A49">++</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">    st[i][</span><span style="color: #005CC5">0</span><span style="color: #24292E">]</span><span style="color: #D73A49">=</span><span style="color: #24292E">j;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #6A737D">  // 倍增</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">; p</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">power; p</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">e;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      st[i][p]</span><span style="color: #D73A49">=</span><span style="color: #24292E">st[st[i][p</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">]][p</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">];</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">jump</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">i</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #6A737D">  // i号线段的目标点是line[i].s+m</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tar </span><span style="color: #D73A49">=</span><span style="color: #24292E"> line[i].s</span><span style="color: #D73A49">+</span><span style="color: #24292E">m,cur </span><span style="color: #D73A49">=</span><span style="color: #24292E"> i, next, ans </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> p </span><span style="color: #D73A49">=</span><span style="color: #24292E"> power; p</span><span style="color: #D73A49">&gt;=</span><span style="color: #005CC5">0</span><span style="color: #24292E">;p</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    next </span><span style="color: #D73A49">=</span><span style="color: #24292E"> st[cur][p];</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (next</span><span style="color: #D73A49">!=</span><span style="color: #005CC5">0</span><span style="color: #D73A49">&amp;&amp;</span><span style="color: #24292E">line[next].e</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">tar){</span></span>
<span class="line"><span style="color: #24292E">      ans</span><span style="color: #D73A49">+=</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">p;</span></span>
<span class="line"><span style="color: #24292E">      cur </span><span style="color: #D73A49">=</span><span style="color: #24292E"> next;</span></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> ans</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span><span style="color: #6A737D"> // 计算的是小于目标点，+1即为到达 </span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">void</span><span style="color: #24292E"> </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">() {</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">  cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m;</span></span>
<span class="line"><span style="color: #24292E">  </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    line[i].idx </span><span style="color: #D73A49">=</span><span style="color: #24292E"> i; </span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> line[i].s </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> line[i].e;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  power </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">lgp</span><span style="color: #24292E">(n);</span></span>
<span class="line"><span style="color: #24292E">  st </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;&gt;(</span><span style="color: #005CC5">2</span><span style="color: #D73A49">*</span><span style="color: #24292E">n</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;(power</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">,</span><span style="color: #005CC5">0</span><span style="color: #24292E">));</span></span>
<span class="line"><span style="color: #24292E">  ans </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;(n</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">,</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">build</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    ans[line[i].idx] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">jump</span><span style="color: #24292E">(i);</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;=</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> ans[i]</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #032F62">&#39; &#39;</span><span style="color: #24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #6F42C1">ios</span><span style="color: #24292E">::</span><span style="color: #6F42C1">sync_with_stdio</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cin.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">); cout.</span><span style="color: #6F42C1">tie</span><span style="color: #24292E">(</span><span style="color: #005CC5">0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> tomorin</span><span style="color: #D73A49">=</span><span style="color: #005CC5">1</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #6A737D">  //cin &gt;&gt; tomorin;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (tomorin</span><span style="color: #D73A49">--</span><span style="color: #24292E">) </span><span style="color: #6F42C1">solve</span><span style="color: #24292E">();</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="例-rmq问题">例-RMQ问题</h2>
<blockquote>
<p><strong>P2880 [USACO07JAN] Balanced Lineup G</strong></p>
</blockquote>
<p>仍然构造一个st表，表示覆盖范围内对应的最大值</p>
<p>对于状态转移，每次的最大值一定在前一个区间(<span
class="math inline">\(i\to2^{p-1}\)</span>)与当前区间(<span
class="math inline">\(i+2^{p-1}\to2^{p-1}\)</span>)</p>
<p>对于查询，寻找最接近区间长度的一个2的p次幂，取从起点往后跳<span
class="math inline">\(2^p\)</span>长度与从终点往前跳<span
class="math inline">\(2^p\)</span>长度两者最大值的最大值</p>
<figure class="shiki c++"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">#include</span><span style="color: #24292E"> </span><span style="color: #032F62">&lt;bits/stdc++.h&gt;</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">ios</span><span style="color: #24292E"> ios::sync_with_stdio(0); cin.tie(0); cout.tie(0);</span></span>
<span class="line"><span style="color: #D73A49">#define</span><span style="color: #24292E"> </span><span style="color: #6F42C1">endl</span><span style="color: #24292E"> &#39;\n&#39;</span></span>
<span class="line"><span style="color: #D73A49">using</span><span style="color: #24292E"> </span><span style="color: #D73A49">namespace</span><span style="color: #24292E"> </span><span style="color: #6F42C1">std</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ll;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">unsigned</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> ull;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> </span><span style="color: #D73A49">long</span><span style="color: #24292E"> </span><span style="color: #D73A49">double</span><span style="color: #24292E"> ld;</span></span>
<span class="line"><span style="color: #D73A49">typedef</span><span style="color: #24292E"> pair</span><span style="color: #D73A49">&lt;int</span><span style="color: #24292E">,</span><span style="color: #D73A49">int&gt;</span><span style="color: #24292E"> PII;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> N </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">2</span><span style="color: #D73A49">e</span><span style="color: #005CC5">5</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">10</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">double</span><span style="color: #24292E"> pi </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">acos</span><span style="color: #24292E">(</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1.0</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> mod </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e</span><span style="color: #005CC5">9</span><span style="color: #24292E"> </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">7</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">int</span><span style="color: #24292E"> INF </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">0x</span><span style="color: #005CC5">3f3f3f3f</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #D73A49">double</span><span style="color: #24292E"> eps </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #D73A49">e-</span><span style="color: #005CC5">6</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> n,m;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;&gt;</span><span style="color: #24292E"> dp1;</span></span>
<span class="line"><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">vector</span><span style="color: #D73A49">&lt;int&gt;&gt;</span><span style="color: #24292E"> dp2;</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">query1</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">l</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">r</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E">)</span><span style="color: #6F42C1">log2</span><span style="color: #24292E">(r</span><span style="color: #D73A49">-</span><span style="color: #24292E">l</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #6F42C1">max</span><span style="color: #24292E">(dp1[l][j],dp1[r</span><span style="color: #D73A49">-</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">j)</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">][j]);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">query2</span><span style="color: #24292E">(</span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">l</span><span style="color: #24292E">, </span><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #E36209">r</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E">)</span><span style="color: #6F42C1">log2</span><span style="color: #24292E">(r</span><span style="color: #D73A49">-</span><span style="color: #24292E">l</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #6F42C1">min</span><span style="color: #24292E">(dp2[l][j],dp2[r</span><span style="color: #D73A49">-</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">j)</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">][j]);</span></span>
<span class="line"><span style="color: #24292E">}</span></span>
<span class="line"><span style="color: #D73A49">int</span><span style="color: #24292E"> </span><span style="color: #6F42C1">main</span><span style="color: #24292E">()</span></span>
<span class="line"><span style="color: #24292E">{</span></span>
<span class="line"><span style="color: #24292E">  ios</span></span>
<span class="line"><span style="color: #24292E">  cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> n </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> m;</span></span>
<span class="line"><span style="color: #24292E">  dp1 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;&gt; (n,</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;(</span><span style="color: #6F42C1">log2</span><span style="color: #24292E">(n)</span><span style="color: #D73A49">+</span><span style="color: #005CC5">5</span><span style="color: #24292E">,</span><span style="color: #005CC5">0</span><span style="color: #24292E">));</span></span>
<span class="line"><span style="color: #24292E">  dp2 </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;&gt; (n,</span><span style="color: #6F42C1">vector</span><span style="color: #24292E">&lt;</span><span style="color: #D73A49">int</span><span style="color: #24292E">&gt;(</span><span style="color: #6F42C1">log2</span><span style="color: #24292E">(n)</span><span style="color: #D73A49">+</span><span style="color: #005CC5">5</span><span style="color: #24292E">,</span><span style="color: #005CC5">0</span><span style="color: #24292E">));</span></span>
<span class="line"><span style="color: #24292E">  vector</span><span style="color: #D73A49">&lt;int&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">arr</span><span style="color: #24292E">(n);</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> arr[i];</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;i</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">) {</span></span>
<span class="line"><span style="color: #24292E">    dp1[i][</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> arr[i];</span></span>
<span class="line"><span style="color: #24292E">    dp2[i][</span><span style="color: #005CC5">0</span><span style="color: #24292E">] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> arr[i];</span></span>
<span class="line"><span style="color: #24292E">  } </span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> j </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">;j</span><span style="color: #D73A49">&lt;=</span><span style="color: #6F42C1">log2</span><span style="color: #24292E">(n);j</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> (</span><span style="color: #D73A49">int</span><span style="color: #24292E"> i </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">; i</span><span style="color: #D73A49">+</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">j)</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;</span><span style="color: #24292E">n;i</span><span style="color: #D73A49">++</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">      dp1[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">max</span><span style="color: #24292E">(dp1[i][j</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">],dp1[i</span><span style="color: #D73A49">+</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">(j</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">))][j</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">]);</span></span>
<span class="line"><span style="color: #24292E">      dp2[i][j] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">min</span><span style="color: #24292E">(dp2[i][j</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">],dp2[i</span><span style="color: #D73A49">+</span><span style="color: #24292E">(</span><span style="color: #005CC5">1</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">(j</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">))][j</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">]);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    }</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">int</span><span style="color: #24292E"> l,r ;</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">while</span><span style="color: #24292E"> (m</span><span style="color: #D73A49">--</span><span style="color: #24292E">){</span></span>
<span class="line"><span style="color: #24292E">    cin </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> l </span><span style="color: #D73A49">&gt;&gt;</span><span style="color: #24292E"> r;</span></span>
<span class="line"><span style="color: #24292E">    cout </span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">query1</span><span style="color: #24292E">(l</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">,r</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span><span style="color: #D73A49">-</span><span style="color: #6F42C1">query2</span><span style="color: #24292E">(l</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">,r</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span><span style="color: #D73A49">&lt;&lt;</span><span style="color: #24292E">endl;</span></span>
<span class="line"><span style="color: #24292E">  }</span></span>
<span class="line"><span style="color: #24292E">  </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">;</span></span>
<span class="line"><span style="color: #24292E">}</span></span></code></pre></div></div></figure>
<h2 id="树上倍增">树上倍增</h2>
<p>在树结构中也可以实现倍增查找某节点任意层祖先</p>
<p>建立每个节点的深度表</p>
<p>使用<code>st[i][p]</code>指代节点i往上走<span
class="math inline">\(2^p\)</span>步来到哪个祖先，其中<code>st[i][0]</code>是i的父节点</p>
<p>则倍增思想可得<code>st[i][p]=st[st[i][p-1]][p-1]</code></p>
<p>此时给定任意节点，就可以快速查询i节点的祖先中位于第s层的祖先节点编号</p>
<h2 id="适用范围">适用范围</h2>
<p>适用于<strong>可重复贡献问题</strong></p>
<p>即若A与B区间有可能重叠的部分，但不影响A+B区间的答案</p>
<p>如RMQ，gcd，按位与，按位或等都可以使用st表高效解决</p>
<p>优势：构建过程复杂度<span class="math inline">\(O(n\log
n)\)</span>，单次查询<span class="math inline">\(O(1)\)</span></p>
<p>劣势：静态维护，需要空间大，维护信息有限</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/CS61A/CS61A%20Efficiency/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/CS61A/CS61A%20Efficiency/" class="post-title-link" itemprop="url">【CS61A】CS61A——Efficiency</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:40:12" itemprop="dateCreated datePublished" datetime="2025-05-18T21:40:12+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:49:41" itemprop="dateModified" datetime="2025-07-31T17:49:41+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS61A/" itemprop="url" rel="index"><span itemprop="name">CS61A</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="efficiency">Efficiency</h1>
<h2 id="memorization">Memorization</h2>
<p>使用记忆化优化斐波那契数组<br />
memo函数用来记录已经计算过的数，当有相同计算需求时直接赋值<br />
count函数记录调用函数次数（包括递归）</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fib</span><span style="color: #24292E">(n):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> n</span><span style="color: #D73A49">==</span><span style="color: #005CC5">0</span><span style="color: #24292E"> </span><span style="color: #D73A49">or</span><span style="color: #24292E"> n</span><span style="color: #D73A49">==</span><span style="color: #005CC5">1</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> n</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> fib(n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">2</span><span style="color: #24292E">)</span><span style="color: #D73A49">+</span><span style="color: #24292E">fib(n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">count</span><span style="color: #24292E">(f):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">counted</span><span style="color: #24292E">(n):</span></span>
<span class="line"><span style="color: #24292E">        counted.call_count </span><span style="color: #D73A49">+=</span><span style="color: #005CC5">1</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> f(n)</span></span>
<span class="line"><span style="color: #24292E">    counted.call_count </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> counted</span></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">memo</span><span style="color: #24292E">(f):</span></span>
<span class="line"><span style="color: #24292E">    cache</span><span style="color: #D73A49">=</span><span style="color: #24292E">{}</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">memoized</span><span style="color: #24292E">(n):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E"> n </span><span style="color: #D73A49">not</span><span style="color: #24292E"> </span><span style="color: #D73A49">in</span><span style="color: #24292E"> cache:</span></span>
<span class="line"><span style="color: #24292E">            cache[n] </span><span style="color: #D73A49">=</span><span style="color: #24292E"> f(n)</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> cache[n]</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> memoized</span></span>
<span class="line"><span style="color: #24292E">fib </span><span style="color: #D73A49">=</span><span style="color: #24292E"> count(fib)</span></span>
<span class="line"><span style="color: #24292E">counted_fib </span><span style="color: #D73A49">=</span><span style="color: #24292E">fib</span></span>
<span class="line"><span style="color: #24292E">fib </span><span style="color: #D73A49">=</span><span style="color: #24292E"> memo(fib)</span></span>
<span class="line"><span style="color: #24292E">fib </span><span style="color: #D73A49">=</span><span style="color: #24292E"> count(fib)</span></span>
<span class="line"><span style="color: #005CC5">print</span><span style="color: #24292E">(fib(</span><span style="color: #005CC5">30</span><span style="color: #24292E">))</span></span>
<span class="line"><span style="color: #005CC5">print</span><span style="color: #24292E">(</span><span style="color: #032F62">&quot;origin:&quot;</span><span style="color: #24292E">, fib.call_count, </span><span style="color: #032F62">&quot;memorized:&quot;</span><span style="color: #24292E">, counted_fib.call_count)</span></span></code></pre></div></div></figure>
<pre><code>832040
origin: 59 memorized: 31</code></pre>
<h2 id="exponentiation">Exponentiation</h2>
<p>优化指数运算至<span class="math inline">\(o(\log n)\)</span><br />
以下显示了进行优化后的算法在不同数据量下的运行时间图，呈现对数曲线趋势</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">%</span><span style="color: #24292E">matplotlib inline</span></span>
<span class="line"><span style="color: #D73A49">import</span><span style="color: #24292E"> matplotlib.pyplot </span><span style="color: #D73A49">as</span><span style="color: #24292E"> plt</span></span>
<span class="line"><span style="color: #24292E">plt.style.use(</span><span style="color: #032F62">&#39;ggplot&#39;</span><span style="color: #24292E">)</span></span>
<span class="line"><span style="color: #24292E">plt.rc(</span><span style="color: #032F62">&#39;font&#39;</span><span style="color: #24292E">, </span><span style="color: #E36209">size</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">16</span><span style="color: #24292E">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">from</span><span style="color: #24292E"> timeit </span><span style="color: #D73A49">import</span><span style="color: #24292E"> repeat</span></span>
<span class="line"><span style="color: #D73A49">from</span><span style="color: #24292E"> numpy </span><span style="color: #D73A49">import</span><span style="color: #24292E"> median, percentile</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">plot_times</span><span style="color: #24292E">(name, xs, n</span><span style="color: #D73A49">=</span><span style="color: #005CC5">15</span><span style="color: #24292E">):</span></span>
<span class="line"><span style="color: #24292E">    f </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">lambda</span><span style="color: #24292E"> x: name</span><span style="color: #D73A49">+</span><span style="color: #032F62">&#39;(&#39;</span><span style="color: #D73A49">+</span><span style="color: #005CC5">str</span><span style="color: #24292E">(x)</span><span style="color: #D73A49">+</span><span style="color: #032F62">&#39;)&#39;</span></span>
<span class="line"><span style="color: #24292E">    g </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">globals</span><span style="color: #24292E">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    samples </span><span style="color: #D73A49">=</span><span style="color: #24292E"> []</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> _ </span><span style="color: #D73A49">in</span><span style="color: #24292E"> </span><span style="color: #005CC5">range</span><span style="color: #24292E">(n):</span></span>
<span class="line"><span style="color: #24292E">        times </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">lambda</span><span style="color: #24292E"> x: repeat(f(x), </span><span style="color: #E36209">globals</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> g, </span><span style="color: #E36209">number</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span><span style="color: #24292E">, </span><span style="color: #E36209">repeat</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> n)</span></span>
<span class="line"><span style="color: #24292E">        samples.append([median(times(x)) </span><span style="color: #D73A49">for</span><span style="color: #24292E"> x </span><span style="color: #D73A49">in</span><span style="color: #24292E"> xs])</span></span>
<span class="line"><span style="color: #24292E">    ys </span><span style="color: #D73A49">=</span><span style="color: #24292E"> [</span><span style="color: #005CC5">10e3</span><span style="color: #D73A49">*</span><span style="color: #24292E">median(sample) </span><span style="color: #D73A49">for</span><span style="color: #24292E"> sample </span><span style="color: #D73A49">in</span><span style="color: #24292E"> </span><span style="color: #005CC5">zip</span><span style="color: #24292E">(</span><span style="color: #D73A49">*</span><span style="color: #24292E">samples)]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    plt.figure(</span><span style="color: #E36209">figsize</span><span style="color: #D73A49">=</span><span style="color: #24292E">(</span><span style="color: #005CC5">8</span><span style="color: #24292E">, </span><span style="color: #005CC5">8</span><span style="color: #24292E">))</span></span>
<span class="line"><span style="color: #24292E">    plt.plot(xs, ys)</span></span>
<span class="line"><span style="color: #24292E">    plt.xlabel(</span><span style="color: #032F62">&#39;n&#39;</span><span style="color: #24292E">)</span></span>
<span class="line"><span style="color: #24292E">    plt.ylabel(</span><span style="color: #032F62">&#39;ms&#39;</span><span style="color: #24292E">)</span></span></code></pre></div></div></figure>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">exp_fast</span><span style="color: #24292E">(b,n):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> n</span><span style="color: #D73A49">==</span><span style="color: #005CC5">0</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #005CC5">1</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">elif</span><span style="color: #24292E"> n</span><span style="color: #D73A49">%</span><span style="color: #005CC5">2</span><span style="color: #D73A49">==</span><span style="color: #005CC5">0</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> square(exp_fast(b,n</span><span style="color: #D73A49">//</span><span style="color: #005CC5">2</span><span style="color: #24292E">))</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> b</span><span style="color: #D73A49">*</span><span style="color: #24292E">exp_fast(b, n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">square</span><span style="color: #24292E">(x):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> x</span><span style="color: #D73A49">*</span><span style="color: #24292E">x</span></span></code></pre></div></div></figure>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #24292E">exp_2_fast </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">lambda</span><span style="color: #24292E"> n: exp_fast(</span><span style="color: #005CC5">2.0</span><span style="color: #24292E">, n)</span></span>
<span class="line"><span style="color: #24292E">plot_times(</span><span style="color: #032F62">&#39;exp_2_fast&#39;</span><span style="color: #24292E">, </span><span style="color: #005CC5">range</span><span style="color: #24292E">(</span><span style="color: #005CC5">20</span><span style="color: #24292E">, </span><span style="color: #005CC5">1600</span><span style="color: #24292E">, </span><span style="color: #005CC5">10</span><span style="color: #24292E">))</span></span></code></pre></div></div></figure>
<figure>
<img src="CS61A——Efficiency/output_5_0.png" alt="output_5_0" />
<figcaption aria-hidden="true">output_5_0</figcaption>
</figure>
<h2 id="order-of-growth-notation">Order of Growth Notation</h2>
<p>时间复杂度常用大O与大<span
class="math inline">\(\Theta\)</span>表示法表示<br />
- 大O描述了运行时间上限 - 大<span
class="math inline">\(\Theta\)</span>则对同时表示了上限与下限
常见的时间复杂度表示（大O与大<span
class="math inline">\(\Theta\)</span>自行替换符号）： - 指数增长：<span
class="math inline">\(o(b^n)\)</span> - 二次增长：<span
class="math inline">\(o(b^2)\)</span> - 线性增长：<span
class="math inline">\(o(n)\)</span> - 对数增长：<span
class="math inline">\(o(\log n)\)</span> - 常数增长：<span
class="math inline">\(o(1)\)</span></p>
<h2 id="space">Space</h2>
<p>Active environment: - 正在被调用的函数的环境 -
函数的父函数在活动环境中（即嵌套函数内层调用时）
python会自动检测非活动环境并将其回收</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://izayoisakuye.github.io/CS61A/CS61A%20Composition/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="IzayoiSakuye">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="红魔咖啡馆">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/CS61A/CS61A%20Composition/" class="post-title-link" itemprop="url">【CS61A】CS61A——Composition</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-05-18 21:40:12" itemprop="dateCreated datePublished" datetime="2025-05-18T21:40:12+08:00">2025-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-07-31 17:48:53" itemprop="dateModified" datetime="2025-07-31T17:48:53+08:00">2025-07-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CS61A/" itemprop="url" rel="index"><span itemprop="name">CS61A</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="composition">Composition</h1>
<h2 id="linked-list">Linked List</h2>
<p>用Python实现链表 -
每个节点由<code>first</code>与<code>rest</code>组成，前者表示值，后者表示链接的剩余链表
- 将每个节点当作一堆二元组看待 -
最后一个节点指向空链表<code>Link.empty</code>，使用类属性表示 -
构造方式：<code>Link(3, Link(4, Link(5, Link.empty)))</code> ###
创建链表</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Link</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6A737D"># 使用空元组实现空节点，类属性</span></span>
<span class="line"><span style="color: #24292E">    empty </span><span style="color: #D73A49">=</span><span style="color: #24292E"> ()</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #005CC5">__init__</span><span style="color: #24292E">(self, first, rest</span><span style="color: #D73A49">=</span><span style="color: #24292E">empty):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6A737D"># 判断rest是否是空节点或是一个Link类</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">assert</span><span style="color: #24292E"> rest </span><span style="color: #D73A49">is</span><span style="color: #24292E"> Link.empty </span><span style="color: #D73A49">or</span><span style="color: #24292E"> </span><span style="color: #005CC5">isinstance</span><span style="color: #24292E">(rest, Link)</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">self</span><span style="color: #24292E">.first </span><span style="color: #D73A49">=</span><span style="color: #24292E"> first</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">self</span><span style="color: #24292E">.rest </span><span style="color: #D73A49">=</span><span style="color: #24292E"> rest</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">s </span><span style="color: #D73A49">=</span><span style="color: #24292E"> Link(</span><span style="color: #005CC5">3</span><span style="color: #24292E">, Link(</span><span style="color: #005CC5">4</span><span style="color: #24292E">, Link(</span><span style="color: #005CC5">5</span><span style="color: #24292E">)))</span></span>
<span class="line"><span style="color: #005CC5">print</span><span style="color: #24292E">(s.first)</span></span>
<span class="line"><span style="color: #005CC5">print</span><span style="color: #24292E">(s.rest.first)</span></span>
<span class="line"><span style="color: #005CC5">print</span><span style="color: #24292E">(s.rest.rest.first)</span></span>
<span class="line"><span style="color: #005CC5">print</span><span style="color: #24292E">(s.rest.rest.rest </span><span style="color: #D73A49">is</span><span style="color: #24292E"> Link.empty)</span></span></code></pre></div></div></figure>
<h3 id="操作列表">操作列表</h3>
<p>实现如下行为：<code>range</code>, <code>map</code>,
<code>filter</code> 我们使用递归实现</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Link</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #6A737D"># 使用空元组实现空节点，类属性</span></span>
<span class="line"><span style="color: #24292E">    empty </span><span style="color: #D73A49">=</span><span style="color: #24292E"> ()</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #005CC5">__init__</span><span style="color: #24292E">(self, first, rest</span><span style="color: #D73A49">=</span><span style="color: #24292E">empty):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #6A737D"># 判断rest是否是空节点或是一个Link类</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">assert</span><span style="color: #24292E"> rest </span><span style="color: #D73A49">is</span><span style="color: #24292E"> Link.empty </span><span style="color: #D73A49">or</span><span style="color: #24292E"> </span><span style="color: #005CC5">isinstance</span><span style="color: #24292E">(rest, Link)</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">self</span><span style="color: #24292E">.first </span><span style="color: #D73A49">=</span><span style="color: #24292E"> first</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">self</span><span style="color: #24292E">.rest </span><span style="color: #D73A49">=</span><span style="color: #24292E"> rest</span></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">range_link</span><span style="color: #24292E">(start, end):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> start</span><span style="color: #D73A49">&gt;=</span><span style="color: #24292E">end:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> Link.empty</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> Link(start, range_link(start</span><span style="color: #D73A49">+</span><span style="color: #005CC5">1</span><span style="color: #24292E">, end))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">map_link</span><span style="color: #24292E">(f, s):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> s </span><span style="color: #D73A49">is</span><span style="color: #24292E"> Link.empty:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> s</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> Link(f(s.first), map_link(f, s.rest))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">filter_link</span><span style="color: #24292E">(f, s):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> s </span><span style="color: #D73A49">is</span><span style="color: #24292E"> Link.empty:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> s</span></span>
<span class="line"><span style="color: #24292E">    filter_rest </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">filter</span><span style="color: #24292E">(f, s.rest)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> f(s.first):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> Link(s.first, filter_rest)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> filter_rest</span></span></code></pre></div></div></figure>
<h3 id="链表的改变">链表的改变</h3>
<p>可以通过对属性赋值来改变链表的<code>first</code>和<code>rest</code>属性</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">&gt;&gt;&gt;</span><span style="color: #24292E"> s </span><span style="color: #D73A49">=</span><span style="color: #24292E"> Link(</span><span style="color: #005CC5">1</span><span style="color: #24292E">, Link(</span><span style="color: #005CC5">2</span><span style="color: #24292E">, Link(</span><span style="color: #005CC5">3</span><span style="color: #24292E">)))</span></span>
<span class="line"><span style="color: #D73A49">&gt;&gt;&gt;</span><span style="color: #24292E"> s.first </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">5</span></span>
<span class="line"><span style="color: #D73A49">&gt;&gt;&gt;</span><span style="color: #24292E"> t </span><span style="color: #D73A49">=</span><span style="color: #24292E"> s.rest</span></span>
<span class="line"><span style="color: #D73A49">&gt;&gt;&gt;</span><span style="color: #24292E"> t.rest </span><span style="color: #D73A49">=</span><span style="color: #24292E"> s</span><span style="color: #B31D28; font-style: italic">;</span></span>
<span class="line"><span style="color: #D73A49">&gt;&gt;&gt;</span><span style="color: #24292E"> s.first</span></span>
<span class="line"><span style="color: #005CC5">5</span></span>
<span class="line"><span style="color: #D73A49">&gt;&gt;&gt;</span><span style="color: #24292E"> s.rest.rest.rest.rest.rest.first</span></span>
<span class="line"><span style="color: #005CC5">2</span></span></code></pre></div></div></figure>
<p>此赋值将s的后段与前段相接，创建了一个循环链表</p>
<h3 id="插入节点">插入节点</h3>
<p>向一个有序链表中添加节点，保证链表仍有序</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">add</span><span style="color: #24292E">(s, v):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">assert</span><span style="color: #24292E"> s </span><span style="color: #D73A49">is</span><span style="color: #24292E"> </span><span style="color: #D73A49">not</span><span style="color: #24292E"> Link.empty</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> s.first </span><span style="color: #D73A49">&gt;</span><span style="color: #24292E"> v:</span></span>
<span class="line"><span style="color: #24292E">        s.first, s.rest </span><span style="color: #D73A49">=</span><span style="color: #24292E"> v, Link(s.first, s.rest)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">elif</span><span style="color: #24292E"> s.first </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> v </span><span style="color: #D73A49">and</span><span style="color: #24292E"> s.rest </span><span style="color: #D73A49">is</span><span style="color: #24292E"> Link.empty:</span></span>
<span class="line"><span style="color: #24292E">        s.rest </span><span style="color: #D73A49">=</span><span style="color: #24292E"> Link(v)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">elif</span><span style="color: #24292E"> s.first </span><span style="color: #D73A49">&lt;</span><span style="color: #24292E"> v:</span></span>
<span class="line"><span style="color: #24292E">        add(s.rest, v)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">return</span><span style="color: #24292E"> s</span></span></code></pre></div></div></figure>
<h2 id="tree-class">Tree Class</h2>
<p>使用类实现树 ### 创建树</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">class</span><span style="color: #24292E"> </span><span style="color: #6F42C1">Tree</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #005CC5">__init__</span><span style="color: #24292E">(self, label, branches </span><span style="color: #D73A49">=</span><span style="color: #24292E"> []):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">self</span><span style="color: #24292E">.label </span><span style="color: #D73A49">=</span><span style="color: #24292E"> label</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E"> branch </span><span style="color: #D73A49">in</span><span style="color: #24292E"> branches:</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">assert</span><span style="color: #24292E"> </span><span style="color: #005CC5">isinstance</span><span style="color: #24292E">(branch, Tree)</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #005CC5">self</span><span style="color: #24292E">.branches </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">list</span><span style="color: #24292E">(branches)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #005CC5">__repr__</span><span style="color: #24292E">(self):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">if</span><span style="color: #24292E"> </span><span style="color: #005CC5">self</span><span style="color: #24292E">.branches:</span></span>
<span class="line"><span style="color: #24292E">            branches_str </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;, &#39;</span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">repr</span><span style="color: #24292E">(</span><span style="color: #005CC5">self</span><span style="color: #24292E">.branches)</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">            branch_str </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;&#39;</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;Tree(</span><span style="color: #005CC5">{0}{1}</span><span style="color: #032F62">)&#39;</span><span style="color: #24292E">.format(</span><span style="color: #005CC5">repr</span><span style="color: #24292E">(</span><span style="color: #005CC5">self</span><span style="color: #24292E">.label), branch_str)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #005CC5">__str__</span><span style="color: #24292E">(self):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #032F62">&#39;</span><span style="color: #005CC5">\n</span><span style="color: #032F62">&#39;</span><span style="color: #24292E">.join(</span><span style="color: #005CC5">self</span><span style="color: #24292E">.indented())</span></span>
<span class="line"></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">indented</span><span style="color: #24292E">(self):</span></span>
<span class="line"><span style="color: #24292E">        lines </span><span style="color: #D73A49">=</span><span style="color: #24292E"> []</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E"> b </span><span style="color: #D73A49">in</span><span style="color: #24292E"> </span><span style="color: #005CC5">self</span><span style="color: #24292E">.branches:</span></span>
<span class="line"><span style="color: #24292E">            </span><span style="color: #D73A49">for</span><span style="color: #24292E"> line </span><span style="color: #D73A49">in</span><span style="color: #24292E"> b.indented():</span></span>
<span class="line"><span style="color: #24292E">                lines.append(</span><span style="color: #032F62">&#39;    &#39;</span><span style="color: #D73A49">+</span><span style="color: #24292E">line)</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> [</span><span style="color: #005CC5">str</span><span style="color: #24292E">(</span><span style="color: #005CC5">self</span><span style="color: #24292E">.label)] </span><span style="color: #D73A49">+</span><span style="color: #24292E"> lines</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">is_leaf</span><span style="color: #24292E">(self):</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> </span><span style="color: #D73A49">not</span><span style="color: #24292E"> </span><span style="color: #005CC5">self</span><span style="color: #24292E">.branches</span></span></code></pre></div></div></figure>
<h3 id="实现一些操作">实现一些操作</h3>
<p>如下代码实现了创建斐波那契树以及输出叶子节点</p>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">fib_tree</span><span style="color: #24292E">(n):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> n</span><span style="color: #D73A49">==</span><span style="color: #005CC5">0</span><span style="color: #24292E"> </span><span style="color: #D73A49">or</span><span style="color: #24292E"> n</span><span style="color: #D73A49">==</span><span style="color: #005CC5">1</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> Tree(n)</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        left </span><span style="color: #D73A49">=</span><span style="color: #24292E"> fib_tree(n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">2</span><span style="color: #24292E">)</span></span>
<span class="line"><span style="color: #24292E">        right </span><span style="color: #D73A49">=</span><span style="color: #24292E"> fib_tree(n</span><span style="color: #D73A49">-</span><span style="color: #005CC5">1</span><span style="color: #24292E">)</span></span>
<span class="line"><span style="color: #24292E">        fib_n </span><span style="color: #D73A49">=</span><span style="color: #24292E"> left.label </span><span style="color: #D73A49">+</span><span style="color: #24292E"> right.label</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> Tree(fib_n, [left, right])</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">leaves</span><span style="color: #24292E">(t):</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> t.is_leaf():</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> [t.label]</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">else</span><span style="color: #24292E">:</span></span>
<span class="line"><span style="color: #24292E">        all_leaves </span><span style="color: #D73A49">=</span><span style="color: #24292E"> []</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">for</span><span style="color: #24292E"> b </span><span style="color: #D73A49">in</span><span style="color: #24292E"> t.branches:</span></span>
<span class="line"><span style="color: #24292E">            all_leaves.extend(leaves(b))</span></span>
<span class="line"><span style="color: #24292E">        </span><span style="color: #D73A49">return</span><span style="color: #24292E"> all_leaves</span></span></code></pre></div></div></figure>
<h3 id="剪枝">剪枝</h3>
<figure class="shiki python"><div class='codeblock'><div class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div><div class="code"><pre class="shiki github-light"><code><span class="line"><span style="color: #6A737D"># 通过每次重新构建branches列表，将等于n的值排除在列表外以实现</span></span>
<span class="line"><span style="color: #D73A49">def</span><span style="color: #24292E"> </span><span style="color: #6F42C1">prune</span><span style="color: #24292E">(t, n):</span></span>
<span class="line"><span style="color: #24292E">    t.branches </span><span style="color: #D73A49">=</span><span style="color: #24292E"> [b </span><span style="color: #D73A49">for</span><span style="color: #24292E"> b </span><span style="color: #D73A49">in</span><span style="color: #24292E"> t.branches </span><span style="color: #D73A49">if</span><span style="color: #24292E"> b.label</span><span style="color: #D73A49">!=</span><span style="color: #24292E">n]</span></span>
<span class="line"><span style="color: #24292E">    </span><span style="color: #D73A49">for</span><span style="color: #24292E"> b </span><span style="color: #D73A49">in</span><span style="color: #24292E"> t.branches:</span></span>
<span class="line"><span style="color: #24292E">        prune(b, n)</span></span></code></pre></div></div></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/list/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/list/">1</a><span class="space">&hellip;</span><a class="page-number" href="/list/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/list/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/list/page/13/">13</a><a class="extend next" rel="next" href="/list/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="IzayoiSakuye"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">IzayoiSakuye</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">125</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/IzayoiSakuye" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;IzayoiSakuye" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">IzayoiSakuye</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">368k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">11:09</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  

<!-- hexo injector body_end start -->
<script src="https://cdn.jsdelivr.net/npm/hexo-shiki-plugin@latest/lib/codeblock.js"></script>

  <script>
  const CODE_CONFIG = {
    beautify: true,
    highlightCopy: true,
    highlightLang: true,
    highlightHeightLimit: undefined,
    isHighlightShrink: false,
    copy: {
      success: 'Copy Success',
      error: 'Copy Error',
      noSupport: 'Browser Not Support',
    }
  };
  console.log(
    `%c hexo-shiki-plugin %c v1.0.27 %c https://github.com/nova1751/hexo-shiki-plugin`,
    "color: #fff; background: #5f5f5f",
    "color: #fff; background: #80c8f8",
    ""
  );
  </script>
  <!-- hexo injector body_end end --></body>
</html>
